import{d as Q,m as Z,h as x,o as Y,e as j,i as N,u as J,j as F,p as V,b as $,a as k,g as D}from"./storage-18c961a6.js";import{N as ee,u as _,d as S,b as I,c as R}from"./node-90775947.js";import{b as c,d as te,am as ne,c as oe,o as b,ae as A,g as l,f as ae,u as s,j as g,l as L,k as E,h as d}from"./index-80bf7a1e.js";import{i as se,a as ie,J as U}from"./file_type-a58fe75b.js";const H=({title:t="批量分享链接",content:e=""})=>{Q.success({title:t,style:{width:"800px"},content(){return c(ee,{type:"textarea",autosize:{minRows:8,maxRows:16},inputProps:{style:"white-space: nowrap;"},value:e},null)},positiveText:"复制",onPositiveClick(){return navigator.clipboard.writeText(e).then(()=>{Z.success("复制成功")}).catch(()=>{Z.success("复制失败")}),!1}})};var X={exports:{}};(function(t,e){(function(i,r){r()})(x,function(){function i(n,o){return typeof o>"u"?o={autoBom:!1}:typeof o!="object"&&(console.warn("Deprecated: Expected third argument to be a object"),o={autoBom:!o}),o.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(n.type)?new Blob(["\uFEFF",n],{type:n.type}):n}function r(n,o,w){var a=new XMLHttpRequest;a.open("GET",n),a.responseType="blob",a.onload=function(){m(a.response,o,w)},a.onerror=function(){console.error("could not download file")},a.send()}function f(n){var o=new XMLHttpRequest;o.open("HEAD",n,!1);try{o.send()}catch{}return 200<=o.status&&299>=o.status}function h(n){try{n.dispatchEvent(new MouseEvent("click"))}catch{var o=document.createEvent("MouseEvents");o.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),n.dispatchEvent(o)}}var p=typeof window=="object"&&window.window===window?window:typeof self=="object"&&self.self===self?self:typeof x=="object"&&x.global===x?x:void 0,v=p.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),m=p.saveAs||(typeof window!="object"||window!==p?function(){}:"download"in HTMLAnchorElement.prototype&&!v?function(n,o,w){var a=p.URL||p.webkitURL,u=document.createElement("a");o=o||n.name||"download",u.download=o,u.rel="noopener",typeof n=="string"?(u.href=n,u.origin===location.origin?h(u):f(u.href)?r(n,o,w):h(u,u.target="_blank")):(u.href=a.createObjectURL(n),setTimeout(function(){a.revokeObjectURL(u.href)},4e4),setTimeout(function(){h(u)},0))}:"msSaveOrOpenBlob"in navigator?function(n,o,w){if(o=o||n.name||"download",typeof n!="string")navigator.msSaveOrOpenBlob(i(n,w),o);else if(f(n))r(n,o,w);else{var a=document.createElement("a");a.href=n,a.target="_blank",setTimeout(function(){h(a)})}}:function(n,o,w,a){if(a=a||open("","_blank"),a&&(a.document.title=a.document.body.innerText="downloading..."),typeof n=="string")return r(n,o,w);var u=n.type==="application/octet-stream",W=/constructor/i.test(p.HTMLElement)||p.safari,M=/CriOS\/[\d]+/.test(navigator.userAgent);if((M||u&&W||v)&&typeof FileReader<"u"){var B=new FileReader;B.onloadend=function(){var y=B.result;y=M?y:y.replace(/^data:[^;]*;/,"data:attachment/file;"),a?a.location.href=y:location=y,a=null},B.readAsDataURL(n)}else{var O=p.URL||p.webkitURL,C=O.createObjectURL(n);a?a.location=C:location.href=C,a=null,setTimeout(function(){O.revokeObjectURL(C)},4e4)}});p.saveAs=m.saveAs=m,t.exports=m})})(X);var z=X.exports;const q=async t=>{const[e,i]=(()=>{if(se(t))return["file.png","image/png"];if(ie(t))return["file.zip","application/x-zip-compressed"];throw new Error("invalid buffer, it must be png or zip")})(),r=new File([t],e,{type:i}),f=await fetch("https://github-upload-assets.lisonge.workers.dev/",{method:"POST",body:Y({file:r})}),h=f.headers.get("X_RPC_OK");if(h==="true")return f.json();throw h==="false"?new Error((await f.json()).message):new Error(await f.text())},P=async t=>{const e=new U;return e.file("snapshot.json",JSON.stringify(t)).file("screenshot.png",await $.getItem(t.id)),await e.generateAsync({type:"blob",compression:"STORE"})},re=async t=>{const e=`snapshot-${t.id}.zip`;z.saveAs(await P(t),e)},T=async t=>{const e=await $.getItem(t.id);return new Blob([e,JSON.stringify(t)])},le=async t=>{const e=`snapshot-${t.id}.png`;z.saveAs(await T(t),e)},ve=async t=>{const e=new U;for(const r of t)await j(),e.file(r.id+".png",T(r));const i=await e.generateAsync({type:"blob",compression:"STORE"});z.saveAs(i,`batch-png-${t.length}.zip`)},ye=async t=>{const e=new U;for(const r of t)await j(),e.file(r.id+".zip",await P(r));const i=await e.generateAsync({type:"blob",compression:"STORE"});z.saveAs(i,`batch-zip-${t.length}.zip`)},G=async t=>N[t.id]??q(await T(t).then(e=>e.arrayBuffer())).then(e=>(J[e.href]=t.id,N[t.id]=e.href,e.href)),K=async t=>F[t.id]??q(await P(t).then(e=>e.arrayBuffer())).then(e=>(F[t.id]=e.href,J[e.href]=t.id,e.href)),xe=async t=>{const e=V(3);return(await Promise.allSettled(t.map(i=>e(()=>G(i))))).reduce((i,r)=>(r.status=="fulfilled"&&i.push(r.value),i),[])},ke=async t=>{const e=V(3);return(await Promise.allSettled(t.map(i=>e(()=>K(i))))).reduce((i,r)=>(r.status=="fulfilled"&&i.push(r.value),i),[])},ce=["href"],pe=d("svg",{viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg",width:"200",height:"200"},[d("path",{d:"M549.973333 128 633.6 145.066667 474.026667 896 390.4 878.933333 549.973333 128M835.84 512 682.666667 358.826667 682.666667 238.08 956.586667 512 682.666667 785.493333 682.666667 664.746667 835.84 512M67.413333 512 341.333333 238.08 341.333333 358.826667 188.16 512 341.333333 664.746667 341.333333 785.493333 67.413333 512Z"})],-1),ue=d("svg",{xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 24 24"},[d("g",{fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},[d("path",{d:"M4 17v2a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-2"}),d("path",{d:"M7 11l5 5l5-5"}),d("path",{d:"M12 4v12"})])],-1),de=d("svg",{xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 24 24"},[d("path",{d:"M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81c1.66 0 3-1.34 3-3s-1.34-3-3-3s-3 1.34-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9c-1.66 0-3 1.34-3 3s1.34 3 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.16c-.05.21-.08.43-.08.65c0 1.61 1.31 2.92 2.92 2.92s2.92-1.31 2.92-2.92s-1.31-2.92-2.92-2.92z",fill:"currentColor"})],-1),fe=d("svg",{xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 24 24"},[d("g",{fill:"none"},[d("path",{d:"M12 1.75a3.25 3.25 0 0 1 3.245 3.066L15.25 5h5.25a.75.75 0 0 1 .102 1.493L20.5 6.5h-.796l-1.28 13.02a2.75 2.75 0 0 1-2.561 2.474l-.176.006H8.313a2.75 2.75 0 0 1-2.714-2.307l-.023-.174L4.295 6.5H3.5a.75.75 0 0 1-.743-.648L2.75 5.75a.75.75 0 0 1 .648-.743L3.5 5h5.25A3.25 3.25 0 0 1 12 1.75zm6.197 4.75H5.802l1.267 12.872a1.25 1.25 0 0 0 1.117 1.122l.127.006h7.374c.6 0 1.109-.425 1.225-1.002l.02-.126L18.196 6.5zM13.75 9.25a.75.75 0 0 1 .743.648L14.5 10v7a.75.75 0 0 1-1.493.102L13 17v-7a.75.75 0 0 1 .75-.75zm-3.5 0a.75.75 0 0 1 .743.648L11 10v7a.75.75 0 0 1-1.493.102L9.5 17v-7a.75.75 0 0 1 .75-.75zm1.75-6a1.75 1.75 0 0 0-1.744 1.606L10.25 5h3.5A1.75 1.75 0 0 0 12 3.25z",fill:"currentColor"})])],-1),be=te({__name:"ActionCard",props:{snapshot:{},onDelete:{type:Function,default:()=>()=>{}},showPreview:{type:Boolean,default:!0},showExport:{type:Boolean,default:!0},showDelete:{type:Boolean,default:!0},showShare:{type:Boolean,default:!0}},setup(t){const e=t,i=ne(),r=_(async()=>le(await k.getItem(e.snapshot.id))),f=_(async()=>re(await k.getItem(e.snapshot.id))),h=oe(()=>i.resolve({name:"snapshot",params:{snapshotId:e.snapshot.id}}).href),p=_(async()=>{const n=await G(await k.getItem(e.snapshot.id));H({title:"分享链接",content:D(n)})}),v=_(async()=>{const n=await K(await k.getItem(e.snapshot.id));H({title:"分享链接",content:D(n)})}),m=async()=>{await k.removeItem(e.snapshot.id),await j(500),e.onDelete()};return(n,o)=>(b(),A(s(R),null,{default:l(()=>[n.showPreview?(b(),ae("a",{key:0,target:"_blank",href:h.value},[c(s(g),{size:"small"},{icon:l(()=>[c(s(S),null,{default:l(()=>[pe]),_:1})]),_:1})],8,ce)):L("",!0),n.showExport?(b(),A(s(I),{key:1},{trigger:l(()=>[c(s(g),{size:"small"},{icon:l(()=>[c(s(S),null,{default:l(()=>[ue]),_:1})]),_:1})]),default:l(()=>[c(s(R),{vertical:""},{default:l(()=>[c(s(g),{onClick:s(r).invoke,loading:s(r).loading},{default:l(()=>[E(" 下载-png ")]),_:1},8,["onClick","loading"]),c(s(g),{onClick:s(f).invoke,loading:s(f).loading},{default:l(()=>[E(" 下载-zip ")]),_:1},8,["onClick","loading"])]),_:1})]),_:1})):L("",!0),n.showShare?(b(),A(s(I),{key:2},{trigger:l(()=>[c(s(g),{size:"small"},{icon:l(()=>[c(s(S),null,{default:l(()=>[de]),_:1})]),_:1})]),default:l(()=>[c(s(R),{vertical:""},{default:l(()=>[c(s(g),{onClick:s(p).invoke,loading:s(p).loading},{default:l(()=>[E(" 生成链接-png ")]),_:1},8,["onClick","loading"]),c(s(g),{onClick:s(v).invoke,loading:s(v).loading},{default:l(()=>[E(" 生成链接-zip ")]),_:1},8,["onClick","loading"])]),_:1})]),_:1})):L("",!0),n.showDelete?(b(),A(s(g),{key:3,size:"small",onClick:m},{icon:l(()=>[c(s(S),null,{default:l(()=>[fe]),_:1})]),_:1})):L("",!0)]),_:1}))}});export{be as _,ye as a,ve as b,xe as c,ke as d,H as s};
//# sourceMappingURL=ActionCard.vue_vue_type_script_setup_true_lang-702a2feb.js.map
