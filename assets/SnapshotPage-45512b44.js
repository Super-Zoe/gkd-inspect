import{_ as Dn,e as Pn,f as Ln}from"./ActionCard.vue_vue_type_script_setup_true_lang-1db8562d.js";import{f as pt,c as Fe,m as ue,a as $t,b as $n,e as En,h as Fn,i as An}from"./storage-31a95079.js";import{d as M,m,n as xt,p as D,q as F,v as X,x as K,y as ot,z as H,c as A,A as ze,B as jt,C as rt,D as kt,E as wt,G as V,H as In,I as O,J as On,K as zn,L as Ht,M as Bn,O as G,P as Ke,Q as Un,S as Et,T as Vt,U as Mn,V as ve,W as jn,X as Hn,Y as Vn,Z as _e,_ as Wn,$ as qn,a0 as ut,a1 as Xn,a2 as Gn,a3 as ft,a4 as Yn,a5 as Jn,a6 as Zn,a7 as Wt,a8 as Qn,w as Ce,e as We,a9 as ht,aa as Ve,ab as Ft,ac as eo,ad as nt,a as qt,s as ie,ae as At,af as ae,h as ne,ag as Xt,ah as Gt,ai as to,aj as no,o as W,g as w,b as R,u as b,k as B,f as Oe,ak as bt,F as mt,t as te,l as Ae,i as oo,j as gt,al as ro,am as lo,an as ao}from"./index-29ff6dfa.js";import{e as qe,C as io,f as so,g as co,h as uo,i as It,V as fo,j as ho,k as Ot,l as go,m as vo,n as po,o as Ie,p as bo,c as zt,q as Bt,r as mo,N as yo,a as xo,s as yt,t as Ut,v as ko}from"./node-50cc082c.js";import{e as wo,a as Co,p as No,u as So}from"./index-0bc49905.js";import{_ as Ro}from"./_plugin-vue_export-helper-c27b6911.js";import"./jszip.min-4cfbdb4d.js";function Yt(e){return typeof e=="string"?`s-${e}`:`n-${e}`}const _o=M({name:"ChevronLeft",render(){return m("svg",{viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg"},m("path",{d:"M10.3536 3.14645C10.5488 3.34171 10.5488 3.65829 10.3536 3.85355L6.20711 8L10.3536 12.1464C10.5488 12.3417 10.5488 12.6583 10.3536 12.8536C10.1583 13.0488 9.84171 13.0488 9.64645 12.8536L5.14645 8.35355C4.95118 8.15829 4.95118 7.84171 5.14645 7.64645L9.64645 3.14645C9.84171 2.95118 10.1583 2.95118 10.3536 3.14645Z",fill:"currentColor"}))}}),Ko=M({name:"Switcher",render(){return m("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 32"},m("path",{d:"M12 8l10 8l-10 8z"}))}}),To=e=>{const{fontWeight:t,textColor1:c,textColor2:s,textColorDisabled:i,dividerColor:o,fontSize:u}=e;return{titleFontSize:u,titleFontWeight:t,dividerColor:o,titleTextColor:c,titleTextColorDisabled:i,fontSize:u,textColor:s,arrowColor:s,arrowColorDisabled:i,itemMargin:"16px 0 0 0",titlePadding:"16px 0 0 0"}},Do={name:"Collapse",common:xt,self:To},Po=Do,Lo=D("collapse","width: 100%;",[D("collapse-item",`
 font-size: var(--n-font-size);
 color: var(--n-text-color);
 transition:
 color .3s var(--n-bezier),
 border-color .3s var(--n-bezier);
 margin: var(--n-item-margin);
 `,[F("disabled",[X("header","cursor: not-allowed;",[X("header-main",`
 color: var(--n-title-text-color-disabled);
 `),D("collapse-item-arrow",`
 color: var(--n-arrow-color-disabled);
 `)])]),D("collapse-item","margin-left: 32px;"),K("&:first-child","margin-top: 0;"),K("&:first-child >",[X("header","padding-top: 0;")]),F("left-arrow-placement",[X("header",[D("collapse-item-arrow","margin-right: 4px;")])]),F("right-arrow-placement",[X("header",[D("collapse-item-arrow","margin-left: 4px;")])]),X("content-wrapper",[X("content-inner","padding-top: 16px;"),pt({duration:"0.15s"})]),F("active",[X("header",[F("active",[D("collapse-item-arrow","transform: rotate(90deg);")])])]),K("&:not(:first-child)","border-top: 1px solid var(--n-divider-color);"),X("header",`
 font-size: var(--n-title-font-size);
 display: flex;
 flex-wrap: nowrap;
 align-items: center;
 transition: color .3s var(--n-bezier);
 position: relative;
 padding: var(--n-title-padding);
 color: var(--n-title-text-color);
 cursor: pointer;
 `,[X("header-main",`
 display: flex;
 flex-wrap: nowrap;
 align-items: center;
 font-weight: var(--n-title-font-weight);
 transition: color .3s var(--n-bezier);
 flex: 1;
 color: var(--n-title-text-color);
 `),X("header-extra",`
 display: flex;
 align-items: center;
 transition: color .3s var(--n-bezier);
 color: var(--n-text-color);
 `),D("collapse-item-arrow",`
 display: flex;
 transition:
 transform .15s var(--n-bezier),
 color .3s var(--n-bezier);
 font-size: 18px;
 color: var(--n-arrow-color);
 `)])])]),$o=Object.assign(Object.assign({},ze.props),{defaultExpandedNames:{type:[Array,String],default:null},expandedNames:[Array,String],arrowPlacement:{type:String,default:"left"},accordion:{type:Boolean,default:!1},displayDirective:{type:String,default:"if"},onItemHeaderClick:[Function,Array],"onUpdate:expandedNames":[Function,Array],onUpdateExpandedNames:[Function,Array],onExpandedNamesChange:{type:[Function,Array],validator:()=>!0,default:void 0}}),Jt=wt("n-collapse"),Eo=M({name:"Collapse",props:$o,setup(e,{slots:t}){const{mergedClsPrefixRef:c,inlineThemeDisabled:s,mergedRtlRef:i}=ot(e),o=H(e.defaultExpandedNames),u=A(()=>e.expandedNames),l=qe(u,o),r=ze("Collapse","-collapse",Lo,Po,e,c);function a(_){const{"onUpdate:expandedNames":N,onUpdateExpandedNames:x,onExpandedNamesChange:P}=e;x&&V(x,_),N&&V(N,_),P&&V(P,_),o.value=_}function f(_){const{onItemHeaderClick:N}=e;N&&V(N,_)}function h(_,N,x){const{accordion:P}=e,{value:T}=l;if(P)_?(a([N]),f({name:N,expanded:!0,event:x})):(a([]),f({name:N,expanded:!1,event:x}));else if(!Array.isArray(T))a([N]),f({name:N,expanded:!0,event:x});else{const E=T.slice(),j=E.findIndex(Y=>N===Y);~j?(E.splice(j,1),a(E),f({name:N,expanded:!1,event:x})):(E.push(N),a(E),f({name:N,expanded:!0,event:x}))}}jt(Jt,{props:e,mergedClsPrefixRef:c,expandedNamesRef:l,slots:t,toggleItem:h});const g=rt("Collapse",i,c),p=A(()=>{const{common:{cubicBezierEaseInOut:_},self:{titleFontWeight:N,dividerColor:x,titlePadding:P,titleTextColor:T,titleTextColorDisabled:E,textColor:j,arrowColor:Y,fontSize:he,titleFontSize:de,arrowColorDisabled:be,itemMargin:ge}}=r.value;return{"--n-font-size":he,"--n-bezier":_,"--n-text-color":j,"--n-divider-color":x,"--n-title-padding":P,"--n-title-font-size":de,"--n-title-text-color":T,"--n-title-text-color-disabled":E,"--n-title-font-weight":N,"--n-arrow-color":Y,"--n-arrow-color-disabled":be,"--n-item-margin":ge}}),S=s?kt("collapse",void 0,p,e):void 0;return{rtlEnabled:g,mergedTheme:r,mergedClsPrefix:c,cssVars:s?void 0:p,themeClass:S==null?void 0:S.themeClass,onRender:S==null?void 0:S.onRender}},render(){var e;return(e=this.onRender)===null||e===void 0||e.call(this),m("div",{class:[`${this.mergedClsPrefix}-collapse`,this.rtlEnabled&&`${this.mergedClsPrefix}-collapse--rtl`,this.themeClass],style:this.cssVars},this.$slots)}}),Fo=M({name:"CollapseItemContent",props:{displayDirective:{type:String,required:!0},show:Boolean,clsPrefix:{type:String,required:!0}},setup(e){return{onceTrue:In(O(e,"show"))}},render(){return m(Ht,null,{default:()=>{const{show:e,displayDirective:t,onceTrue:c,clsPrefix:s}=this,i=t==="show"&&c,o=m("div",{class:`${s}-collapse-item__content-wrapper`},m("div",{class:`${s}-collapse-item__content-inner`},this.$slots));return i?On(o,[[zn,e]]):e?o:null}})}}),Ao={title:String,name:[String,Number],disabled:Boolean,displayDirective:String},Io=M({name:"CollapseItem",props:Ao,setup(e){const{mergedRtlRef:t}=ot(e),c=Bn(),s=G(()=>{var h;return(h=e.name)!==null&&h!==void 0?h:c}),i=Ke(Jt);i||Un("collapse-item","`n-collapse-item` must be placed inside `n-collapse`.");const{expandedNamesRef:o,props:u,mergedClsPrefixRef:l,slots:r}=i,a=A(()=>{const{value:h}=o;if(Array.isArray(h)){const{value:g}=s;return!~h.findIndex(p=>p===g)}else if(h){const{value:g}=s;return g!==h}return!0});return{rtlEnabled:rt("Collapse",t,l),collapseSlots:r,randomName:c,mergedClsPrefix:l,collapsed:a,mergedDisplayDirective:A(()=>{const{displayDirective:h}=e;return h||u.displayDirective}),arrowPlacement:A(()=>u.arrowPlacement),handleClick(h){i&&!e.disabled&&i.toggleItem(a.value,s.value,h)}}},render(){const{collapseSlots:e,$slots:t,arrowPlacement:c,collapsed:s,mergedDisplayDirective:i,mergedClsPrefix:o,disabled:u}=this,l=Et(t.header,{collapsed:s},()=>[this.title]),r=t["header-extra"]||e["header-extra"],a=t.arrow||e.arrow;return m("div",{class:[`${o}-collapse-item`,`${o}-collapse-item--${c}-arrow-placement`,u&&`${o}-collapse-item--disabled`,!s&&`${o}-collapse-item--active`]},m("div",{class:[`${o}-collapse-item__header`,!s&&`${o}-collapse-item__header--active`]},m("div",{class:`${o}-collapse-item__header-main`,onClick:this.handleClick},c==="right"&&l,m("div",{class:`${o}-collapse-item-arrow`,key:this.rtlEnabled?0:1},Et(a,{collapsed:s},()=>{var f;return[m(Vt,{clsPrefix:o},{default:(f=e.expandIcon)!==null&&f!==void 0?f:()=>this.rtlEnabled?m(_o,null):m(io,null)})]})),c==="left"&&l),Mn(r,{collapsed:s},f=>m("div",{class:`${o}-collapse-item__header-extra`,onClick:this.handleClick},f))),m(Fo,{clsPrefix:o,displayDirective:i,show:!s},t))}}),Oo={thPaddingSmall:"6px",thPaddingMedium:"12px",thPaddingLarge:"12px",tdPaddingSmall:"6px",tdPaddingMedium:"12px",tdPaddingLarge:"12px"},zo=e=>{const{dividerColor:t,cardColor:c,modalColor:s,popoverColor:i,tableHeaderColor:o,tableColorStriped:u,textColor1:l,textColor2:r,borderRadius:a,fontWeightStrong:f,lineHeight:h,fontSizeSmall:g,fontSizeMedium:p,fontSizeLarge:S}=e;return Object.assign(Object.assign({},Oo),{fontSizeSmall:g,fontSizeMedium:p,fontSizeLarge:S,lineHeight:h,borderRadius:a,borderColor:ve(c,t),borderColorModal:ve(s,t),borderColorPopover:ve(i,t),tdColor:c,tdColorModal:s,tdColorPopover:i,tdColorStriped:ve(c,u),tdColorStripedModal:ve(s,u),tdColorStripedPopover:ve(i,u),thColor:ve(c,o),thColorModal:ve(s,o),thColorPopover:ve(i,o),thTextColor:l,tdTextColor:r,thFontWeight:f})},Bo={name:"Table",common:xt,self:zo},Uo=Bo,Mo=e=>{const{borderRadiusSmall:t,hoverColor:c,pressedColor:s,primaryColor:i,textColor3:o,textColor2:u,textColorDisabled:l,fontSize:r}=e;return{fontSize:r,lineHeight:"1.5",nodeHeight:"30px",nodeWrapperPadding:"3px 0",nodeBorderRadius:t,nodeColorHover:c,nodeColorPressed:s,nodeColorActive:Vn(i,{alpha:.1}),arrowColor:o,nodeTextColor:u,nodeTextColorDisabled:l,loadingColor:i,dropMarkColor:i}},jo=jn({name:"Tree",common:xt,peers:{Checkbox:so,Scrollbar:Hn,Empty:co},self:Mo}),Ho=jo,Vo=K([D("table",`
 font-size: var(--n-font-size);
 font-variant-numeric: tabular-nums;
 line-height: var(--n-line-height);
 width: 100%;
 border-radius: var(--n-border-radius) var(--n-border-radius) 0 0;
 text-align: left;
 border-collapse: separate;
 border-spacing: 0;
 overflow: hidden;
 background-color: var(--n-td-color);
 border-color: var(--n-merged-border-color);
 transition:
 background-color .3s var(--n-bezier),
 border-color .3s var(--n-bezier),
 color .3s var(--n-bezier);
 --n-merged-border-color: var(--n-border-color);
 `,[K("th",`
 white-space: nowrap;
 transition:
 background-color .3s var(--n-bezier),
 border-color .3s var(--n-bezier),
 color .3s var(--n-bezier);
 text-align: inherit;
 padding: var(--n-th-padding);
 vertical-align: inherit;
 text-transform: none;
 border: 0px solid var(--n-merged-border-color);
 font-weight: var(--n-th-font-weight);
 color: var(--n-th-text-color);
 background-color: var(--n-th-color);
 border-bottom: 1px solid var(--n-merged-border-color);
 border-right: 1px solid var(--n-merged-border-color);
 `,[K("&:last-child",`
 border-right: 0px solid var(--n-merged-border-color);
 `)]),K("td",`
 transition:
 background-color .3s var(--n-bezier),
 border-color .3s var(--n-bezier),
 color .3s var(--n-bezier);
 padding: var(--n-td-padding);
 color: var(--n-td-text-color);
 background-color: var(--n-td-color);
 border: 0px solid var(--n-merged-border-color);
 border-right: 1px solid var(--n-merged-border-color);
 border-bottom: 1px solid var(--n-merged-border-color);
 `,[K("&:last-child",`
 border-right: 0px solid var(--n-merged-border-color);
 `)]),F("bordered",`
 border: 1px solid var(--n-merged-border-color);
 border-radius: var(--n-border-radius);
 `,[K("tr",[K("&:last-child",[K("td",`
 border-bottom: 0 solid var(--n-merged-border-color);
 `)])])]),F("single-line",[K("th",`
 border-right: 0px solid var(--n-merged-border-color);
 `),K("td",`
 border-right: 0px solid var(--n-merged-border-color);
 `)]),F("single-column",[K("tr",[K("&:not(:last-child)",[K("td",`
 border-bottom: 0px solid var(--n-merged-border-color);
 `)])])]),F("striped",[K("tr:nth-of-type(even)",[K("td","background-color: var(--n-td-color-striped)")])]),_e("bottom-bordered",[K("tr",[K("&:last-child",[K("td",`
 border-bottom: 0px solid var(--n-merged-border-color);
 `)])])])]),Wn(D("table",`
 background-color: var(--n-td-color-modal);
 --n-merged-border-color: var(--n-border-color-modal);
 `,[K("th",`
 background-color: var(--n-th-color-modal);
 `),K("td",`
 background-color: var(--n-td-color-modal);
 `)])),qn(D("table",`
 background-color: var(--n-td-color-popover);
 --n-merged-border-color: var(--n-border-color-popover);
 `,[K("th",`
 background-color: var(--n-th-color-popover);
 `),K("td",`
 background-color: var(--n-td-color-popover);
 `)]))]),Wo=Object.assign(Object.assign({},ze.props),{bordered:{type:Boolean,default:!0},bottomBordered:{type:Boolean,default:!0},singleLine:{type:Boolean,default:!0},striped:Boolean,singleColumn:Boolean,size:{type:String,default:"medium"}}),Zt=M({name:"Table",props:Wo,setup(e){const{mergedClsPrefixRef:t,inlineThemeDisabled:c,mergedRtlRef:s}=ot(e),i=ze("Table","-table",Vo,Uo,e,t),o=rt("Table",s,t),u=A(()=>{const{size:r}=e,{self:{borderColor:a,tdColor:f,tdColorModal:h,tdColorPopover:g,thColor:p,thColorModal:S,thColorPopover:_,thTextColor:N,tdTextColor:x,borderRadius:P,thFontWeight:T,lineHeight:E,borderColorModal:j,borderColorPopover:Y,tdColorStriped:he,tdColorStripedModal:de,tdColorStripedPopover:be,[ut("fontSize",r)]:ge,[ut("tdPadding",r)]:Ne,[ut("thPadding",r)]:Se},common:{cubicBezierEaseInOut:Be}}=i.value;return{"--n-bezier":Be,"--n-td-color":f,"--n-td-color-modal":h,"--n-td-color-popover":g,"--n-td-text-color":x,"--n-border-color":a,"--n-border-color-modal":j,"--n-border-color-popover":Y,"--n-border-radius":P,"--n-font-size":ge,"--n-th-color":p,"--n-th-color-modal":S,"--n-th-color-popover":_,"--n-th-font-weight":T,"--n-th-text-color":N,"--n-line-height":E,"--n-td-padding":Ne,"--n-th-padding":Se,"--n-td-color-striped":he,"--n-td-color-striped-modal":de,"--n-td-color-striped-popover":be}}),l=c?kt("table",A(()=>e.size[0]),u,e):void 0;return{rtlEnabled:o,mergedClsPrefix:t,cssVars:c?void 0:u,themeClass:l==null?void 0:l.themeClass,onRender:l==null?void 0:l.onRender}},render(){var e;const{mergedClsPrefix:t}=this;return(e=this.onRender)===null||e===void 0||e.call(this),m("table",{class:[`${t}-table`,this.themeClass,{[`${t}-table--rtl`]:this.rtlEnabled,[`${t}-table--bottom-bordered`]:this.bottomBordered,[`${t}-table--bordered`]:this.bordered,[`${t}-table--single-line`]:this.singleLine,[`${t}-table--single-column`]:this.singleColumn,[`${t}-table--striped`]:this.striped}],style:this.cssVars},this.$slots)}}),pe=M({name:"Th",render(){return m("th",null,this.$slots)}}),Xe=M({name:"Tr",render(){return m("tr",null,this.$slots)}}),fe=M({name:"Td",render(){return m("td",null,this.$slots)}}),qo=M({name:"Thead",render(){return m("thead",null,this.$slots)}}),Qt=M({name:"Tbody",render(){return m("tbody",null,this.$slots)}}),en=wt("n-tree-select"),Ge=wt("n-tree"),Xo=M({name:"NTreeSwitcher",props:{clsPrefix:{type:String,required:!0},indent:{type:Number,required:!0},expanded:Boolean,selected:Boolean,hide:Boolean,loading:Boolean,onClick:Function,tmNode:{type:Object,required:!0}},setup(e){const{renderSwitcherIconRef:t}=Ke(Ge,null);return()=>{const{clsPrefix:c,expanded:s,hide:i,indent:o,onClick:u}=e;return m("span",{"data-switcher":!0,class:[`${c}-tree-node-switcher`,s&&`${c}-tree-node-switcher--expanded`,i&&`${c}-tree-node-switcher--hide`],style:{width:`${o}px`},onClick:u},m("div",{class:`${c}-tree-node-switcher__icon`},m(Xn,null,{default:()=>{if(e.loading)return m(Gn,{clsPrefix:c,key:"loading",radius:85,strokeWidth:20});const{value:l}=t;return l?l({expanded:e.expanded,selected:e.selected,option:e.tmNode.rawNode}):m(Vt,{clsPrefix:c,key:"switcher"},{default:()=>m(Ko,null)})}})))}}}),Go=M({name:"NTreeNodeCheckbox",props:{clsPrefix:{type:String,required:!0},indent:{type:Number,required:!0},right:Boolean,focusable:Boolean,disabled:Boolean,checked:Boolean,indeterminate:Boolean,onCheck:Function},setup(e){const t=Ke(Ge);function c(i){const{onCheck:o}=e;o&&o(i)}function s(i){c(i)}return{handleUpdateValue:s,mergedTheme:t.mergedThemeRef}},render(){const{clsPrefix:e,mergedTheme:t,checked:c,indeterminate:s,disabled:i,focusable:o,indent:u,handleUpdateValue:l}=this;return m("span",{class:[`${e}-tree-node-checkbox`,this.right&&`${e}-tree-node-checkbox--right`],style:{width:`${u}px`},"data-checkbox":!0},m(uo,{focusable:o,disabled:i,theme:t.peers.Checkbox,themeOverrides:t.peerOverrides.Checkbox,checked:c,indeterminate:s,onUpdateChecked:l}))}}),Yo=M({name:"TreeNodeContent",props:{clsPrefix:{type:String,required:!0},disabled:Boolean,checked:Boolean,selected:Boolean,onClick:Function,onDragstart:Function,tmNode:{type:Object,required:!0},nodeProps:Object},setup(e){const{renderLabelRef:t,renderPrefixRef:c,renderSuffixRef:s,labelFieldRef:i}=Ke(Ge),o=H(null);function u(r){const{onClick:a}=e;a&&a(r)}function l(r){u(r)}return{selfRef:o,renderLabel:t,renderPrefix:c,renderSuffix:s,labelField:i,handleClick:l}},render(){const{clsPrefix:e,labelField:t,nodeProps:c,checked:s=!1,selected:i=!1,renderLabel:o,renderPrefix:u,renderSuffix:l,handleClick:r,onDragstart:a,tmNode:{rawNode:f,rawNode:{prefix:h,suffix:g,[t]:p}}}=this;return m("span",Object.assign({},c,{ref:"selfRef",class:[`${e}-tree-node-content`,c==null?void 0:c.class],onClick:r,draggable:a===void 0?void 0:!0,onDragstart:a}),u||h?m("div",{class:`${e}-tree-node-content__prefix`},u?u({option:f,selected:i,checked:s}):ft(h)):null,m("div",{class:`${e}-tree-node-content__text`},o?o({option:f,selected:i,checked:s}):ft(p)),l||g?m("div",{class:`${e}-tree-node-content__suffix`},l?l({option:f,selected:i,checked:s}):ft(g)):null)}});function Mt({position:e,offsetLevel:t,indent:c,el:s}){const i={position:"absolute",boxSizing:"border-box",right:0};if(e==="inside")i.left=0,i.top=0,i.bottom=0,i.borderRadius="inherit",i.boxShadow="inset 0 0 0 2px var(--n-drop-mark-color)";else{const o=e==="before"?"top":"bottom";i[o]=0,i.left=`${s.offsetLeft+6-t*c}px`,i.height="2px",i.backgroundColor="var(--n-drop-mark-color)",i.transformOrigin=o,i.borderRadius="1px",i.transform=e==="before"?"translateY(-4px)":"translateY(4px)"}return m("div",{style:i})}function Jo({dropPosition:e,node:t}){return t.isLeaf===!1||t.children?!0:e!=="inside"}function Zo(e){return A(()=>e.leafOnly?"child":e.checkStrategy)}function we(e,t){return!!e.rawNode[t]}function tn(e,t,c,s){e==null||e.forEach(i=>{c(i),tn(i[t],t,c,s),s(i)})}function Qo(e,t,c,s,i){const o=new Set,u=new Set,l=[];return tn(e,s,r=>{if(l.push(r),i(t,r)){u.add(r[c]);for(let a=l.length-2;a>=0;--a)if(!o.has(l[a][c]))o.add(l[a][c]);else return}},()=>{l.pop()}),{expandedKeys:Array.from(o),highlightKeySet:u}}if(Yn&&Image){const e=new Image;e.src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw=="}function er(e,t,c,s,i){const o=new Set,u=new Set,l=new Set,r=[],a=[],f=[];function h(p){p.forEach(S=>{if(f.push(S),t(c,S)){o.add(S[s]),l.add(S[s]);for(let N=f.length-2;N>=0;--N){const x=f[N][s];if(!u.has(x))u.add(x),o.has(x)&&o.delete(x);else break}}const _=S[i];_&&h(_),f.pop()})}h(e);function g(p,S){p.forEach(_=>{const N=_[s],x=o.has(N),P=u.has(N);if(!x&&!P)return;const T=_[i];if(T)if(x)S.push(_);else{r.push(N);const E=Object.assign(Object.assign({},_),{[i]:[]});S.push(E),g(T,E[i])}else S.push(_)})}return g(e,a),{filteredTree:a,highlightKeySet:l,expandedKeys:r}}const tr=M({name:"TreeNode",props:{clsPrefix:{type:String,required:!0},tmNode:{type:Object,required:!0}},setup(e){const t=Ke(Ge),{droppingNodeParentRef:c,droppingMouseNodeRef:s,draggingNodeRef:i,droppingPositionRef:o,droppingOffsetLevelRef:u,nodePropsRef:l,indentRef:r,blockLineRef:a,checkboxPlacementRef:f,checkOnClickRef:h,disabledFieldRef:g,showLineRef:p}=t,S=G(()=>!!e.tmNode.rawNode.checkboxDisabled),_=G(()=>we(e.tmNode,g.value)),N=G(()=>t.disabledRef.value||_.value),x=A(()=>{const{value:y}=l;if(y)return y({option:e.tmNode.rawNode})}),P=H(null),T={value:null};Jn(()=>{T.value=P.value.$el});function E(){const{tmNode:y}=e;if(!y.isLeaf&&!y.shallowLoaded){if(!t.loadingKeysRef.value.has(y.key))t.loadingKeysRef.value.add(y.key);else return;const{onLoadRef:{value:L}}=t;L&&L(y.rawNode).then(z=>{z!==!1&&t.handleSwitcherClick(y)}).finally(()=>{t.loadingKeysRef.value.delete(y.key)})}else t.handleSwitcherClick(y)}const j=G(()=>!_.value&&t.selectableRef.value&&(t.internalTreeSelect?t.mergedCheckStrategyRef.value!=="child"||t.multipleRef.value&&t.cascadeRef.value||e.tmNode.isLeaf:!0)),Y=G(()=>t.checkableRef.value&&(t.cascadeRef.value||t.mergedCheckStrategyRef.value!=="child"||e.tmNode.isLeaf)),he=G(()=>t.displayedCheckedKeysRef.value.includes(e.tmNode.key)),de=G(()=>{const{value:y}=Y;if(!y)return!1;const{value:L}=h,{tmNode:z}=e;return typeof L=="boolean"?!z.disabled&&L:L(e.tmNode.rawNode)});function be(y){const{value:L}=t.expandOnClickRef,{value:z}=j,{value:J}=de;if(!z&&!L&&!J||It(y,"checkbox")||It(y,"switcher"))return;const{tmNode:Ye}=e;z&&t.handleSelect(Ye),L&&!Ye.isLeaf&&E(),J&&Se(!he.value)}function ge(y){var L,z;a.value||(N.value||be(y),(z=(L=x.value)===null||L===void 0?void 0:L.onClick)===null||z===void 0||z.call(L,y))}function Ne(y){var L,z;a.value&&(N.value||be(y),(z=(L=x.value)===null||L===void 0?void 0:L.onClick)===null||z===void 0||z.call(L,y))}function Se(y){t.handleCheck(e.tmNode,y)}function Be(y){t.handleDragStart({event:y,node:e.tmNode})}function oe(y){y.currentTarget===y.target&&t.handleDragEnter({event:y,node:e.tmNode})}function me(y){y.preventDefault(),t.handleDragOver({event:y,node:e.tmNode})}function ye(y){t.handleDragEnd({event:y,node:e.tmNode})}function lt(y){y.currentTarget===y.target&&t.handleDragLeave({event:y,node:e.tmNode})}function se(y){y.preventDefault(),o.value!==null&&t.handleDrop({event:y,node:e.tmNode,dropPosition:o.value})}const xe=A(()=>{const{clsPrefix:y}=e,{value:L}=r;if(p.value){const z=[];let J=e.tmNode.parent;for(;J;)J.isLastChild?z.push(m("div",{class:`${y}-tree-node-indent`},m("div",{style:{width:`${L}px`}}))):z.push(m("div",{class:[`${y}-tree-node-indent`,`${y}-tree-node-indent--show-line`]},m("div",{style:{width:`${L}px`}}))),J=J.parent;return z.reverse()}else return Zn(e.tmNode.level,m("div",{class:`${e.clsPrefix}-tree-node-indent`},m("div",{style:{width:`${L}px`}})))});return{showDropMark:G(()=>{const{value:y}=i;if(!y)return;const{value:L}=o;if(!L)return;const{value:z}=s;if(!z)return;const{tmNode:J}=e;return J.key===z.key}),showDropMarkAsParent:G(()=>{const{value:y}=c;if(!y)return!1;const{tmNode:L}=e,{value:z}=o;return z==="before"||z==="after"?y.key===L.key:!1}),pending:G(()=>t.pendingNodeKeyRef.value===e.tmNode.key),loading:G(()=>t.loadingKeysRef.value.has(e.tmNode.key)),highlight:G(()=>{var y;return(y=t.highlightKeySetRef.value)===null||y===void 0?void 0:y.has(e.tmNode.key)}),checked:he,indeterminate:G(()=>t.displayedIndeterminateKeysRef.value.includes(e.tmNode.key)),selected:G(()=>t.mergedSelectedKeysRef.value.includes(e.tmNode.key)),expanded:G(()=>t.mergedExpandedKeysRef.value.includes(e.tmNode.key)),disabled:N,checkable:Y,mergedCheckOnClick:de,checkboxDisabled:S,selectable:j,expandOnClick:t.expandOnClickRef,internalScrollable:t.internalScrollableRef,draggable:t.draggableRef,blockLine:a,nodeProps:x,checkboxFocusable:t.internalCheckboxFocusableRef,droppingPosition:o,droppingOffsetLevel:u,indent:r,checkboxPlacement:f,showLine:p,contentInstRef:P,contentElRef:T,indentNodes:xe,handleCheck:Se,handleDrop:se,handleDragStart:Be,handleDragEnter:oe,handleDragOver:me,handleDragEnd:ye,handleDragLeave:lt,handleLineClick:Ne,handleContentClick:ge,handleSwitcherClick:E}},render(){const{tmNode:e,clsPrefix:t,checkable:c,expandOnClick:s,selectable:i,selected:o,checked:u,highlight:l,draggable:r,blockLine:a,indent:f,indentNodes:h,disabled:g,pending:p,internalScrollable:S,nodeProps:_,checkboxPlacement:N}=this,x=r&&!g?{onDragenter:this.handleDragEnter,onDragleave:this.handleDragLeave,onDragend:this.handleDragEnd,onDrop:this.handleDrop,onDragover:this.handleDragOver}:void 0,P=S?Yt(e.key):void 0,T=N==="right",E=c?m(Go,{indent:f,right:T,focusable:this.checkboxFocusable,disabled:g||this.checkboxDisabled,clsPrefix:t,checked:this.checked,indeterminate:this.indeterminate,onCheck:this.handleCheck}):null;return m("div",Object.assign({class:`${t}-tree-node-wrapper`},x),m("div",Object.assign({},a?_:void 0,{class:[`${t}-tree-node`,{[`${t}-tree-node--selected`]:o,[`${t}-tree-node--checkable`]:c,[`${t}-tree-node--highlight`]:l,[`${t}-tree-node--pending`]:p,[`${t}-tree-node--disabled`]:g,[`${t}-tree-node--selectable`]:i,[`${t}-tree-node--clickable`]:i||s||this.mergedCheckOnClick},_==null?void 0:_.class],"data-key":P,draggable:r&&a,onClick:this.handleLineClick,onDragstart:r&&a&&!g?this.handleDragStart:void 0}),h,e.isLeaf&&this.showLine?m("div",{class:[`${t}-tree-node-indent`,`${t}-tree-node-indent--show-line`,e.isLeaf&&`${t}-tree-node-indent--is-leaf`,e.isLastChild&&`${t}-tree-node-indent--last-child`]},m("div",{style:{width:`${f}px`}})):m(Xo,{clsPrefix:t,expanded:this.expanded,selected:o,loading:this.loading,hide:e.isLeaf,tmNode:this.tmNode,indent:f,onClick:this.handleSwitcherClick}),T?null:E,m(Yo,{ref:"contentInstRef",clsPrefix:t,checked:u,selected:o,onClick:this.handleContentClick,nodeProps:a?void 0:_,onDragstart:r&&!a&&!g?this.handleDragStart:void 0,tmNode:e}),r?this.showDropMark?Mt({el:this.contentElRef.value,position:this.droppingPosition,offsetLevel:this.droppingOffsetLevel,indent:f}):this.showDropMarkAsParent?Mt({el:this.contentElRef.value,position:"inside",offsetLevel:this.droppingOffsetLevel,indent:f}):null:null,T?E:null))}}),nn=tr;function nr({props:e,fNodesRef:t,mergedExpandedKeysRef:c,mergedSelectedKeysRef:s,handleSelect:i,handleSwitcherClick:o}){const{value:u}=s,l=Ke(en,null),r=l?l.pendingNodeKeyRef:H(u.length?u[u.length-1]:null);function a(f){if(!e.keyboard)return;const{value:h}=r;if(h===null){if((f.key==="ArrowDown"||f.key==="ArrowUp")&&f.preventDefault(),["ArrowDown","ArrowUp","ArrowLeft","ArrowRight"].includes(f.key)&&h===null){const{value:g}=t;let p=0;for(;p<g.length;){if(!g[p].disabled){r.value=g[p].key;break}p+=1}}}else{const{value:g}=t;let p=g.findIndex(S=>S.key===h);if(!~p)return;if(f.key==="Enter")i(g[p]);else if(f.key==="ArrowDown")for(f.preventDefault(),p+=1;p<g.length;){if(!g[p].disabled){r.value=g[p].key;break}p+=1}else if(f.key==="ArrowUp")for(f.preventDefault(),p-=1;p>=0;){if(!g[p].disabled){r.value=g[p].key;break}p-=1}else if(f.key==="ArrowLeft"){const S=g[p];if(S.isLeaf||!c.value.includes(h)){const _=S.getParent();_&&(r.value=_.key)}else o(S)}else if(f.key==="ArrowRight"){const S=g[p];if(S.isLeaf)return;if(!c.value.includes(h))o(S);else for(p+=1;p<g.length;){if(!g[p].disabled){r.value=g[p].key;break}p+=1}}}}return{pendingNodeKeyRef:r,handleKeydown:a}}const or=M({name:"TreeMotionWrapper",props:{clsPrefix:{type:String,required:!0},height:Number,nodes:{type:Array,required:!0},mode:{type:String,required:!0},onAfterEnter:{type:Function,required:!0}},render(){const{clsPrefix:e}=this;return m(Ht,{onAfterEnter:this.onAfterEnter,appear:!0,reverse:this.mode==="collapse"},{default:()=>m("div",{class:[`${e}-tree-motion-wrapper`,`${e}-tree-motion-wrapper--${this.mode}`],style:{height:Wt(this.height)}},this.nodes.map(t=>m(nn,{clsPrefix:e,tmNode:t})))})}}),vt=Qn(),rr=D("tree",`
 font-size: var(--n-font-size);
 outline: none;
`,[K("ul, li",`
 margin: 0;
 padding: 0;
 list-style: none;
 `),K(">",[D("tree-node",[K("&:first-child","margin-top: 0;")])]),D("tree-motion-wrapper",[F("expand",[pt({duration:"0.2s"})]),F("collapse",[pt({duration:"0.2s",reverse:!0})])]),D("tree-node-wrapper",`
 box-sizing: border-box;
 padding: var(--n-node-wrapper-padding);
 `),D("tree-node",`
 transform: translate3d(0,0,0);
 position: relative;
 display: flex;
 border-radius: var(--n-node-border-radius);
 transition: background-color .3s var(--n-bezier);
 `,[F("highlight",[D("tree-node-content",[X("text","border-bottom-color: var(--n-node-text-color-disabled);")])]),F("disabled",[D("tree-node-content",`
 color: var(--n-node-text-color-disabled);
 cursor: not-allowed;
 `)]),_e("disabled",[F("clickable",[D("tree-node-content",`
 cursor: pointer;
 `)])])]),F("block-node",[D("tree-node-content",`
 flex: 1;
 min-width: 0;
 `)]),_e("block-line",[D("tree-node",[_e("disabled",[D("tree-node-content",[K("&:hover","background: var(--n-node-color-hover);")]),F("selectable",[D("tree-node-content",[K("&:active","background: var(--n-node-color-pressed);")])]),F("pending",[D("tree-node-content",`
 background: var(--n-node-color-hover);
 `)]),F("selected",[D("tree-node-content","background: var(--n-node-color-active);")])])])]),F("block-line",[D("tree-node",[_e("disabled",[K("&:hover","background: var(--n-node-color-hover);"),F("pending",`
 background: var(--n-node-color-hover);
 `),F("selectable",[_e("selected",[K("&:active","background: var(--n-node-color-pressed);")])]),F("selected","background: var(--n-node-color-active);")]),F("disabled",`
 cursor: not-allowed;
 `)])]),D("tree-node-indent",`
 flex-grow: 0;
 flex-shrink: 0;
 `,[F("show-line","position: relative",[K("&::before",`
 position: absolute;
 left: 50%;
 border-left: 1px solid var(--n-border-color);
 transition: border-color .3s var(--n-bezier);
 transform: translate(-50%);
 content: "";
 top: var(--n-line-offset-top);
 bottom: var(--n-line-offset-bottom);
 `),F("last-child",[K("&::before",`
 bottom: 50%;
 `)]),F("is-leaf",[K("&::after",`
 position: absolute;
 content: "";
 left: calc(50% + 0.5px);
 right: 0;
 bottom: 50%;
 transition: border-color .3s var(--n-bezier);
 border-bottom: 1px solid var(--n-border-color);
 `)])]),_e("show-line","height: 0;")]),D("tree-node-switcher",`
 cursor: pointer;
 display: inline-flex;
 flex-shrink: 0;
 height: var(--n-node-content-height);
 align-items: center;
 justify-content: center;
 transition: transform .15s var(--n-bezier);
 vertical-align: bottom;
 `,[X("icon",`
 position: relative;
 height: 14px;
 width: 14px;
 display: flex;
 color: var(--n-arrow-color);
 transition: color .3s var(--n-bezier);
 font-size: 14px;
 `,[D("icon",[vt]),D("base-loading",`
 color: var(--n-loading-color);
 position: absolute;
 left: 0;
 top: 0;
 right: 0;
 bottom: 0;
 `,[vt]),D("base-icon",[vt])]),F("hide","visibility: hidden;"),F("expanded","transform: rotate(90deg);")]),D("tree-node-checkbox",`
 display: inline-flex;
 height: var(--n-node-content-height);
 vertical-align: bottom;
 align-items: center;
 justify-content: center;
 `),D("tree-node-content",`
 user-select: none;
 position: relative;
 display: inline-flex;
 align-items: center;
 min-height: var(--n-node-content-height);
 box-sizing: border-box;
 line-height: var(--n-line-height);
 vertical-align: bottom;
 padding: 0 6px 0 4px;
 cursor: default;
 border-radius: var(--n-node-border-radius);
 color: var(--n-node-text-color);
 transition:
 color .3s var(--n-bezier),
 background-color .3s var(--n-bezier),
 border-color .3s var(--n-bezier);
 `,[K("&:last-child","margin-bottom: 0;"),X("prefix",`
 display: inline-flex;
 margin-right: 8px;
 `),X("text",`
 border-bottom: 1px solid #0000;
 transition: border-color .3s var(--n-bezier);
 flex-grow: 1;
 max-width: 100%;
 `),X("suffix",`
 display: inline-flex;
 `)]),X("empty","margin: auto;")]);var lr=globalThis&&globalThis.__awaiter||function(e,t,c,s){function i(o){return o instanceof c?o:new c(function(u){u(o)})}return new(c||(c=Promise))(function(o,u){function l(f){try{a(s.next(f))}catch(h){u(h)}}function r(f){try{a(s.throw(f))}catch(h){u(h)}}function a(f){f.done?o(f.value):i(f.value).then(l,r)}a((s=s.apply(e,t||[])).next())})};function ar(e,t,c,s){return{getIsGroup(){return!1},getKey(o){return o[e]},getChildren:s||(o=>o[t]),getDisabled(o){return!!(o[c]||o.checkboxDisabled)}}}const ir={allowCheckingNotLoaded:Boolean,filter:Function,defaultExpandAll:Boolean,expandedKeys:Array,keyField:{type:String,default:"key"},labelField:{type:String,default:"label"},childrenField:{type:String,default:"children"},disabledField:{type:String,default:"disabled"},defaultExpandedKeys:{type:Array,default:()=>[]},indeterminateKeys:Array,renderSwitcherIcon:Function,onUpdateIndeterminateKeys:[Function,Array],"onUpdate:indeterminateKeys":[Function,Array],onUpdateExpandedKeys:[Function,Array],"onUpdate:expandedKeys":[Function,Array]},dr=Object.assign(Object.assign(Object.assign(Object.assign({},ze.props),{accordion:Boolean,showIrrelevantNodes:{type:Boolean,default:!0},data:{type:Array,default:()=>[]},expandOnDragenter:{type:Boolean,default:!0},expandOnClick:Boolean,checkOnClick:{type:[Boolean,Function],default:!1},cancelable:{type:Boolean,default:!0},checkable:Boolean,draggable:Boolean,blockNode:Boolean,blockLine:Boolean,showLine:Boolean,disabled:Boolean,checkedKeys:Array,defaultCheckedKeys:{type:Array,default:()=>[]},selectedKeys:Array,defaultSelectedKeys:{type:Array,default:()=>[]},multiple:Boolean,pattern:{type:String,default:""},onLoad:Function,cascade:Boolean,selectable:{type:Boolean,default:!0},scrollbarProps:Object,indent:{type:Number,default:24},allowDrop:{type:Function,default:Jo},animated:{type:Boolean,default:!0},checkboxPlacement:{type:String,default:"left"},virtualScroll:Boolean,watchProps:Array,renderLabel:Function,renderPrefix:Function,renderSuffix:Function,nodeProps:Function,keyboard:{type:Boolean,default:!0},getChildren:Function,onDragenter:[Function,Array],onDragleave:[Function,Array],onDragend:[Function,Array],onDragstart:[Function,Array],onDragover:[Function,Array],onDrop:[Function,Array],onUpdateCheckedKeys:[Function,Array],"onUpdate:checkedKeys":[Function,Array],onUpdateSelectedKeys:[Function,Array],"onUpdate:selectedKeys":[Function,Array]}),ir),{internalTreeSelect:Boolean,internalScrollable:Boolean,internalScrollablePadding:String,internalRenderEmpty:Function,internalHighlightKeySet:Object,internalUnifySelectCheck:Boolean,internalCheckboxFocusable:{type:Boolean,default:!0},internalFocusable:{type:Boolean,default:!0},checkStrategy:{type:String,default:"all"},leafOnly:Boolean}),sr=M({name:"Tree",props:dr,setup(e){const{mergedClsPrefixRef:t,inlineThemeDisabled:c,mergedRtlRef:s}=ot(e),i=rt("Tree",s,t),o=ze("Tree","-tree",rr,Ho,e,t),u=H(null),l=H(null),r=H(null);function a(){var n;return(n=r.value)===null||n===void 0?void 0:n.listElRef}function f(){var n;return(n=r.value)===null||n===void 0?void 0:n.itemsElRef}const h=A(()=>{const{filter:n}=e;if(n)return n;const{labelField:d}=e;return(v,C)=>{if(!v.length)return!0;const k=C[d];return typeof k=="string"?k.toLowerCase().includes(v.toLowerCase()):!1}}),g=A(()=>{const{pattern:n}=e;return n?!n.length||!h.value?{filteredTree:e.data,highlightKeySet:null,expandedKeys:void 0}:er(e.data,h.value,n,e.keyField,e.childrenField):{filteredTree:e.data,highlightKeySet:null,expandedKeys:void 0}}),p=A(()=>ho(e.showIrrelevantNodes?e.data:g.value.filteredTree,ar(e.keyField,e.childrenField,e.disabledField,e.getChildren))),S=Ke(en,null),_=e.internalTreeSelect?S.dataTreeMate:p,{watchProps:N}=e,x=H([]);N!=null&&N.includes("defaultCheckedKeys")?Ce(()=>{x.value=e.defaultCheckedKeys}):x.value=e.defaultCheckedKeys;const P=O(e,"checkedKeys"),T=qe(P,x),E=A(()=>_.value.getCheckedKeys(T.value,{cascade:e.cascade,allowNotLoaded:e.allowCheckingNotLoaded})),j=Zo(e),Y=A(()=>E.value.checkedKeys),he=A(()=>{const{indeterminateKeys:n}=e;return n!==void 0?n:E.value.indeterminateKeys}),de=H([]);N!=null&&N.includes("defaultSelectedKeys")?Ce(()=>{de.value=e.defaultSelectedKeys}):de.value=e.defaultSelectedKeys;const be=O(e,"selectedKeys"),ge=qe(be,de),Ne=H([]),Se=n=>{Ne.value=e.defaultExpandAll?_.value.getNonLeafKeys():n===void 0?e.defaultExpandedKeys:n};N!=null&&N.includes("defaultExpandedKeys")?Ce(()=>{Se(void 0)}):Ce(()=>{Se(e.defaultExpandedKeys)});const Be=O(e,"expandedKeys"),oe=qe(Be,Ne),me=A(()=>p.value.getFlattenedNodes(oe.value)),{pendingNodeKeyRef:ye,handleKeydown:lt}=nr({props:e,mergedSelectedKeysRef:ge,fNodesRef:me,mergedExpandedKeysRef:oe,handleSelect:st,handleSwitcherClick:_t});let se=null,xe=null;const y=H(new Set),L=A(()=>e.internalHighlightKeySet||g.value.highlightKeySet),z=qe(L,y),J=H(new Set),Ye=A(()=>oe.value.filter(n=>!J.value.has(n)));let Ct=0;const Ue=H(null),Je=H(null),Ze=H(null),Qe=H(null),et=H(0),rn=A(()=>{const{value:n}=Je;return n?n.parent:null});We(O(e,"data"),()=>{J.value.clear(),ye.value=null,je()},{deep:!1});let at=!1;const it=()=>{at=!0,nt(()=>{at=!1})};let Me;We(O(e,"pattern"),(n,d)=>{if(e.showIrrelevantNodes)if(Me=void 0,n){const{expandedKeys:v,highlightKeySet:C}=Qo(e.data,e.pattern,e.keyField,e.childrenField,h.value);y.value=C,it(),De(v,Q(v),{node:null,action:"filter"})}else y.value=new Set;else if(!n.length)Me!==void 0&&(it(),De(Me,Q(Me),{node:null,action:"filter"}));else{d.length||(Me=oe.value);const{expandedKeys:v}=g.value;v!==void 0&&(it(),De(v,Q(v),{node:null,action:"filter"}))}});function Nt(n){return lr(this,void 0,void 0,function*(){const{onLoad:d}=e;if(!d){yield Promise.resolve();return}const{value:v}=J;if(!v.has(n.key)){v.add(n.key);try{(yield d(n.rawNode))===!1&&Pe()}catch(C){console.error(C),Pe()}v.delete(n.key)}})}Ce(()=>{var n;const{value:d}=p;if(!d)return;const{getNode:v}=d;(n=oe.value)===null||n===void 0||n.forEach(C=>{const k=v(C);k&&!k.shallowLoaded&&Nt(k)})});const Te=H(!1),ke=H([]);We(Ye,(n,d)=>{if(!e.animated||at){nt(tt);return}const v=Ve(o.value.self.nodeHeight),C=new Set(d);let k=null,U=null;for(const I of n)if(!C.has(I)){if(k!==null)return;k=I}const Z=new Set(n);for(const I of d)if(!Z.has(I)){if(U!==null)return;U=I}if(k===null&&U===null)return;const{virtualScroll:ee}=e,$e=(ee?r.value.listElRef:u.value).offsetHeight,Ee=Math.ceil($e/v)+1;let re;if(k!==null&&(re=d),U!==null&&(re===void 0?re=n:re=re.filter(I=>I!==U)),Te.value=!0,ke.value=p.value.getFlattenedNodes(re),k!==null){const I=ke.value.findIndex(le=>le.key===k);if(~I){const le=ke.value[I].children;if(le){const ce=Ot(le,n);ke.value.splice(I+1,0,{__motion:!0,mode:"expand",height:ee?ce.length*v:void 0,nodes:ee?ce.slice(0,Ee):ce})}}}if(U!==null){const I=ke.value.findIndex(le=>le.key===U);if(~I){const le=ke.value[I].children;if(!le)return;Te.value=!0;const ce=Ot(le,n);ke.value.splice(I+1,0,{__motion:!0,mode:"collapse",height:ee?ce.length*v:void 0,nodes:ee?ce.slice(0,Ee):ce})}}});const ln=A(()=>go(me.value)),an=A(()=>Te.value?ke.value:me.value);function tt(){const{value:n}=l;n&&n.sync()}function dn(){Te.value=!1,e.virtualScroll&&nt(tt)}function Q(n){const{getNode:d}=_.value;return n.map(v=>{var C;return((C=d(v))===null||C===void 0?void 0:C.rawNode)||null})}function De(n,d,v){const{"onUpdate:expandedKeys":C,onUpdateExpandedKeys:k}=e;Ne.value=n,C&&V(C,n,d,v),k&&V(k,n,d,v)}function St(n,d,v){const{"onUpdate:checkedKeys":C,onUpdateCheckedKeys:k}=e;x.value=n,k&&V(k,n,d,v),C&&V(C,n,d,v)}function sn(n,d){const{"onUpdate:indeterminateKeys":v,onUpdateIndeterminateKeys:C}=e;v&&V(v,n,d),C&&V(C,n,d)}function dt(n,d,v){const{"onUpdate:selectedKeys":C,onUpdateSelectedKeys:k}=e;de.value=n,k&&V(k,n,d,v),C&&V(C,n,d,v)}function cn(n){const{onDragenter:d}=e;d&&V(d,n)}function un(n){const{onDragleave:d}=e;d&&V(d,n)}function fn(n){const{onDragend:d}=e;d&&V(d,n)}function hn(n){const{onDragstart:d}=e;d&&V(d,n)}function gn(n){const{onDragover:d}=e;d&&V(d,n)}function vn(n){const{onDrop:d}=e;d&&V(d,n)}function je(){pn(),Re()}function pn(){Ue.value=null}function Re(){et.value=0,Je.value=null,Ze.value=null,Qe.value=null,Pe()}function Pe(){se&&(window.clearTimeout(se),se=null),xe=null}function Rt(n,d){if(e.disabled||we(n,e.disabledField))return;if(e.internalUnifySelectCheck&&!e.multiple){st(n);return}const v=d?"check":"uncheck",{checkedKeys:C,indeterminateKeys:k}=_.value[v](n.key,Y.value,{cascade:e.cascade,checkStrategy:j.value,allowNotLoaded:e.allowCheckingNotLoaded});St(C,Q(C),{node:n.rawNode,action:v}),sn(k,Q(k))}function bn(n){if(e.disabled)return;const{key:d}=n,{value:v}=oe,C=v.findIndex(k=>k===d);if(~C){const k=Array.from(v);k.splice(C,1),De(k,Q(k),{node:n.rawNode,action:"collapse"})}else{const k=p.value.getNode(d);if(!k||k.isLeaf)return;let U;if(e.accordion){const Z=new Set(n.siblings.map(({key:ee})=>ee));U=v.filter(ee=>!Z.has(ee)),U.push(d)}else U=v.concat(d);De(U,Q(U),{node:n.rawNode,action:"expand"})}}function _t(n){e.disabled||Te.value||bn(n)}function st(n){if(!(e.disabled||!e.selectable)){if(ye.value=n.key,e.internalUnifySelectCheck){const{value:{checkedKeys:d,indeterminateKeys:v}}=E;e.multiple?Rt(n,!(d.includes(n.key)||v.includes(n.key))):St([n.key],Q([n.key]),{node:n.rawNode,action:"check"})}if(e.multiple){const d=Array.from(ge.value),v=d.findIndex(C=>C===n.key);~v?e.cancelable&&d.splice(v,1):~v||d.push(n.key),dt(d,Q(d),{node:n.rawNode,action:~v?"unselect":"select"})}else ge.value.includes(n.key)?e.cancelable&&dt([],[],{node:n.rawNode,action:"unselect"}):dt([n.key],Q([n.key]),{node:n.rawNode,action:"select"})}}function mn(n){if(se&&(window.clearTimeout(se),se=null),n.isLeaf)return;xe=n.key;const d=()=>{if(xe!==n.key)return;const{value:v}=Ze;if(v&&v.key===n.key&&!oe.value.includes(n.key)){const C=oe.value.concat(n.key);De(C,Q(C),{node:n.rawNode,action:"expand"})}se=null,xe=null};n.shallowLoaded?se=window.setTimeout(()=>{d()},1e3):se=window.setTimeout(()=>{Nt(n).then(()=>{d()})},1e3)}function yn({event:n,node:d}){!e.draggable||e.disabled||we(d,e.disabledField)||(Kt({event:n,node:d},!1),cn({event:n,node:d.rawNode}))}function xn({event:n,node:d}){!e.draggable||e.disabled||we(d,e.disabledField)||un({event:n,node:d.rawNode})}function kn(n){n.target===n.currentTarget&&Re()}function wn({event:n,node:d}){je(),!(!e.draggable||e.disabled||we(d,e.disabledField))&&fn({event:n,node:d.rawNode})}function Cn({event:n,node:d}){!e.draggable||e.disabled||we(d,e.disabledField)||(Ct=n.clientX,Ue.value=d,hn({event:n,node:d.rawNode}))}function Kt({event:n,node:d},v=!0){var C;if(!e.draggable||e.disabled||we(d,e.disabledField))return;const{value:k}=Ue;if(!k)return;const{allowDrop:U,indent:Z}=e;v&&gn({event:n,node:d.rawNode});const ee=n.currentTarget,{height:$e,top:Ee}=ee.getBoundingClientRect(),re=n.clientY-Ee;let I;U({node:d.rawNode,dropPosition:"inside",phase:"drag"})?re<=8?I="before":re>=$e-8?I="after":I="inside":re<=$e/2?I="before":I="after";const{value:ce}=ln;let $,q;const He=ce(d.key);if(He===null){Re();return}let Dt=!1;I==="inside"?($=d,q="inside"):I==="before"?d.isFirstChild?($=d,q="before"):($=me.value[He-1],q="after"):($=d,q="after"),!$.isLeaf&&oe.value.includes($.key)&&(Dt=!0,q==="after"&&($=me.value[He+1],$?q="before":($=d,q="inside")));const Pt=$;if(Ze.value=Pt,!Dt&&k.isLastChild&&k.key===$.key&&(q="after"),q==="after"){let Lt=Ct-n.clientX,ct=0;for(;Lt>=Z/2&&$.parent!==null&&$.isLastChild&&ct<1;)Lt-=Z,ct+=1,$=$.parent;et.value=ct}else et.value=0;if((k.contains($)||q==="inside"&&((C=k.parent)===null||C===void 0?void 0:C.key)===$.key)&&!(k.key===Pt.key&&k.key===$.key)){Re();return}if(!U({node:$.rawNode,dropPosition:q,phase:"drag"})){Re();return}if(k.key===$.key)Pe();else if(xe!==$.key)if(q==="inside"){if(e.expandOnDragenter){if(mn($),!$.shallowLoaded&&xe!==$.key){je();return}}else if(!$.shallowLoaded){je();return}}else Pe();else q!=="inside"&&Pe();Qe.value=q,Je.value=$}function Nn({event:n,node:d,dropPosition:v}){if(!e.draggable||e.disabled||we(d,e.disabledField))return;const{value:C}=Ue,{value:k}=Je,{value:U}=Qe;if(!(!C||!k||!U)&&e.allowDrop({node:k.rawNode,dropPosition:U,phase:"drag"})&&C.key!==k.key){if(U==="before"){const Z=C.getNext({includeDisabled:!0});if(Z&&Z.key===k.key){Re();return}}if(U==="after"){const Z=C.getPrev({includeDisabled:!0});if(Z&&Z.key===k.key){Re();return}}vn({event:n,node:k.rawNode,dragNode:C.rawNode,dropPosition:v}),je()}}function Sn(){tt()}function Rn(){tt()}function _n(n){var d;if(e.virtualScroll||e.internalScrollable){const{value:v}=l;if(!((d=v==null?void 0:v.containerRef)===null||d===void 0)&&d.contains(n.relatedTarget))return;ye.value=null}else{const{value:v}=u;if(v!=null&&v.contains(n.relatedTarget))return;ye.value=null}}We(ye,n=>{var d,v;if(n!==null){if(e.virtualScroll)(d=r.value)===null||d===void 0||d.scrollTo({key:n});else if(e.internalScrollable){const{value:C}=l;if(C===null)return;const k=(v=C.contentRef)===null||v===void 0?void 0:v.querySelector(`[data-key="${Yt(n)}"]`);if(!k)return;C.scrollTo({el:k})}}}),jt(Ge,{loadingKeysRef:J,highlightKeySetRef:z,displayedCheckedKeysRef:Y,displayedIndeterminateKeysRef:he,mergedSelectedKeysRef:ge,mergedExpandedKeysRef:oe,mergedThemeRef:o,mergedCheckStrategyRef:j,nodePropsRef:O(e,"nodeProps"),disabledRef:O(e,"disabled"),checkableRef:O(e,"checkable"),selectableRef:O(e,"selectable"),expandOnClickRef:O(e,"expandOnClick"),onLoadRef:O(e,"onLoad"),draggableRef:O(e,"draggable"),blockLineRef:O(e,"blockLine"),indentRef:O(e,"indent"),cascadeRef:O(e,"cascade"),checkOnClickRef:O(e,"checkOnClick"),checkboxPlacementRef:e.checkboxPlacement,droppingMouseNodeRef:Ze,droppingNodeParentRef:rn,draggingNodeRef:Ue,droppingPositionRef:Qe,droppingOffsetLevelRef:et,fNodesRef:me,pendingNodeKeyRef:ye,showLineRef:O(e,"showLine"),disabledFieldRef:O(e,"disabledField"),internalScrollableRef:O(e,"internalScrollable"),internalCheckboxFocusableRef:O(e,"internalCheckboxFocusable"),internalTreeSelect:e.internalTreeSelect,renderLabelRef:O(e,"renderLabel"),renderPrefixRef:O(e,"renderPrefix"),renderSuffixRef:O(e,"renderSuffix"),renderSwitcherIconRef:O(e,"renderSwitcherIcon"),labelFieldRef:O(e,"labelField"),multipleRef:O(e,"multiple"),handleSwitcherClick:_t,handleDragEnd:wn,handleDragEnter:yn,handleDragLeave:xn,handleDragStart:Cn,handleDrop:Nn,handleDragOver:Kt,handleSelect:st,handleCheck:Rt});function Kn(n){var d;(d=r.value)===null||d===void 0||d.scrollTo(n)}const Tn={handleKeydown:lt,scrollTo:Kn,getCheckedData:()=>{if(!e.checkable)return{keys:[],options:[]};const{checkedKeys:n}=E.value;return{keys:n,options:Q(n)}},getIndeterminateData:()=>{if(!e.checkable)return{keys:[],options:[]};const{indeterminateKeys:n}=E.value;return{keys:n,options:Q(n)}}},Tt=A(()=>{const{common:{cubicBezierEaseInOut:n},self:{fontSize:d,nodeBorderRadius:v,nodeColorHover:C,nodeColorPressed:k,nodeColorActive:U,arrowColor:Z,loadingColor:ee,nodeTextColor:$e,nodeTextColorDisabled:Ee,dropMarkColor:re,nodeWrapperPadding:I,nodeHeight:le,lineHeight:ce}}=o.value,$=ht(I,"top"),q=ht(I,"bottom"),He=Wt(Ve(le)-Ve($)-Ve(q));return{"--n-arrow-color":Z,"--n-loading-color":ee,"--n-bezier":n,"--n-font-size":d,"--n-node-border-radius":v,"--n-node-color-active":U,"--n-node-color-hover":C,"--n-node-color-pressed":k,"--n-node-text-color":$e,"--n-node-text-color-disabled":Ee,"--n-drop-mark-color":re,"--n-node-wrapper-padding":I,"--n-line-offset-top":`-${$}`,"--n-line-offset-bottom":`-${q}`,"--n-node-content-height":He,"--n-line-height":ce}}),Le=c?kt("tree",void 0,Tt,e):void 0;return Object.assign(Object.assign({},Tn),{mergedClsPrefix:t,mergedTheme:o,rtlEnabled:i,fNodes:an,aip:Te,selfElRef:u,virtualListInstRef:r,scrollbarInstRef:l,handleFocusout:_n,handleDragLeaveTree:kn,handleScroll:Sn,getScrollContainer:a,getScrollContent:f,handleAfterEnter:dn,handleResize:Rn,cssVars:c?void 0:Tt,themeClass:Le==null?void 0:Le.themeClass,onRender:Le==null?void 0:Le.onRender})},render(){var e;const{fNodes:t,internalRenderEmpty:c}=this;if(!t.length&&c)return c();const{mergedClsPrefix:s,blockNode:i,blockLine:o,draggable:u,disabled:l,internalFocusable:r,checkable:a,handleKeydown:f,rtlEnabled:h,handleFocusout:g,scrollbarProps:p}=this,S=r&&!l,_=S?"0":void 0,N=[`${s}-tree`,h&&`${s}-tree--rtl`,a&&`${s}-tree--checkable`,(o||i)&&`${s}-tree--block-node`,o&&`${s}-tree--block-line`],x=T=>"__motion"in T?m(or,{height:T.height,nodes:T.nodes,clsPrefix:s,mode:T.mode,onAfterEnter:this.handleAfterEnter}):m(nn,{key:T.key,tmNode:T,clsPrefix:s});if(this.virtualScroll){const{mergedTheme:T,internalScrollablePadding:E}=this,j=ht(E||"0");return m(Ft,Object.assign({},p,{ref:"scrollbarInstRef",onDragleave:u?this.handleDragLeaveTree:void 0,container:this.getScrollContainer,content:this.getScrollContent,class:N,theme:T.peers.Scrollbar,themeOverrides:T.peerOverrides.Scrollbar,tabindex:_,onKeydown:S?f:void 0,onFocusout:S?g:void 0}),{default:()=>{var Y;return(Y=this.onRender)===null||Y===void 0||Y.call(this),m(fo,{ref:"virtualListInstRef",items:this.fNodes,itemSize:Ve(T.self.nodeHeight),ignoreItemResize:this.aip,paddingTop:j.top,paddingBottom:j.bottom,class:this.themeClass,style:[this.cssVars,{paddingLeft:j.left,paddingRight:j.right}],onScroll:this.handleScroll,onResize:this.handleResize,showScrollbar:!1,itemResizable:!0},{default:({item:he})=>x(he)})}})}const{internalScrollable:P}=this;return N.push(this.themeClass),(e=this.onRender)===null||e===void 0||e.call(this),P?m(Ft,Object.assign({},p,{class:N,tabindex:_,onKeydown:S?f:void 0,onFocusout:S?g:void 0,style:this.cssVars,contentStyle:{padding:this.internalScrollablePadding}}),{default:()=>m("div",{onDragleave:u?this.handleDragLeaveTree:void 0,ref:"selfElRef"},this.fNodes.map(x))}):m("div",{class:N,tabindex:_,ref:"selfElRef",style:this.cssVars,onKeydown:S?f:void 0,onFocusout:S?g:void 0,onDragleave:u?this.handleDragLeaveTree:void 0},t.length?t.map(x):eo(this.$slots.empty,()=>[m(vo,{class:`${s}-tree__empty`,theme:this.mergedTheme.peers.Empty,themeOverrides:this.mergedTheme.peerOverrides.Empty})]))}}),on=M({__name:"DraggableCard",props:{initialValue:{default:()=>({})}},setup(e){const t=e,c=t.initialValue.left!==void 0,s=t.initialValue.top!==void 0,i={x:(c?t.initialValue.left:t.initialValue.right)??0,y:(s?t.initialValue.top:t.initialValue.bottom)??0},o=qt({...i}),u=A(()=>{const x=c?`left:${o.x}px;`:`right:${o.x}px;`,P=s?`top:${o.y}px;`:`bottom:${o.y}px;`;return x+P});let l;const r=x=>{l=x,i.x=o.x,i.y=o.y},a=x=>{if(!g.value||!l)return;const P=x.clientX-l.clientX,T=x.clientY-l.clientY;o.x=i.x+(c?P:-P),o.y=i.y+(s?T:-T)},f=()=>{l=void 0},h=ie(),g=ie(),p=x=>{l&&x.preventDefault()},S=["transition-top,bottom,left,right-500"],_=()=>{if(!g.value)return;const{top:x,bottom:P,left:T,right:E}=g.value.getBoundingClientRect();if(E<0||T>window.innerWidth||P<0||x>window.innerHeight){o.x=i.x,o.y=i.y,f();const j=h.value;j&&(j.classList.add(...S),setTimeout(()=>{j.classList.remove(...S)},550))}};window.addEventListener("pointermove",a),window.addEventListener("pointerup",_),document.addEventListener("selectstart",p),At(()=>{window.removeEventListener("pointermove",a),window.removeEventListener("pointerup",_),document.removeEventListener("selectstart",p),f()}),We(g,(x,P)=>{x&&(x.addEventListener("pointerdown",r),x.addEventListener("pointerup",f)),P&&(P.removeEventListener("pointerdown",r),P.removeEventListener("pointerup",f))}),At(()=>{g.value&&(g.value.removeEventListener("pointerdown",r),g.value.removeEventListener("pointerup",f))});const N=x=>{x instanceof HTMLElement?g.value=x:g.value=void 0};return(x,P)=>(W(),ae(no,{to:"body"},[ne("div",{fixed:"",ref_key:"box",ref:h,style:Gt([x.$attrs.style,u.value]),class:to(x.$attrs.class)},[Xt(x.$slots,"default",{onRef:N})],6)]))}});const cr=["onClick"],ur=M({__name:"AttrCard",props:{focusNode:{}},setup(e){const t=e,c=["text","desc"],s=A(()=>Object.entries(t.focusNode.attr).map(([i,o])=>{const u={name:i,value:JSON.stringify(o)};return c.includes(i)?[u,{name:i+".length",value:JSON.stringify((o==null?void 0:o.length)??null)}]:u}).flat());return(i,o)=>(W(),ae(on,{initialValue:{top:75,right:10}},{default:w(({onRef:u})=>[R(b(Zt),{size:"small",striped:"",singleLine:!1,class:"gkd_code",themeOverrides:{thPaddingSmall:"2px 4px",tdPaddingSmall:"2px 4px"}},{default:w(()=>[ne("thead",{"cursor-move":"",ref:u},[R(b(Xe),null,{default:w(()=>[R(b(pe),null,{default:w(()=>[B(" Name ")]),_:1}),R(b(pe),null,{default:w(()=>[B(" Value ")]),_:1})]),_:1})],512),R(b(Qt),null,{default:w(()=>[(W(!0),Oe(mt,null,bt(s.value,l=>(W(),ae(b(Xe),{key:l.name},{default:w(()=>[R(b(fe),null,{default:w(()=>[ne("span",{onClick:r=>b(Fe)(`${l.name}=${l.value}`)},te(l.name),9,cr)]),_:2},1024),R(b(fe),null,{default:w(()=>[R(b(Ie),{style:{width:"250px"}},{default:w(()=>[B(te(l.value),1)]),_:2},1024)]),_:2},1024)]),_:2},1024))),128)),i.focusNode.quickFind!==void 0?(W(),ae(b(Xe),{key:0},{default:w(()=>[R(b(fe),null,{default:w(()=>[B(" quickFind ")]),_:1}),R(b(fe),null,{default:w(()=>[R(b(po),null,{trigger:w(()=>[ne("span",null,te(JSON.stringify(i.focusNode.quickFind)),1)]),default:w(()=>[B(" 此节点是否可使用 quickFind ")]),_:1})]),_:1})]),_:1})):Ae("",!0)]),_:1})]),_:2},1024)]),_:1}))}}),fr={flex:"","flex-col":"",relative:"","h-full":""},hr=["src"],gr=ne("div",{absolute:"","left-0":"","top-0":"","bottom-0":"","right-0":"","b-solid":"","b-1px":"","b-red":""},null,-1),vr=[gr],pr=M({__name:"ScreenshotCard",props:{url:{},snapshot:{},rootNode:{},focusNode:{},onUpdateFocusNode:{type:Function,default:()=>()=>{}}},setup(e){const t=e,c=ie(),s=ie();Ce(()=>{if(!t.rootNode)return;const u=s.value,l=c.value;if(!u||!l)return;const r=l.getBoundingClientRect(),a=r.width/l.naturalWidth*l.naturalHeight,f=(r.height-a)/2,h=(u.clientX-r.left)/r.width*l.naturalWidth,g=(u.clientY-r.top-f)/a*l.naturalHeight,p=bo(t.snapshot.nodes,h,g);p&&t.onUpdateFocusNode(p)});const i=u=>`${u*100}%`,o=A(()=>{var f;const u=c.value,l=(f=t.focusNode)==null?void 0:f.attr;if(!t.focusNode||!u||!l)return"";const r=u.getBoundingClientRect(),a=r.width/u.naturalWidth*u.naturalHeight;return{left:`calc(${i(l.left/u.naturalWidth)} - 2px)`,width:`calc(${i((l.right-l.left)/u.naturalWidth)} + 2px)`,top:`calc(${i((l.top/u.naturalHeight*a+(r.height-a)/2)/r.height)} - 2px)`,height:`calc(${i((l.bottom-l.top)/u.naturalHeight*a/r.height)} + 2px)`}});return(u,l)=>(W(),Oe("div",fr,[ne("img",{ref_key:"imgRef",ref:c,src:u.url,onClick:l[0]||(l[0]=r=>s.value=r),"cursor-crosshair":"","h-full":"","object-contain":"",style:{"max-width":"max(35vw, 400px)"}},null,8,hr),ne("div",{style:Gt(o.value),absolute:"","pointer-events-none":"","transition-all-300":"","b-1px":"","b-blue":"","b-solid":""},vr,4)]))}}),br={"w-500px":"","bg-white":"","b-1px":"","b-solid":"","b-gray-200":"","rounded-4px":"","p-8px":""},mr={flex:"","m-b-4px":""},yr=ne("div",{"p-5px":""},null,-1),xr={"break-all":""},kr=ne("div",{"p-l-8px":""},null,-1),wr=M({__name:"SearchCard",props:{rootNode:{},onUpdateFocusNode:{type:Function,default:()=>()=>{}}},setup(e){const t=e,c=ie(""),s=qt([]),i=wo(()=>{if(!t.rootNode){ue.error("根节点不存在");return}const u=c.value.trim();if(u)if(o.value){if(s.find(a=>typeof a.selector=="object"&&a.selector.toString()==u)){ue.warning("不可重复选择");return}const l=Co(()=>No(u),"选择器非法"),r=l.querySelectorAll(t.rootNode);if(r.length==0){ue.success("没有选择到节点");return}ue.success(`选择到 ${r.length} 个节点`),s.unshift({selector:l,results:r})}else{if(s.find(a=>typeof a.selector=="string"&&a.selector.toString()==u)){ue.warning("不可重复选择");return}const l=[],r=[t.rootNode];for(;r.length>0;){const a=r.pop();yt(a).includes(u)&&l.push(a),r.push(...[...a.children].reverse())}if(l.length==0){ue.success("没有搜索到节点");return}ue.success(`搜索到 ${l.length} 个节点`),s.unshift({selector:u,results:l})}}),o=ie(!0);return(u,l)=>(W(),ae(on,{initialValue:{top:75,right:390},class:"z-1"},{default:w(({onRef:r})=>[ne("div",br,[ne("div",mr,[R(b(mo),{value:o.value,"onUpdate:value":l[0]||(l[0]=a=>o.value=a)},{default:w(()=>[R(b(zt),null,{default:w(()=>[R(b(Bt),{value:!1},{default:w(()=>[B(" 字符搜索 ")]),_:1}),R(b(Bt),{value:!0},{default:w(()=>[B(" 选择器查询 ")]),_:1})]),_:1})]),_:1},8,["value"]),ne("div",{"flex-1":"","cursor-move":"",ref:r},null,512)]),R(b(xo),null,{default:w(()=>[R(b(yo),{value:c.value,"onUpdate:value":l[1]||(l[1]=a=>c.value=a),placeholder:o.value?"请输入选择器":"请输入字符",onKeyup:oo(b(i),["enter"]),inputProps:{class:"gkd_code"}},null,8,["value","placeholder","onKeyup"]),R(b(gt),{onClick:b(i)},{default:w(()=>[B(te(o.value?"查询":"搜索"),1)]),_:1},8,["onClick"])]),_:1}),yr,R(b(Eo),null,{default:w(()=>[(W(!0),Oe(mt,null,bt(b(s),(a,f)=>(W(),ae(b(Io),{key:a.selector.toString()},{header:w(()=>[ne("span",xr,te((typeof a.selector=="string"?"字符搜索":"选择器查询")+"："+a.selector.toString()),1)]),"header-extra":w(()=>[B(te(a.results.length+"个节点")+" ",1),kr,R(b(gt),{onClick:ro(h=>b(s).splice(f,1),["stop"])},{default:w(()=>[B(" 删除 ")]),_:2},1032,["onClick"])]),default:w(()=>[R(b(zt),{style:{"max-height":"400px","overflow-y":"scroll","padding-bottom":"10px"}},{default:w(()=>[(W(!0),Oe(mt,null,bt(a.results,h=>(W(),ae(b(gt),{key:h.id,onClick:g=>u.onUpdateFocusNode(h),size:"small"},{default:w(()=>[B(te(b(yt)(h)),1)]),_:2},1032,["onClick"]))),128))]),_:2},1024)]),_:2},1024))),128))]),_:1})])]),_:1}))}}),Cr={flex:"","flex-col":""},Nr=M({__name:"WindowCard",props:{snapshot:{},rootNode:{},focusNode:{},onUpdateFocusNode:{type:Function,default:()=>()=>{}}},setup(e){const t=e,c=ie([]);Ce(async()=>{var h;if(!t.focusNode)return;const r=t.focusNode.id;let a=t.focusNode.parent;if(!a)return;const f=new Set(c.value);for(;a;)f.add(a.id),a=a.parent;f.size!=c.value.length&&(c.value=[...f],await nt(),(h=s.value)==null||h.scrollTo({key:r}))});const s=ie(),i=(r,a,f)=>{},o=(r,a)=>{var f;return a.id===((f=t.focusNode)==null?void 0:f.id)},u=r=>{var a;return{onClick:()=>{t.onUpdateFocusNode(r.option)},style:{color:r.option.id==((a=t.focusNode)==null?void 0:a.id)?"#00F":void 0}}},l=r=>yt(r.option);return(r,a)=>(W(),Oe("div",Cr,[R(b(Zt),{size:"small",striped:"",singleLine:!1,class:"table-fixed",themeOverrides:{thPaddingSmall:"2px 4px",tdPaddingSmall:"2px 4px"}},{default:w(()=>[R(b(qo),null,{default:w(()=>[R(b(Xe),null,{default:w(()=>[R(b(pe),{class:"w-140px"},{default:w(()=>[B(" Device ")]),_:1}),R(b(pe),{class:"w-100px"},{default:w(()=>[B(" Name ")]),_:1}),R(b(pe),{class:"w-100px"},{default:w(()=>[B(" VersionName ")]),_:1}),R(b(pe),{class:"w-100px"},{default:w(()=>[B(" VersionCode ")]),_:1}),R(b(pe),{class:"w-200px"},{default:w(()=>[B(" AppId ")]),_:1}),R(b(pe),null,{default:w(()=>[B(" ActivityId ")]),_:1}),R(b(pe),{class:"w-175px"},{default:w(()=>[B(" 操作 ")]),_:1})]),_:1})]),_:1}),R(b(Qt),null,{default:w(()=>[R(b(Xe),null,{default:w(()=>[R(b(fe),{class:"whitespace-nowrap"},{default:w(()=>[B(te(`${b(Ut)(r.snapshot).manufacturer} Android ${b(Ut)(r.snapshot).release||""}`),1)]),_:1}),R(b(fe),{class:"whitespace-nowrap",onClick:a[0]||(a[0]=f=>b(Fe)(r.snapshot.appName))},{default:w(()=>[R(b(Ie),null,{default:w(()=>[B(te(r.snapshot.appName),1)]),_:1})]),_:1}),R(b(fe),{class:"whitespace-nowrap",onClick:a[1]||(a[1]=f=>b(Fe)(r.snapshot.appVersionName))},{default:w(()=>[R(b(Ie),null,{default:w(()=>[B(te(r.snapshot.appVersionName),1)]),_:1})]),_:1}),R(b(fe),{class:"whitespace-nowrap",onClick:a[2]||(a[2]=f=>b(Fe)(r.snapshot.appVersionCode.toString()))},{default:w(()=>[R(b(Ie),null,{default:w(()=>[B(te(r.snapshot.appVersionCode),1)]),_:1})]),_:1}),R(b(fe),{class:"whitespace-nowrap",onClick:a[3]||(a[3]=f=>b(Fe)(r.snapshot.appId))},{default:w(()=>[R(b(Ie),null,{default:w(()=>[B(te(r.snapshot.appId),1)]),_:1})]),_:1}),R(b(fe),{onClick:a[4]||(a[4]=f=>b(Fe)(r.snapshot.activityId)),class:"break-words"},{default:w(()=>[R(b(Ie),null,{default:w(()=>[B(te(r.snapshot.activityId),1)]),_:1})]),_:1}),R(b(fe),null,{default:w(()=>[Xt(r.$slots,"default",{},void 0,!0)]),_:3})]),_:3})]),_:3})]),_:3}),R(b(sr),{ref_key:"treeRef",ref:s,virtualScroll:"",showLine:"","onUpdate:checkedKeys":i,keyField:"id",defaultExpandedKeys:c.value,data:[r.rootNode],filter:o,nodeProps:u,renderLabel:l,style:{"--n-border-color":"rgb(239, 239, 245)"}},null,8,["defaultExpandedKeys","data","filter","nodeProps","renderLabel"])]))}});const Sr=Ro(Nr,[["__scopeId","data-v-e4f55958"]]),Rr={"h-full":"",flex:"","gap-5px":"","p-5px":"","box-border":""},Er=M({__name:"SnapshotPage",setup(e){const t=lo(),c=ao(),s=So(),i=A(()=>String(t.params.snapshotId||"")),o=A(()=>{const h=Number(t.query.showSize||"");return!Number.isSafeInteger(h)||h<=0?2e3:h}),u=ie(""),l=ie();Ce(async()=>{const h=await $t.getItem(i.value);if(!h){ue.error("快照数据缺失");return}$n()&&setTimeout(async()=>{Pn(h),En[h.id]||Ln(await $t.getItem(i.value))},1e3),h.nodes.length>o.value&&(ue.warning(`当前展示节点数量为${o.value}
之后的${h.nodes.length-o.value}个节点将被丢弃
使用showSize查询参数可以修改展示数量`),h.nodes=h.nodes.slice(0,o.value));const g=await Fn.getItem(i.value);if(!g){ue.create("截屏数据缺失");return}u.value=URL.createObjectURL(new Blob([g])),l.value=h,r.value=ko(h.nodes),s.value="快照-"+h.appName||h.appId});const r=ie(),a=ie(),f=async()=>{ue.success("删除成功,即将回到首页"),await An(2e3),c.replace({path:"/"})};return(h,g)=>(W(),Oe("div",Rr,[u.value&&l.value?(W(),ae(pr,{key:0,url:u.value,snapshot:l.value,rootNode:r.value,focusNode:a.value,onUpdateFocusNode:g[0]||(g[0]=p=>a.value=p)},null,8,["url","snapshot","rootNode","focusNode"])):Ae("",!0),l.value&&r.value?(W(),ae(Sr,{key:1,rootNode:r.value,snapshot:l.value,focusNode:a.value,onUpdateFocusNode:g[1]||(g[1]=p=>a.value=p),class:"flex-1"},{default:w(()=>[l.value?(W(),ae(Dn,{key:0,snapshot:l.value,onDelete:f,showPreview:!1},null,8,["snapshot"])):Ae("",!0)]),_:1},8,["rootNode","snapshot","focusNode"])):Ae("",!0),a.value?(W(),ae(ur,{key:2,focusNode:a.value},null,8,["focusNode"])):Ae("",!0),r.value?(W(),ae(wr,{key:3,rootNode:r.value,onUpdateFocusNode:g[2]||(g[2]=p=>a.value=p)},null,8,["rootNode"])):Ae("",!0)]))}});export{Er as default};
//# sourceMappingURL=SnapshotPage-45512b44.js.map
