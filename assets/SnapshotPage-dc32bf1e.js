import{_ as In,e as Bn,f as On}from"./ActionCard.vue_vue_type_script_setup_true_lang-f4d28c47.js";import{f as bt,c as Ke,m as ue,b as Mn,g as zt,e as Xt,a as Ft,h as Un,i as Hn,j as At}from"./storage-25ae3853.js";import{d as H,n as y,p as wt,q as K,v as F,x as X,y as $,z as rt,A as W,c as A,B as Be,C as Gt,D as at,E as Ct,G as Nt,H as q,I as jn,J as B,K as Jt,L as Qt,M as Zt,O as Vn,P as G,Q as Te,S as Wn,T as It,U as en,V as qn,W as ve,X as Yn,Y as Xn,Z as Gn,_ as Le,$ as Jn,a0 as Qn,a1 as ht,a2 as Zn,a3 as eo,a4 as gt,a5 as to,a6 as no,a7 as oo,a8 as tn,a9 as lo,w as Ce,e as We,aa as vt,ab as Ve,ac as Bt,ad as ro,ae as nt,a as nn,s as Z,af as Ot,ag as ne,h as T,ah as on,ai as mt,aj as ao,ak as io,o as M,g as N,b as _,u as b,f as fe,al as yt,F as lt,l as Q,m as Ne,k as V,i as so,j as tt,am as Mt,an as co,ao as uo}from"./index-9a74ec84.js";import{e as qe,C as fo,f as ho,g as go,h as vo,i as Ut,V as po,j as bo,k as Ht,l as mo,m as yo,n as xo,d as ot,o as De,p as ko,c as jt,q as Vt,r as wo,N as Co,a as No,s as xt,t as So,v as Wt,w as Ro}from"./node-7c87a44a.js";import{e as qt,a as _o,p as $o,l as Lo,u as Ko}from"./index-af9eb709.js";import"./jszip.min-14bc980b.js";function ln(e){return typeof e=="string"?`s-${e}`:`n-${e}`}const Do=H({name:"ChevronLeft",render(){return y("svg",{viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg"},y("path",{d:"M10.3536 3.14645C10.5488 3.34171 10.5488 3.65829 10.3536 3.85355L6.20711 8L10.3536 12.1464C10.5488 12.3417 10.5488 12.6583 10.3536 12.8536C10.1583 13.0488 9.84171 13.0488 9.64645 12.8536L5.14645 8.35355C4.95118 8.15829 4.95118 7.84171 5.14645 7.64645L9.64645 3.14645C9.84171 2.95118 10.1583 2.95118 10.3536 3.14645Z",fill:"currentColor"}))}}),To=H({name:"Switcher",render(){return y("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 32"},y("path",{d:"M12 8l10 8l-10 8z"}))}}),Po=e=>{const{fontWeight:t,textColor1:c,textColor2:u,textColorDisabled:s,dividerColor:r,fontSize:g}=e;return{titleFontSize:g,titleFontWeight:t,dividerColor:r,titleTextColor:c,titleTextColorDisabled:s,fontSize:g,textColor:u,arrowColor:u,arrowColorDisabled:s,itemMargin:"16px 0 0 0",titlePadding:"16px 0 0 0"}},Eo={name:"Collapse",common:wt,self:Po},zo=Eo,Fo=K("collapse","width: 100%;",[K("collapse-item",`
 font-size: var(--n-font-size);
 color: var(--n-text-color);
 transition:
 color .3s var(--n-bezier),
 border-color .3s var(--n-bezier);
 margin: var(--n-item-margin);
 `,[F("disabled",[X("header","cursor: not-allowed;",[X("header-main",`
 color: var(--n-title-text-color-disabled);
 `),K("collapse-item-arrow",`
 color: var(--n-arrow-color-disabled);
 `)])]),K("collapse-item","margin-left: 32px;"),$("&:first-child","margin-top: 0;"),$("&:first-child >",[X("header","padding-top: 0;")]),F("left-arrow-placement",[X("header",[K("collapse-item-arrow","margin-right: 4px;")])]),F("right-arrow-placement",[X("header",[K("collapse-item-arrow","margin-left: 4px;")])]),X("content-wrapper",[X("content-inner","padding-top: 16px;"),bt({duration:"0.15s"})]),F("active",[X("header",[F("active",[K("collapse-item-arrow","transform: rotate(90deg);")])])]),$("&:not(:first-child)","border-top: 1px solid var(--n-divider-color);"),X("header",`
 font-size: var(--n-title-font-size);
 display: flex;
 flex-wrap: nowrap;
 align-items: center;
 transition: color .3s var(--n-bezier);
 position: relative;
 padding: var(--n-title-padding);
 color: var(--n-title-text-color);
 cursor: pointer;
 `,[X("header-main",`
 display: flex;
 flex-wrap: nowrap;
 align-items: center;
 font-weight: var(--n-title-font-weight);
 transition: color .3s var(--n-bezier);
 flex: 1;
 color: var(--n-title-text-color);
 `),X("header-extra",`
 display: flex;
 align-items: center;
 transition: color .3s var(--n-bezier);
 color: var(--n-text-color);
 `),K("collapse-item-arrow",`
 display: flex;
 transition:
 transform .15s var(--n-bezier),
 color .3s var(--n-bezier);
 font-size: 18px;
 color: var(--n-arrow-color);
 `)])])]),Ao=Object.assign(Object.assign({},Be.props),{defaultExpandedNames:{type:[Array,String],default:null},expandedNames:[Array,String],arrowPlacement:{type:String,default:"left"},accordion:{type:Boolean,default:!1},displayDirective:{type:String,default:"if"},onItemHeaderClick:[Function,Array],"onUpdate:expandedNames":[Function,Array],onUpdateExpandedNames:[Function,Array],onExpandedNamesChange:{type:[Function,Array],validator:()=>!0,default:void 0}}),rn=Nt("n-collapse"),Io=H({name:"Collapse",props:Ao,setup(e,{slots:t}){const{mergedClsPrefixRef:c,inlineThemeDisabled:u,mergedRtlRef:s}=rt(e),r=W(e.defaultExpandedNames),g=A(()=>e.expandedNames),h=qe(g,r),l=Be("Collapse","-collapse",Fo,zo,e,c);function i(R){const{"onUpdate:expandedNames":k,onUpdateExpandedNames:m,onExpandedNamesChange:D}=e;m&&q(m,R),k&&q(k,R),D&&q(D,R),r.value=R}function a(R){const{onItemHeaderClick:k}=e;k&&q(k,R)}function o(R,k,m){const{accordion:D}=e,{value:L}=h;if(D)R?(i([k]),a({name:k,expanded:!0,event:m})):(i([]),a({name:k,expanded:!1,event:m}));else if(!Array.isArray(L))i([k]),a({name:k,expanded:!0,event:m});else{const z=L.slice(),j=z.findIndex(J=>k===J);~j?(z.splice(j,1),i(z),a({name:k,expanded:!1,event:m})):(z.push(k),i(z),a({name:k,expanded:!0,event:m}))}}Gt(rn,{props:e,mergedClsPrefixRef:c,expandedNamesRef:h,slots:t,toggleItem:o});const f=at("Collapse",s,c),v=A(()=>{const{common:{cubicBezierEaseInOut:R},self:{titleFontWeight:k,dividerColor:m,titlePadding:D,titleTextColor:L,titleTextColorDisabled:z,textColor:j,arrowColor:J,fontSize:he,titleFontSize:de,arrowColorDisabled:be,itemMargin:ge}}=l.value;return{"--n-font-size":he,"--n-bezier":R,"--n-text-color":j,"--n-divider-color":m,"--n-title-padding":D,"--n-title-font-size":de,"--n-title-text-color":L,"--n-title-text-color-disabled":z,"--n-title-font-weight":k,"--n-arrow-color":J,"--n-arrow-color-disabled":be,"--n-item-margin":ge}}),C=u?Ct("collapse",void 0,v,e):void 0;return{rtlEnabled:f,mergedTheme:l,mergedClsPrefix:c,cssVars:u?void 0:v,themeClass:C==null?void 0:C.themeClass,onRender:C==null?void 0:C.onRender}},render(){var e;return(e=this.onRender)===null||e===void 0||e.call(this),y("div",{class:[`${this.mergedClsPrefix}-collapse`,this.rtlEnabled&&`${this.mergedClsPrefix}-collapse--rtl`,this.themeClass],style:this.cssVars},this.$slots)}}),Bo=H({name:"CollapseItemContent",props:{displayDirective:{type:String,required:!0},show:Boolean,clsPrefix:{type:String,required:!0}},setup(e){return{onceTrue:jn(B(e,"show"))}},render(){return y(Zt,null,{default:()=>{const{show:e,displayDirective:t,onceTrue:c,clsPrefix:u}=this,s=t==="show"&&c,r=y("div",{class:`${u}-collapse-item__content-wrapper`},y("div",{class:`${u}-collapse-item__content-inner`},this.$slots));return s?Jt(r,[[Qt,e]]):e?r:null}})}}),Oo={title:String,name:[String,Number],disabled:Boolean,displayDirective:String},Mo=H({name:"CollapseItem",props:Oo,setup(e){const{mergedRtlRef:t}=rt(e),c=Vn(),u=G(()=>{var o;return(o=e.name)!==null&&o!==void 0?o:c}),s=Te(rn);s||Wn("collapse-item","`n-collapse-item` must be placed inside `n-collapse`.");const{expandedNamesRef:r,props:g,mergedClsPrefixRef:h,slots:l}=s,i=A(()=>{const{value:o}=r;if(Array.isArray(o)){const{value:f}=u;return!~o.findIndex(v=>v===f)}else if(o){const{value:f}=u;return f!==o}return!0});return{rtlEnabled:at("Collapse",t,h),collapseSlots:l,randomName:c,mergedClsPrefix:h,collapsed:i,mergedDisplayDirective:A(()=>{const{displayDirective:o}=e;return o||g.displayDirective}),arrowPlacement:A(()=>g.arrowPlacement),handleClick(o){s&&!e.disabled&&s.toggleItem(i.value,u.value,o)}}},render(){const{collapseSlots:e,$slots:t,arrowPlacement:c,collapsed:u,mergedDisplayDirective:s,mergedClsPrefix:r,disabled:g}=this,h=It(t.header,{collapsed:u},()=>[this.title]),l=t["header-extra"]||e["header-extra"],i=t.arrow||e.arrow;return y("div",{class:[`${r}-collapse-item`,`${r}-collapse-item--${c}-arrow-placement`,g&&`${r}-collapse-item--disabled`,!u&&`${r}-collapse-item--active`]},y("div",{class:[`${r}-collapse-item__header`,!u&&`${r}-collapse-item__header--active`]},y("div",{class:`${r}-collapse-item__header-main`,onClick:this.handleClick},c==="right"&&h,y("div",{class:`${r}-collapse-item-arrow`,key:this.rtlEnabled?0:1},It(i,{collapsed:u},()=>{var a;return[y(en,{clsPrefix:r},{default:(a=e.expandIcon)!==null&&a!==void 0?a:()=>this.rtlEnabled?y(Do,null):y(fo,null)})]})),c==="left"&&h),qn(l,{collapsed:u},a=>y("div",{class:`${r}-collapse-item__header-extra`,onClick:this.handleClick},a))),y(Bo,{clsPrefix:r,displayDirective:s,show:!u},t))}}),Uo={thPaddingSmall:"6px",thPaddingMedium:"12px",thPaddingLarge:"12px",tdPaddingSmall:"6px",tdPaddingMedium:"12px",tdPaddingLarge:"12px"},Ho=e=>{const{dividerColor:t,cardColor:c,modalColor:u,popoverColor:s,tableHeaderColor:r,tableColorStriped:g,textColor1:h,textColor2:l,borderRadius:i,fontWeightStrong:a,lineHeight:o,fontSizeSmall:f,fontSizeMedium:v,fontSizeLarge:C}=e;return Object.assign(Object.assign({},Uo),{fontSizeSmall:f,fontSizeMedium:v,fontSizeLarge:C,lineHeight:o,borderRadius:i,borderColor:ve(c,t),borderColorModal:ve(u,t),borderColorPopover:ve(s,t),tdColor:c,tdColorModal:u,tdColorPopover:s,tdColorStriped:ve(c,g),tdColorStripedModal:ve(u,g),tdColorStripedPopover:ve(s,g),thColor:ve(c,r),thColorModal:ve(u,r),thColorPopover:ve(s,r),thTextColor:h,tdTextColor:l,thFontWeight:a})},jo={name:"Table",common:wt,self:Ho},Vo=jo,Wo=e=>{const{borderRadiusSmall:t,hoverColor:c,pressedColor:u,primaryColor:s,textColor3:r,textColor2:g,textColorDisabled:h,fontSize:l}=e;return{fontSize:l,lineHeight:"1.5",nodeHeight:"30px",nodeWrapperPadding:"3px 0",nodeBorderRadius:t,nodeColorHover:c,nodeColorPressed:u,nodeColorActive:Gn(s,{alpha:.1}),arrowColor:r,nodeTextColor:g,nodeTextColorDisabled:h,loadingColor:s,dropMarkColor:s}},qo=Yn({name:"Tree",common:wt,peers:{Checkbox:ho,Scrollbar:Xn,Empty:go},self:Wo}),Yo=qo,Xo=$([K("table",`
 font-size: var(--n-font-size);
 font-variant-numeric: tabular-nums;
 line-height: var(--n-line-height);
 width: 100%;
 border-radius: var(--n-border-radius) var(--n-border-radius) 0 0;
 text-align: left;
 border-collapse: separate;
 border-spacing: 0;
 overflow: hidden;
 background-color: var(--n-td-color);
 border-color: var(--n-merged-border-color);
 transition:
 background-color .3s var(--n-bezier),
 border-color .3s var(--n-bezier),
 color .3s var(--n-bezier);
 --n-merged-border-color: var(--n-border-color);
 `,[$("th",`
 white-space: nowrap;
 transition:
 background-color .3s var(--n-bezier),
 border-color .3s var(--n-bezier),
 color .3s var(--n-bezier);
 text-align: inherit;
 padding: var(--n-th-padding);
 vertical-align: inherit;
 text-transform: none;
 border: 0px solid var(--n-merged-border-color);
 font-weight: var(--n-th-font-weight);
 color: var(--n-th-text-color);
 background-color: var(--n-th-color);
 border-bottom: 1px solid var(--n-merged-border-color);
 border-right: 1px solid var(--n-merged-border-color);
 `,[$("&:last-child",`
 border-right: 0px solid var(--n-merged-border-color);
 `)]),$("td",`
 transition:
 background-color .3s var(--n-bezier),
 border-color .3s var(--n-bezier),
 color .3s var(--n-bezier);
 padding: var(--n-td-padding);
 color: var(--n-td-text-color);
 background-color: var(--n-td-color);
 border: 0px solid var(--n-merged-border-color);
 border-right: 1px solid var(--n-merged-border-color);
 border-bottom: 1px solid var(--n-merged-border-color);
 `,[$("&:last-child",`
 border-right: 0px solid var(--n-merged-border-color);
 `)]),F("bordered",`
 border: 1px solid var(--n-merged-border-color);
 border-radius: var(--n-border-radius);
 `,[$("tr",[$("&:last-child",[$("td",`
 border-bottom: 0 solid var(--n-merged-border-color);
 `)])])]),F("single-line",[$("th",`
 border-right: 0px solid var(--n-merged-border-color);
 `),$("td",`
 border-right: 0px solid var(--n-merged-border-color);
 `)]),F("single-column",[$("tr",[$("&:not(:last-child)",[$("td",`
 border-bottom: 0px solid var(--n-merged-border-color);
 `)])])]),F("striped",[$("tr:nth-of-type(even)",[$("td","background-color: var(--n-td-color-striped)")])]),Le("bottom-bordered",[$("tr",[$("&:last-child",[$("td",`
 border-bottom: 0px solid var(--n-merged-border-color);
 `)])])])]),Jn(K("table",`
 background-color: var(--n-td-color-modal);
 --n-merged-border-color: var(--n-border-color-modal);
 `,[$("th",`
 background-color: var(--n-th-color-modal);
 `),$("td",`
 background-color: var(--n-td-color-modal);
 `)])),Qn(K("table",`
 background-color: var(--n-td-color-popover);
 --n-merged-border-color: var(--n-border-color-popover);
 `,[$("th",`
 background-color: var(--n-th-color-popover);
 `),$("td",`
 background-color: var(--n-td-color-popover);
 `)]))]),Go=Object.assign(Object.assign({},Be.props),{bordered:{type:Boolean,default:!0},bottomBordered:{type:Boolean,default:!0},singleLine:{type:Boolean,default:!0},striped:Boolean,singleColumn:Boolean,size:{type:String,default:"medium"}}),an=H({name:"Table",props:Go,setup(e){const{mergedClsPrefixRef:t,inlineThemeDisabled:c,mergedRtlRef:u}=rt(e),s=Be("Table","-table",Xo,Vo,e,t),r=at("Table",u,t),g=A(()=>{const{size:l}=e,{self:{borderColor:i,tdColor:a,tdColorModal:o,tdColorPopover:f,thColor:v,thColorModal:C,thColorPopover:R,thTextColor:k,tdTextColor:m,borderRadius:D,thFontWeight:L,lineHeight:z,borderColorModal:j,borderColorPopover:J,tdColorStriped:he,tdColorStripedModal:de,tdColorStripedPopover:be,[ht("fontSize",l)]:ge,[ht("tdPadding",l)]:Se,[ht("thPadding",l)]:Re},common:{cubicBezierEaseInOut:Oe}}=s.value;return{"--n-bezier":Oe,"--n-td-color":a,"--n-td-color-modal":o,"--n-td-color-popover":f,"--n-td-text-color":m,"--n-border-color":i,"--n-border-color-modal":j,"--n-border-color-popover":J,"--n-border-radius":D,"--n-font-size":ge,"--n-th-color":v,"--n-th-color-modal":C,"--n-th-color-popover":R,"--n-th-font-weight":L,"--n-th-text-color":k,"--n-line-height":z,"--n-td-padding":Se,"--n-th-padding":Re,"--n-td-color-striped":he,"--n-td-color-striped-modal":de,"--n-td-color-striped-popover":be}}),h=c?Ct("table",A(()=>e.size[0]),g,e):void 0;return{rtlEnabled:r,mergedClsPrefix:t,cssVars:c?void 0:g,themeClass:h==null?void 0:h.themeClass,onRender:h==null?void 0:h.onRender}},render(){var e;const{mergedClsPrefix:t}=this;return(e=this.onRender)===null||e===void 0||e.call(this),y("table",{class:[`${t}-table`,this.themeClass,{[`${t}-table--rtl`]:this.rtlEnabled,[`${t}-table--bottom-bordered`]:this.bottomBordered,[`${t}-table--bordered`]:this.bordered,[`${t}-table--single-line`]:this.singleLine,[`${t}-table--single-column`]:this.singleColumn,[`${t}-table--striped`]:this.striped}],style:this.cssVars},this.$slots)}}),$e=H({name:"Th",render(){return y("th",null,this.$slots)}}),kt=H({name:"Tr",render(){return y("tr",null,this.$slots)}}),pe=H({name:"Td",render(){return y("td",null,this.$slots)}}),Jo=H({name:"Thead",render(){return y("thead",null,this.$slots)}}),dn=H({name:"Tbody",render(){return y("tbody",null,this.$slots)}}),sn=Nt("n-tree-select"),Ye=Nt("n-tree"),Qo=H({name:"NTreeSwitcher",props:{clsPrefix:{type:String,required:!0},indent:{type:Number,required:!0},expanded:Boolean,selected:Boolean,hide:Boolean,loading:Boolean,onClick:Function,tmNode:{type:Object,required:!0}},setup(e){const{renderSwitcherIconRef:t}=Te(Ye,null);return()=>{const{clsPrefix:c,expanded:u,hide:s,indent:r,onClick:g}=e;return y("span",{"data-switcher":!0,class:[`${c}-tree-node-switcher`,u&&`${c}-tree-node-switcher--expanded`,s&&`${c}-tree-node-switcher--hide`],style:{width:`${r}px`},onClick:g},y("div",{class:`${c}-tree-node-switcher__icon`},y(Zn,null,{default:()=>{if(e.loading)return y(eo,{clsPrefix:c,key:"loading",radius:85,strokeWidth:20});const{value:h}=t;return h?h({expanded:e.expanded,selected:e.selected,option:e.tmNode.rawNode}):y(en,{clsPrefix:c,key:"switcher"},{default:()=>y(To,null)})}})))}}}),Zo=H({name:"NTreeNodeCheckbox",props:{clsPrefix:{type:String,required:!0},indent:{type:Number,required:!0},right:Boolean,focusable:Boolean,disabled:Boolean,checked:Boolean,indeterminate:Boolean,onCheck:Function},setup(e){const t=Te(Ye);function c(s){const{onCheck:r}=e;r&&r(s)}function u(s){c(s)}return{handleUpdateValue:u,mergedTheme:t.mergedThemeRef}},render(){const{clsPrefix:e,mergedTheme:t,checked:c,indeterminate:u,disabled:s,focusable:r,indent:g,handleUpdateValue:h}=this;return y("span",{class:[`${e}-tree-node-checkbox`,this.right&&`${e}-tree-node-checkbox--right`],style:{width:`${g}px`},"data-checkbox":!0},y(vo,{focusable:r,disabled:s,theme:t.peers.Checkbox,themeOverrides:t.peerOverrides.Checkbox,checked:c,indeterminate:u,onUpdateChecked:h}))}}),el=H({name:"TreeNodeContent",props:{clsPrefix:{type:String,required:!0},disabled:Boolean,checked:Boolean,selected:Boolean,onClick:Function,onDragstart:Function,tmNode:{type:Object,required:!0},nodeProps:Object},setup(e){const{renderLabelRef:t,renderPrefixRef:c,renderSuffixRef:u,labelFieldRef:s}=Te(Ye),r=W(null);function g(l){const{onClick:i}=e;i&&i(l)}function h(l){g(l)}return{selfRef:r,renderLabel:t,renderPrefix:c,renderSuffix:u,labelField:s,handleClick:h}},render(){const{clsPrefix:e,labelField:t,nodeProps:c,checked:u=!1,selected:s=!1,renderLabel:r,renderPrefix:g,renderSuffix:h,handleClick:l,onDragstart:i,tmNode:{rawNode:a,rawNode:{prefix:o,suffix:f,[t]:v}}}=this;return y("span",Object.assign({},c,{ref:"selfRef",class:[`${e}-tree-node-content`,c==null?void 0:c.class],onClick:l,draggable:i===void 0?void 0:!0,onDragstart:i}),g||o?y("div",{class:`${e}-tree-node-content__prefix`},g?g({option:a,selected:s,checked:u}):gt(o)):null,y("div",{class:`${e}-tree-node-content__text`},r?r({option:a,selected:s,checked:u}):gt(v)),h||f?y("div",{class:`${e}-tree-node-content__suffix`},h?h({option:a,selected:s,checked:u}):gt(f)):null)}});function Yt({position:e,offsetLevel:t,indent:c,el:u}){const s={position:"absolute",boxSizing:"border-box",right:0};if(e==="inside")s.left=0,s.top=0,s.bottom=0,s.borderRadius="inherit",s.boxShadow="inset 0 0 0 2px var(--n-drop-mark-color)";else{const r=e==="before"?"top":"bottom";s[r]=0,s.left=`${u.offsetLeft+6-t*c}px`,s.height="2px",s.backgroundColor="var(--n-drop-mark-color)",s.transformOrigin=r,s.borderRadius="1px",s.transform=e==="before"?"translateY(-4px)":"translateY(4px)"}return y("div",{style:s})}function tl({dropPosition:e,node:t}){return t.isLeaf===!1||t.children?!0:e!=="inside"}function nl(e){return A(()=>e.leafOnly?"child":e.checkStrategy)}function we(e,t){return!!e.rawNode[t]}function cn(e,t,c,u){e==null||e.forEach(s=>{c(s),cn(s[t],t,c,u),u(s)})}function ol(e,t,c,u,s){const r=new Set,g=new Set,h=[];return cn(e,u,l=>{if(h.push(l),s(t,l)){g.add(l[c]);for(let i=h.length-2;i>=0;--i)if(!r.has(h[i][c]))r.add(h[i][c]);else return}},()=>{h.pop()}),{expandedKeys:Array.from(r),highlightKeySet:g}}if(to&&Image){const e=new Image;e.src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw=="}function ll(e,t,c,u,s){const r=new Set,g=new Set,h=new Set,l=[],i=[],a=[];function o(v){v.forEach(C=>{if(a.push(C),t(c,C)){r.add(C[u]),h.add(C[u]);for(let k=a.length-2;k>=0;--k){const m=a[k][u];if(!g.has(m))g.add(m),r.has(m)&&r.delete(m);else break}}const R=C[s];R&&o(R),a.pop()})}o(e);function f(v,C){v.forEach(R=>{const k=R[u],m=r.has(k),D=g.has(k);if(!m&&!D)return;const L=R[s];if(L)if(m)C.push(R);else{l.push(k);const z=Object.assign(Object.assign({},R),{[s]:[]});C.push(z),f(L,z[s])}else C.push(R)})}return f(e,i),{filteredTree:i,highlightKeySet:h,expandedKeys:l}}const rl=H({name:"TreeNode",props:{clsPrefix:{type:String,required:!0},tmNode:{type:Object,required:!0}},setup(e){const t=Te(Ye),{droppingNodeParentRef:c,droppingMouseNodeRef:u,draggingNodeRef:s,droppingPositionRef:r,droppingOffsetLevelRef:g,nodePropsRef:h,indentRef:l,blockLineRef:i,checkboxPlacementRef:a,checkOnClickRef:o,disabledFieldRef:f,showLineRef:v}=t,C=G(()=>!!e.tmNode.rawNode.checkboxDisabled),R=G(()=>we(e.tmNode,f.value)),k=G(()=>t.disabledRef.value||R.value),m=A(()=>{const{value:x}=h;if(x)return x({option:e.tmNode.rawNode})}),D=W(null),L={value:null};no(()=>{L.value=D.value.$el});function z(){const{tmNode:x}=e;if(!x.isLeaf&&!x.shallowLoaded){if(!t.loadingKeysRef.value.has(x.key))t.loadingKeysRef.value.add(x.key);else return;const{onLoadRef:{value:P}}=t;P&&P(x.rawNode).then(O=>{O!==!1&&t.handleSwitcherClick(x)}).finally(()=>{t.loadingKeysRef.value.delete(x.key)})}else t.handleSwitcherClick(x)}const j=G(()=>!R.value&&t.selectableRef.value&&(t.internalTreeSelect?t.mergedCheckStrategyRef.value!=="child"||t.multipleRef.value&&t.cascadeRef.value||e.tmNode.isLeaf:!0)),J=G(()=>t.checkableRef.value&&(t.cascadeRef.value||t.mergedCheckStrategyRef.value!=="child"||e.tmNode.isLeaf)),he=G(()=>t.displayedCheckedKeysRef.value.includes(e.tmNode.key)),de=G(()=>{const{value:x}=J;if(!x)return!1;const{value:P}=o,{tmNode:O}=e;return typeof P=="boolean"?!O.disabled&&P:P(e.tmNode.rawNode)});function be(x){const{value:P}=t.expandOnClickRef,{value:O}=j,{value:ee}=de;if(!O&&!P&&!ee||Ut(x,"checkbox")||Ut(x,"switcher"))return;const{tmNode:Xe}=e;O&&t.handleSelect(Xe),P&&!Xe.isLeaf&&z(),ee&&Re(!he.value)}function ge(x){var P,O;i.value||(k.value||be(x),(O=(P=m.value)===null||P===void 0?void 0:P.onClick)===null||O===void 0||O.call(P,x))}function Se(x){var P,O;i.value&&(k.value||be(x),(O=(P=m.value)===null||P===void 0?void 0:P.onClick)===null||O===void 0||O.call(P,x))}function Re(x){t.handleCheck(e.tmNode,x)}function Oe(x){t.handleDragStart({event:x,node:e.tmNode})}function re(x){x.currentTarget===x.target&&t.handleDragEnter({event:x,node:e.tmNode})}function me(x){x.preventDefault(),t.handleDragOver({event:x,node:e.tmNode})}function ye(x){t.handleDragEnd({event:x,node:e.tmNode})}function it(x){x.currentTarget===x.target&&t.handleDragLeave({event:x,node:e.tmNode})}function se(x){x.preventDefault(),r.value!==null&&t.handleDrop({event:x,node:e.tmNode,dropPosition:r.value})}const xe=A(()=>{const{clsPrefix:x}=e,{value:P}=l;if(v.value){const O=[];let ee=e.tmNode.parent;for(;ee;)ee.isLastChild?O.push(y("div",{class:`${x}-tree-node-indent`},y("div",{style:{width:`${P}px`}}))):O.push(y("div",{class:[`${x}-tree-node-indent`,`${x}-tree-node-indent--show-line`]},y("div",{style:{width:`${P}px`}}))),ee=ee.parent;return O.reverse()}else return oo(e.tmNode.level,y("div",{class:`${e.clsPrefix}-tree-node-indent`},y("div",{style:{width:`${P}px`}})))});return{showDropMark:G(()=>{const{value:x}=s;if(!x)return;const{value:P}=r;if(!P)return;const{value:O}=u;if(!O)return;const{tmNode:ee}=e;return ee.key===O.key}),showDropMarkAsParent:G(()=>{const{value:x}=c;if(!x)return!1;const{tmNode:P}=e,{value:O}=r;return O==="before"||O==="after"?x.key===P.key:!1}),pending:G(()=>t.pendingNodeKeyRef.value===e.tmNode.key),loading:G(()=>t.loadingKeysRef.value.has(e.tmNode.key)),highlight:G(()=>{var x;return(x=t.highlightKeySetRef.value)===null||x===void 0?void 0:x.has(e.tmNode.key)}),checked:he,indeterminate:G(()=>t.displayedIndeterminateKeysRef.value.includes(e.tmNode.key)),selected:G(()=>t.mergedSelectedKeysRef.value.includes(e.tmNode.key)),expanded:G(()=>t.mergedExpandedKeysRef.value.includes(e.tmNode.key)),disabled:k,checkable:J,mergedCheckOnClick:de,checkboxDisabled:C,selectable:j,expandOnClick:t.expandOnClickRef,internalScrollable:t.internalScrollableRef,draggable:t.draggableRef,blockLine:i,nodeProps:m,checkboxFocusable:t.internalCheckboxFocusableRef,droppingPosition:r,droppingOffsetLevel:g,indent:l,checkboxPlacement:a,showLine:v,contentInstRef:D,contentElRef:L,indentNodes:xe,handleCheck:Re,handleDrop:se,handleDragStart:Oe,handleDragEnter:re,handleDragOver:me,handleDragEnd:ye,handleDragLeave:it,handleLineClick:Se,handleContentClick:ge,handleSwitcherClick:z}},render(){const{tmNode:e,clsPrefix:t,checkable:c,expandOnClick:u,selectable:s,selected:r,checked:g,highlight:h,draggable:l,blockLine:i,indent:a,indentNodes:o,disabled:f,pending:v,internalScrollable:C,nodeProps:R,checkboxPlacement:k}=this,m=l&&!f?{onDragenter:this.handleDragEnter,onDragleave:this.handleDragLeave,onDragend:this.handleDragEnd,onDrop:this.handleDrop,onDragover:this.handleDragOver}:void 0,D=C?ln(e.key):void 0,L=k==="right",z=c?y(Zo,{indent:a,right:L,focusable:this.checkboxFocusable,disabled:f||this.checkboxDisabled,clsPrefix:t,checked:this.checked,indeterminate:this.indeterminate,onCheck:this.handleCheck}):null;return y("div",Object.assign({class:`${t}-tree-node-wrapper`},m),y("div",Object.assign({},i?R:void 0,{class:[`${t}-tree-node`,{[`${t}-tree-node--selected`]:r,[`${t}-tree-node--checkable`]:c,[`${t}-tree-node--highlight`]:h,[`${t}-tree-node--pending`]:v,[`${t}-tree-node--disabled`]:f,[`${t}-tree-node--selectable`]:s,[`${t}-tree-node--clickable`]:s||u||this.mergedCheckOnClick},R==null?void 0:R.class],"data-key":D,draggable:l&&i,onClick:this.handleLineClick,onDragstart:l&&i&&!f?this.handleDragStart:void 0}),o,e.isLeaf&&this.showLine?y("div",{class:[`${t}-tree-node-indent`,`${t}-tree-node-indent--show-line`,e.isLeaf&&`${t}-tree-node-indent--is-leaf`,e.isLastChild&&`${t}-tree-node-indent--last-child`]},y("div",{style:{width:`${a}px`}})):y(Qo,{clsPrefix:t,expanded:this.expanded,selected:r,loading:this.loading,hide:e.isLeaf,tmNode:this.tmNode,indent:a,onClick:this.handleSwitcherClick}),L?null:z,y(el,{ref:"contentInstRef",clsPrefix:t,checked:g,selected:r,onClick:this.handleContentClick,nodeProps:i?void 0:R,onDragstart:l&&!i&&!f?this.handleDragStart:void 0,tmNode:e}),l?this.showDropMark?Yt({el:this.contentElRef.value,position:this.droppingPosition,offsetLevel:this.droppingOffsetLevel,indent:a}):this.showDropMarkAsParent?Yt({el:this.contentElRef.value,position:"inside",offsetLevel:this.droppingOffsetLevel,indent:a}):null:null,L?z:null))}}),un=rl;function al({props:e,fNodesRef:t,mergedExpandedKeysRef:c,mergedSelectedKeysRef:u,handleSelect:s,handleSwitcherClick:r}){const{value:g}=u,h=Te(sn,null),l=h?h.pendingNodeKeyRef:W(g.length?g[g.length-1]:null);function i(a){if(!e.keyboard)return;const{value:o}=l;if(o===null){if((a.key==="ArrowDown"||a.key==="ArrowUp")&&a.preventDefault(),["ArrowDown","ArrowUp","ArrowLeft","ArrowRight"].includes(a.key)&&o===null){const{value:f}=t;let v=0;for(;v<f.length;){if(!f[v].disabled){l.value=f[v].key;break}v+=1}}}else{const{value:f}=t;let v=f.findIndex(C=>C.key===o);if(!~v)return;if(a.key==="Enter")s(f[v]);else if(a.key==="ArrowDown")for(a.preventDefault(),v+=1;v<f.length;){if(!f[v].disabled){l.value=f[v].key;break}v+=1}else if(a.key==="ArrowUp")for(a.preventDefault(),v-=1;v>=0;){if(!f[v].disabled){l.value=f[v].key;break}v-=1}else if(a.key==="ArrowLeft"){const C=f[v];if(C.isLeaf||!c.value.includes(o)){const R=C.getParent();R&&(l.value=R.key)}else r(C)}else if(a.key==="ArrowRight"){const C=f[v];if(C.isLeaf)return;if(!c.value.includes(o))r(C);else for(v+=1;v<f.length;){if(!f[v].disabled){l.value=f[v].key;break}v+=1}}}}return{pendingNodeKeyRef:l,handleKeydown:i}}const il=H({name:"TreeMotionWrapper",props:{clsPrefix:{type:String,required:!0},height:Number,nodes:{type:Array,required:!0},mode:{type:String,required:!0},onAfterEnter:{type:Function,required:!0}},render(){const{clsPrefix:e}=this;return y(Zt,{onAfterEnter:this.onAfterEnter,appear:!0,reverse:this.mode==="collapse"},{default:()=>y("div",{class:[`${e}-tree-motion-wrapper`,`${e}-tree-motion-wrapper--${this.mode}`],style:{height:tn(this.height)}},this.nodes.map(t=>y(un,{clsPrefix:e,tmNode:t})))})}}),pt=lo(),dl=K("tree",`
 font-size: var(--n-font-size);
 outline: none;
`,[$("ul, li",`
 margin: 0;
 padding: 0;
 list-style: none;
 `),$(">",[K("tree-node",[$("&:first-child","margin-top: 0;")])]),K("tree-motion-wrapper",[F("expand",[bt({duration:"0.2s"})]),F("collapse",[bt({duration:"0.2s",reverse:!0})])]),K("tree-node-wrapper",`
 box-sizing: border-box;
 padding: var(--n-node-wrapper-padding);
 `),K("tree-node",`
 transform: translate3d(0,0,0);
 position: relative;
 display: flex;
 border-radius: var(--n-node-border-radius);
 transition: background-color .3s var(--n-bezier);
 `,[F("highlight",[K("tree-node-content",[X("text","border-bottom-color: var(--n-node-text-color-disabled);")])]),F("disabled",[K("tree-node-content",`
 color: var(--n-node-text-color-disabled);
 cursor: not-allowed;
 `)]),Le("disabled",[F("clickable",[K("tree-node-content",`
 cursor: pointer;
 `)])])]),F("block-node",[K("tree-node-content",`
 flex: 1;
 min-width: 0;
 `)]),Le("block-line",[K("tree-node",[Le("disabled",[K("tree-node-content",[$("&:hover","background: var(--n-node-color-hover);")]),F("selectable",[K("tree-node-content",[$("&:active","background: var(--n-node-color-pressed);")])]),F("pending",[K("tree-node-content",`
 background: var(--n-node-color-hover);
 `)]),F("selected",[K("tree-node-content","background: var(--n-node-color-active);")])])])]),F("block-line",[K("tree-node",[Le("disabled",[$("&:hover","background: var(--n-node-color-hover);"),F("pending",`
 background: var(--n-node-color-hover);
 `),F("selectable",[Le("selected",[$("&:active","background: var(--n-node-color-pressed);")])]),F("selected","background: var(--n-node-color-active);")]),F("disabled",`
 cursor: not-allowed;
 `)])]),K("tree-node-indent",`
 flex-grow: 0;
 flex-shrink: 0;
 `,[F("show-line","position: relative",[$("&::before",`
 position: absolute;
 left: 50%;
 border-left: 1px solid var(--n-border-color);
 transition: border-color .3s var(--n-bezier);
 transform: translate(-50%);
 content: "";
 top: var(--n-line-offset-top);
 bottom: var(--n-line-offset-bottom);
 `),F("last-child",[$("&::before",`
 bottom: 50%;
 `)]),F("is-leaf",[$("&::after",`
 position: absolute;
 content: "";
 left: calc(50% + 0.5px);
 right: 0;
 bottom: 50%;
 transition: border-color .3s var(--n-bezier);
 border-bottom: 1px solid var(--n-border-color);
 `)])]),Le("show-line","height: 0;")]),K("tree-node-switcher",`
 cursor: pointer;
 display: inline-flex;
 flex-shrink: 0;
 height: var(--n-node-content-height);
 align-items: center;
 justify-content: center;
 transition: transform .15s var(--n-bezier);
 vertical-align: bottom;
 `,[X("icon",`
 position: relative;
 height: 14px;
 width: 14px;
 display: flex;
 color: var(--n-arrow-color);
 transition: color .3s var(--n-bezier);
 font-size: 14px;
 `,[K("icon",[pt]),K("base-loading",`
 color: var(--n-loading-color);
 position: absolute;
 left: 0;
 top: 0;
 right: 0;
 bottom: 0;
 `,[pt]),K("base-icon",[pt])]),F("hide","visibility: hidden;"),F("expanded","transform: rotate(90deg);")]),K("tree-node-checkbox",`
 display: inline-flex;
 height: var(--n-node-content-height);
 vertical-align: bottom;
 align-items: center;
 justify-content: center;
 `),K("tree-node-content",`
 user-select: none;
 position: relative;
 display: inline-flex;
 align-items: center;
 min-height: var(--n-node-content-height);
 box-sizing: border-box;
 line-height: var(--n-line-height);
 vertical-align: bottom;
 padding: 0 6px 0 4px;
 cursor: default;
 border-radius: var(--n-node-border-radius);
 color: var(--n-node-text-color);
 transition:
 color .3s var(--n-bezier),
 background-color .3s var(--n-bezier),
 border-color .3s var(--n-bezier);
 `,[$("&:last-child","margin-bottom: 0;"),X("prefix",`
 display: inline-flex;
 margin-right: 8px;
 `),X("text",`
 border-bottom: 1px solid #0000;
 transition: border-color .3s var(--n-bezier);
 flex-grow: 1;
 max-width: 100%;
 `),X("suffix",`
 display: inline-flex;
 `)]),X("empty","margin: auto;")]);var sl=globalThis&&globalThis.__awaiter||function(e,t,c,u){function s(r){return r instanceof c?r:new c(function(g){g(r)})}return new(c||(c=Promise))(function(r,g){function h(a){try{i(u.next(a))}catch(o){g(o)}}function l(a){try{i(u.throw(a))}catch(o){g(o)}}function i(a){a.done?r(a.value):s(a.value).then(h,l)}i((u=u.apply(e,t||[])).next())})};function cl(e,t,c,u){return{getIsGroup(){return!1},getKey(r){return r[e]},getChildren:u||(r=>r[t]),getDisabled(r){return!!(r[c]||r.checkboxDisabled)}}}const ul={allowCheckingNotLoaded:Boolean,filter:Function,defaultExpandAll:Boolean,expandedKeys:Array,keyField:{type:String,default:"key"},labelField:{type:String,default:"label"},childrenField:{type:String,default:"children"},disabledField:{type:String,default:"disabled"},defaultExpandedKeys:{type:Array,default:()=>[]},indeterminateKeys:Array,renderSwitcherIcon:Function,onUpdateIndeterminateKeys:[Function,Array],"onUpdate:indeterminateKeys":[Function,Array],onUpdateExpandedKeys:[Function,Array],"onUpdate:expandedKeys":[Function,Array]},fl=Object.assign(Object.assign(Object.assign(Object.assign({},Be.props),{accordion:Boolean,showIrrelevantNodes:{type:Boolean,default:!0},data:{type:Array,default:()=>[]},expandOnDragenter:{type:Boolean,default:!0},expandOnClick:Boolean,checkOnClick:{type:[Boolean,Function],default:!1},cancelable:{type:Boolean,default:!0},checkable:Boolean,draggable:Boolean,blockNode:Boolean,blockLine:Boolean,showLine:Boolean,disabled:Boolean,checkedKeys:Array,defaultCheckedKeys:{type:Array,default:()=>[]},selectedKeys:Array,defaultSelectedKeys:{type:Array,default:()=>[]},multiple:Boolean,pattern:{type:String,default:""},onLoad:Function,cascade:Boolean,selectable:{type:Boolean,default:!0},scrollbarProps:Object,indent:{type:Number,default:24},allowDrop:{type:Function,default:tl},animated:{type:Boolean,default:!0},checkboxPlacement:{type:String,default:"left"},virtualScroll:Boolean,watchProps:Array,renderLabel:Function,renderPrefix:Function,renderSuffix:Function,nodeProps:Function,keyboard:{type:Boolean,default:!0},getChildren:Function,onDragenter:[Function,Array],onDragleave:[Function,Array],onDragend:[Function,Array],onDragstart:[Function,Array],onDragover:[Function,Array],onDrop:[Function,Array],onUpdateCheckedKeys:[Function,Array],"onUpdate:checkedKeys":[Function,Array],onUpdateSelectedKeys:[Function,Array],"onUpdate:selectedKeys":[Function,Array]}),ul),{internalTreeSelect:Boolean,internalScrollable:Boolean,internalScrollablePadding:String,internalRenderEmpty:Function,internalHighlightKeySet:Object,internalUnifySelectCheck:Boolean,internalCheckboxFocusable:{type:Boolean,default:!0},internalFocusable:{type:Boolean,default:!0},checkStrategy:{type:String,default:"all"},leafOnly:Boolean}),hl=H({name:"Tree",props:fl,setup(e){const{mergedClsPrefixRef:t,inlineThemeDisabled:c,mergedRtlRef:u}=rt(e),s=at("Tree",u,t),r=Be("Tree","-tree",dl,Yo,e,t),g=W(null),h=W(null),l=W(null);function i(){var n;return(n=l.value)===null||n===void 0?void 0:n.listElRef}function a(){var n;return(n=l.value)===null||n===void 0?void 0:n.itemsElRef}const o=A(()=>{const{filter:n}=e;if(n)return n;const{labelField:d}=e;return(p,S)=>{if(!p.length)return!0;const w=S[d];return typeof w=="string"?w.toLowerCase().includes(p.toLowerCase()):!1}}),f=A(()=>{const{pattern:n}=e;return n?!n.length||!o.value?{filteredTree:e.data,highlightKeySet:null,expandedKeys:void 0}:ll(e.data,o.value,n,e.keyField,e.childrenField):{filteredTree:e.data,highlightKeySet:null,expandedKeys:void 0}}),v=A(()=>bo(e.showIrrelevantNodes?e.data:f.value.filteredTree,cl(e.keyField,e.childrenField,e.disabledField,e.getChildren))),C=Te(sn,null),R=e.internalTreeSelect?C.dataTreeMate:v,{watchProps:k}=e,m=W([]);k!=null&&k.includes("defaultCheckedKeys")?Ce(()=>{m.value=e.defaultCheckedKeys}):m.value=e.defaultCheckedKeys;const D=B(e,"checkedKeys"),L=qe(D,m),z=A(()=>R.value.getCheckedKeys(L.value,{cascade:e.cascade,allowNotLoaded:e.allowCheckingNotLoaded})),j=nl(e),J=A(()=>z.value.checkedKeys),he=A(()=>{const{indeterminateKeys:n}=e;return n!==void 0?n:z.value.indeterminateKeys}),de=W([]);k!=null&&k.includes("defaultSelectedKeys")?Ce(()=>{de.value=e.defaultSelectedKeys}):de.value=e.defaultSelectedKeys;const be=B(e,"selectedKeys"),ge=qe(be,de),Se=W([]),Re=n=>{Se.value=e.defaultExpandAll?R.value.getNonLeafKeys():n===void 0?e.defaultExpandedKeys:n};k!=null&&k.includes("defaultExpandedKeys")?Ce(()=>{Re(void 0)}):Ce(()=>{Re(e.defaultExpandedKeys)});const Oe=B(e,"expandedKeys"),re=qe(Oe,Se),me=A(()=>v.value.getFlattenedNodes(re.value)),{pendingNodeKeyRef:ye,handleKeydown:it}=al({props:e,mergedSelectedKeysRef:ge,fNodesRef:me,mergedExpandedKeysRef:re,handleSelect:ut,handleSwitcherClick:Lt});let se=null,xe=null;const x=W(new Set),P=A(()=>e.internalHighlightKeySet||f.value.highlightKeySet),O=qe(P,x),ee=W(new Set),Xe=A(()=>re.value.filter(n=>!ee.value.has(n)));let St=0;const Me=W(null),Ge=W(null),Je=W(null),Qe=W(null),Ze=W(0),hn=A(()=>{const{value:n}=Ge;return n?n.parent:null});We(B(e,"data"),()=>{ee.value.clear(),ye.value=null,He()},{deep:!1});let dt=!1;const st=()=>{dt=!0,nt(()=>{dt=!1})};let Ue;We(B(e,"pattern"),(n,d)=>{if(e.showIrrelevantNodes)if(Ue=void 0,n){const{expandedKeys:p,highlightKeySet:S}=ol(e.data,e.pattern,e.keyField,e.childrenField,o.value);x.value=S,st(),Ee(p,oe(p),{node:null,action:"filter"})}else x.value=new Set;else if(!n.length)Ue!==void 0&&(st(),Ee(Ue,oe(Ue),{node:null,action:"filter"}));else{d.length||(Ue=re.value);const{expandedKeys:p}=f.value;p!==void 0&&(st(),Ee(p,oe(p),{node:null,action:"filter"}))}});function Rt(n){return sl(this,void 0,void 0,function*(){const{onLoad:d}=e;if(!d){yield Promise.resolve();return}const{value:p}=ee;if(!p.has(n.key)){p.add(n.key);try{(yield d(n.rawNode))===!1&&ze()}catch(S){console.error(S),ze()}p.delete(n.key)}})}Ce(()=>{var n;const{value:d}=v;if(!d)return;const{getNode:p}=d;(n=re.value)===null||n===void 0||n.forEach(S=>{const w=p(S);w&&!w.shallowLoaded&&Rt(w)})});const Pe=W(!1),ke=W([]);We(Xe,(n,d)=>{if(!e.animated||dt){nt(et);return}const p=Ve(r.value.self.nodeHeight),S=new Set(d);let w=null,U=null;for(const I of n)if(!S.has(I)){if(w!==null)return;w=I}const te=new Set(n);for(const I of d)if(!te.has(I)){if(U!==null)return;U=I}if(w===null&&U===null)return;const{virtualScroll:le}=e,Ae=(le?l.value.listElRef:g.value).offsetHeight,Ie=Math.ceil(Ae/p)+1;let ae;if(w!==null&&(ae=d),U!==null&&(ae===void 0?ae=n:ae=ae.filter(I=>I!==U)),Pe.value=!0,ke.value=v.value.getFlattenedNodes(ae),w!==null){const I=ke.value.findIndex(ie=>ie.key===w);if(~I){const ie=ke.value[I].children;if(ie){const ce=Ht(ie,n);ke.value.splice(I+1,0,{__motion:!0,mode:"expand",height:le?ce.length*p:void 0,nodes:le?ce.slice(0,Ie):ce})}}}if(U!==null){const I=ke.value.findIndex(ie=>ie.key===U);if(~I){const ie=ke.value[I].children;if(!ie)return;Pe.value=!0;const ce=Ht(ie,n);ke.value.splice(I+1,0,{__motion:!0,mode:"collapse",height:le?ce.length*p:void 0,nodes:le?ce.slice(0,Ie):ce})}}});const gn=A(()=>mo(me.value)),vn=A(()=>Pe.value?ke.value:me.value);function et(){const{value:n}=h;n&&n.sync()}function pn(){Pe.value=!1,e.virtualScroll&&nt(et)}function oe(n){const{getNode:d}=R.value;return n.map(p=>{var S;return((S=d(p))===null||S===void 0?void 0:S.rawNode)||null})}function Ee(n,d,p){const{"onUpdate:expandedKeys":S,onUpdateExpandedKeys:w}=e;Se.value=n,S&&q(S,n,d,p),w&&q(w,n,d,p)}function _t(n,d,p){const{"onUpdate:checkedKeys":S,onUpdateCheckedKeys:w}=e;m.value=n,w&&q(w,n,d,p),S&&q(S,n,d,p)}function bn(n,d){const{"onUpdate:indeterminateKeys":p,onUpdateIndeterminateKeys:S}=e;p&&q(p,n,d),S&&q(S,n,d)}function ct(n,d,p){const{"onUpdate:selectedKeys":S,onUpdateSelectedKeys:w}=e;de.value=n,w&&q(w,n,d,p),S&&q(S,n,d,p)}function mn(n){const{onDragenter:d}=e;d&&q(d,n)}function yn(n){const{onDragleave:d}=e;d&&q(d,n)}function xn(n){const{onDragend:d}=e;d&&q(d,n)}function kn(n){const{onDragstart:d}=e;d&&q(d,n)}function wn(n){const{onDragover:d}=e;d&&q(d,n)}function Cn(n){const{onDrop:d}=e;d&&q(d,n)}function He(){Nn(),_e()}function Nn(){Me.value=null}function _e(){Ze.value=0,Ge.value=null,Je.value=null,Qe.value=null,ze()}function ze(){se&&(window.clearTimeout(se),se=null),xe=null}function $t(n,d){if(e.disabled||we(n,e.disabledField))return;if(e.internalUnifySelectCheck&&!e.multiple){ut(n);return}const p=d?"check":"uncheck",{checkedKeys:S,indeterminateKeys:w}=R.value[p](n.key,J.value,{cascade:e.cascade,checkStrategy:j.value,allowNotLoaded:e.allowCheckingNotLoaded});_t(S,oe(S),{node:n.rawNode,action:p}),bn(w,oe(w))}function Sn(n){if(e.disabled)return;const{key:d}=n,{value:p}=re,S=p.findIndex(w=>w===d);if(~S){const w=Array.from(p);w.splice(S,1),Ee(w,oe(w),{node:n.rawNode,action:"collapse"})}else{const w=v.value.getNode(d);if(!w||w.isLeaf)return;let U;if(e.accordion){const te=new Set(n.siblings.map(({key:le})=>le));U=p.filter(le=>!te.has(le)),U.push(d)}else U=p.concat(d);Ee(U,oe(U),{node:n.rawNode,action:"expand"})}}function Lt(n){e.disabled||Pe.value||Sn(n)}function ut(n){if(!(e.disabled||!e.selectable)){if(ye.value=n.key,e.internalUnifySelectCheck){const{value:{checkedKeys:d,indeterminateKeys:p}}=z;e.multiple?$t(n,!(d.includes(n.key)||p.includes(n.key))):_t([n.key],oe([n.key]),{node:n.rawNode,action:"check"})}if(e.multiple){const d=Array.from(ge.value),p=d.findIndex(S=>S===n.key);~p?e.cancelable&&d.splice(p,1):~p||d.push(n.key),ct(d,oe(d),{node:n.rawNode,action:~p?"unselect":"select"})}else ge.value.includes(n.key)?e.cancelable&&ct([],[],{node:n.rawNode,action:"unselect"}):ct([n.key],oe([n.key]),{node:n.rawNode,action:"select"})}}function Rn(n){if(se&&(window.clearTimeout(se),se=null),n.isLeaf)return;xe=n.key;const d=()=>{if(xe!==n.key)return;const{value:p}=Je;if(p&&p.key===n.key&&!re.value.includes(n.key)){const S=re.value.concat(n.key);Ee(S,oe(S),{node:n.rawNode,action:"expand"})}se=null,xe=null};n.shallowLoaded?se=window.setTimeout(()=>{d()},1e3):se=window.setTimeout(()=>{Rt(n).then(()=>{d()})},1e3)}function _n({event:n,node:d}){!e.draggable||e.disabled||we(d,e.disabledField)||(Kt({event:n,node:d},!1),mn({event:n,node:d.rawNode}))}function $n({event:n,node:d}){!e.draggable||e.disabled||we(d,e.disabledField)||yn({event:n,node:d.rawNode})}function Ln(n){n.target===n.currentTarget&&_e()}function Kn({event:n,node:d}){He(),!(!e.draggable||e.disabled||we(d,e.disabledField))&&xn({event:n,node:d.rawNode})}function Dn({event:n,node:d}){!e.draggable||e.disabled||we(d,e.disabledField)||(St=n.clientX,Me.value=d,kn({event:n,node:d.rawNode}))}function Kt({event:n,node:d},p=!0){var S;if(!e.draggable||e.disabled||we(d,e.disabledField))return;const{value:w}=Me;if(!w)return;const{allowDrop:U,indent:te}=e;p&&wn({event:n,node:d.rawNode});const le=n.currentTarget,{height:Ae,top:Ie}=le.getBoundingClientRect(),ae=n.clientY-Ie;let I;U({node:d.rawNode,dropPosition:"inside",phase:"drag"})?ae<=8?I="before":ae>=Ae-8?I="after":I="inside":ae<=Ae/2?I="before":I="after";const{value:ce}=gn;let E,Y;const je=ce(d.key);if(je===null){_e();return}let Tt=!1;I==="inside"?(E=d,Y="inside"):I==="before"?d.isFirstChild?(E=d,Y="before"):(E=me.value[je-1],Y="after"):(E=d,Y="after"),!E.isLeaf&&re.value.includes(E.key)&&(Tt=!0,Y==="after"&&(E=me.value[je+1],E?Y="before":(E=d,Y="inside")));const Pt=E;if(Je.value=Pt,!Tt&&w.isLastChild&&w.key===E.key&&(Y="after"),Y==="after"){let Et=St-n.clientX,ft=0;for(;Et>=te/2&&E.parent!==null&&E.isLastChild&&ft<1;)Et-=te,ft+=1,E=E.parent;Ze.value=ft}else Ze.value=0;if((w.contains(E)||Y==="inside"&&((S=w.parent)===null||S===void 0?void 0:S.key)===E.key)&&!(w.key===Pt.key&&w.key===E.key)){_e();return}if(!U({node:E.rawNode,dropPosition:Y,phase:"drag"})){_e();return}if(w.key===E.key)ze();else if(xe!==E.key)if(Y==="inside"){if(e.expandOnDragenter){if(Rn(E),!E.shallowLoaded&&xe!==E.key){He();return}}else if(!E.shallowLoaded){He();return}}else ze();else Y!=="inside"&&ze();Qe.value=Y,Ge.value=E}function Tn({event:n,node:d,dropPosition:p}){if(!e.draggable||e.disabled||we(d,e.disabledField))return;const{value:S}=Me,{value:w}=Ge,{value:U}=Qe;if(!(!S||!w||!U)&&e.allowDrop({node:w.rawNode,dropPosition:U,phase:"drag"})&&S.key!==w.key){if(U==="before"){const te=S.getNext({includeDisabled:!0});if(te&&te.key===w.key){_e();return}}if(U==="after"){const te=S.getPrev({includeDisabled:!0});if(te&&te.key===w.key){_e();return}}Cn({event:n,node:w.rawNode,dragNode:S.rawNode,dropPosition:p}),He()}}function Pn(){et()}function En(){et()}function zn(n){var d;if(e.virtualScroll||e.internalScrollable){const{value:p}=h;if(!((d=p==null?void 0:p.containerRef)===null||d===void 0)&&d.contains(n.relatedTarget))return;ye.value=null}else{const{value:p}=g;if(p!=null&&p.contains(n.relatedTarget))return;ye.value=null}}We(ye,n=>{var d,p;if(n!==null){if(e.virtualScroll)(d=l.value)===null||d===void 0||d.scrollTo({key:n});else if(e.internalScrollable){const{value:S}=h;if(S===null)return;const w=(p=S.contentRef)===null||p===void 0?void 0:p.querySelector(`[data-key="${ln(n)}"]`);if(!w)return;S.scrollTo({el:w})}}}),Gt(Ye,{loadingKeysRef:ee,highlightKeySetRef:O,displayedCheckedKeysRef:J,displayedIndeterminateKeysRef:he,mergedSelectedKeysRef:ge,mergedExpandedKeysRef:re,mergedThemeRef:r,mergedCheckStrategyRef:j,nodePropsRef:B(e,"nodeProps"),disabledRef:B(e,"disabled"),checkableRef:B(e,"checkable"),selectableRef:B(e,"selectable"),expandOnClickRef:B(e,"expandOnClick"),onLoadRef:B(e,"onLoad"),draggableRef:B(e,"draggable"),blockLineRef:B(e,"blockLine"),indentRef:B(e,"indent"),cascadeRef:B(e,"cascade"),checkOnClickRef:B(e,"checkOnClick"),checkboxPlacementRef:e.checkboxPlacement,droppingMouseNodeRef:Je,droppingNodeParentRef:hn,draggingNodeRef:Me,droppingPositionRef:Qe,droppingOffsetLevelRef:Ze,fNodesRef:me,pendingNodeKeyRef:ye,showLineRef:B(e,"showLine"),disabledFieldRef:B(e,"disabledField"),internalScrollableRef:B(e,"internalScrollable"),internalCheckboxFocusableRef:B(e,"internalCheckboxFocusable"),internalTreeSelect:e.internalTreeSelect,renderLabelRef:B(e,"renderLabel"),renderPrefixRef:B(e,"renderPrefix"),renderSuffixRef:B(e,"renderSuffix"),renderSwitcherIconRef:B(e,"renderSwitcherIcon"),labelFieldRef:B(e,"labelField"),multipleRef:B(e,"multiple"),handleSwitcherClick:Lt,handleDragEnd:Kn,handleDragEnter:_n,handleDragLeave:$n,handleDragStart:Dn,handleDrop:Tn,handleDragOver:Kt,handleSelect:ut,handleCheck:$t});function Fn(n){var d;(d=l.value)===null||d===void 0||d.scrollTo(n)}const An={handleKeydown:it,scrollTo:Fn,getCheckedData:()=>{if(!e.checkable)return{keys:[],options:[]};const{checkedKeys:n}=z.value;return{keys:n,options:oe(n)}},getIndeterminateData:()=>{if(!e.checkable)return{keys:[],options:[]};const{indeterminateKeys:n}=z.value;return{keys:n,options:oe(n)}}},Dt=A(()=>{const{common:{cubicBezierEaseInOut:n},self:{fontSize:d,nodeBorderRadius:p,nodeColorHover:S,nodeColorPressed:w,nodeColorActive:U,arrowColor:te,loadingColor:le,nodeTextColor:Ae,nodeTextColorDisabled:Ie,dropMarkColor:ae,nodeWrapperPadding:I,nodeHeight:ie,lineHeight:ce}}=r.value,E=vt(I,"top"),Y=vt(I,"bottom"),je=tn(Ve(ie)-Ve(E)-Ve(Y));return{"--n-arrow-color":te,"--n-loading-color":le,"--n-bezier":n,"--n-font-size":d,"--n-node-border-radius":p,"--n-node-color-active":U,"--n-node-color-hover":S,"--n-node-color-pressed":w,"--n-node-text-color":Ae,"--n-node-text-color-disabled":Ie,"--n-drop-mark-color":ae,"--n-node-wrapper-padding":I,"--n-line-offset-top":`-${E}`,"--n-line-offset-bottom":`-${Y}`,"--n-node-content-height":je,"--n-line-height":ce}}),Fe=c?Ct("tree",void 0,Dt,e):void 0;return Object.assign(Object.assign({},An),{mergedClsPrefix:t,mergedTheme:r,rtlEnabled:s,fNodes:vn,aip:Pe,selfElRef:g,virtualListInstRef:l,scrollbarInstRef:h,handleFocusout:zn,handleDragLeaveTree:Ln,handleScroll:Pn,getScrollContainer:i,getScrollContent:a,handleAfterEnter:pn,handleResize:En,cssVars:c?void 0:Dt,themeClass:Fe==null?void 0:Fe.themeClass,onRender:Fe==null?void 0:Fe.onRender})},render(){var e;const{fNodes:t,internalRenderEmpty:c}=this;if(!t.length&&c)return c();const{mergedClsPrefix:u,blockNode:s,blockLine:r,draggable:g,disabled:h,internalFocusable:l,checkable:i,handleKeydown:a,rtlEnabled:o,handleFocusout:f,scrollbarProps:v}=this,C=l&&!h,R=C?"0":void 0,k=[`${u}-tree`,o&&`${u}-tree--rtl`,i&&`${u}-tree--checkable`,(r||s)&&`${u}-tree--block-node`,r&&`${u}-tree--block-line`],m=L=>"__motion"in L?y(il,{height:L.height,nodes:L.nodes,clsPrefix:u,mode:L.mode,onAfterEnter:this.handleAfterEnter}):y(un,{key:L.key,tmNode:L,clsPrefix:u});if(this.virtualScroll){const{mergedTheme:L,internalScrollablePadding:z}=this,j=vt(z||"0");return y(Bt,Object.assign({},v,{ref:"scrollbarInstRef",onDragleave:g?this.handleDragLeaveTree:void 0,container:this.getScrollContainer,content:this.getScrollContent,class:k,theme:L.peers.Scrollbar,themeOverrides:L.peerOverrides.Scrollbar,tabindex:R,onKeydown:C?a:void 0,onFocusout:C?f:void 0}),{default:()=>{var J;return(J=this.onRender)===null||J===void 0||J.call(this),y(po,{ref:"virtualListInstRef",items:this.fNodes,itemSize:Ve(L.self.nodeHeight),ignoreItemResize:this.aip,paddingTop:j.top,paddingBottom:j.bottom,class:this.themeClass,style:[this.cssVars,{paddingLeft:j.left,paddingRight:j.right}],onScroll:this.handleScroll,onResize:this.handleResize,showScrollbar:!1,itemResizable:!0},{default:({item:he})=>m(he)})}})}const{internalScrollable:D}=this;return k.push(this.themeClass),(e=this.onRender)===null||e===void 0||e.call(this),D?y(Bt,Object.assign({},v,{class:k,tabindex:R,onKeydown:C?a:void 0,onFocusout:C?f:void 0,style:this.cssVars,contentStyle:{padding:this.internalScrollablePadding}}),{default:()=>y("div",{onDragleave:g?this.handleDragLeaveTree:void 0,ref:"selfElRef"},this.fNodes.map(m))}):y("div",{class:k,tabindex:R,ref:"selfElRef",style:this.cssVars,onKeydown:C?a:void 0,onFocusout:C?f:void 0,onDragleave:g?this.handleDragLeaveTree:void 0},t.length?t.map(m):ro(this.$slots.empty,()=>[y(yo,{class:`${u}-tree__empty`,theme:this.mergedTheme.peers.Empty,themeOverrides:this.mergedTheme.peerOverrides.Empty})]))}}),fn=H({__name:"DraggableCard",props:{initialValue:{default:()=>({})}},setup(e){const t=e,c=t.initialValue.left!==void 0,u=t.initialValue.top!==void 0,s={x:(c?t.initialValue.left:t.initialValue.right)??0,y:(u?t.initialValue.top:t.initialValue.bottom)??0},r=nn({...s}),g=A(()=>{const m=c?`left:${r.x}px;`:`right:${r.x}px;`,D=u?`top:${r.y}px;`:`bottom:${r.y}px;`;return m+D});let h;const l=m=>{h=m,s.x=r.x,s.y=r.y},i=m=>{if(!f.value||!h)return;const D=m.clientX-h.clientX,L=m.clientY-h.clientY;r.x=s.x+(c?D:-D),r.y=s.y+(u?L:-L)},a=()=>{h=void 0},o=Z(),f=Z(),v=m=>{h&&m.preventDefault()},C=["transition-top,bottom,left,right-500"],R=()=>{if(!f.value)return;const{top:m,bottom:D,left:L,right:z}=f.value.getBoundingClientRect();if(z<0||L>window.innerWidth||D<0||m>window.innerHeight){r.x=s.x,r.y=s.y,a();const j=o.value;j&&(j.classList.add(...C),setTimeout(()=>{j.classList.remove(...C)},550))}};window.addEventListener("pointermove",i),window.addEventListener("pointerup",R),document.addEventListener("selectstart",v),Ot(()=>{window.removeEventListener("pointermove",i),window.removeEventListener("pointerup",R),document.removeEventListener("selectstart",v),a()}),We(f,(m,D)=>{m&&(m.addEventListener("pointerdown",l),m.addEventListener("pointerup",a)),D&&(D.removeEventListener("pointerdown",l),D.removeEventListener("pointerup",a))}),Ot(()=>{f.value&&(f.value.removeEventListener("pointerdown",l),f.value.removeEventListener("pointerup",a))});const k=m=>{m instanceof HTMLElement?f.value=m:f.value=void 0};return(m,D)=>(M(),ne(io,{to:"body"},[T("div",{fixed:"",ref_key:"box",ref:o,style:mt([m.$attrs.style,g.value]),class:ao(m.$attrs.class)},[on(m.$slots,"default",{onRef:k})],6)]))}}),gl=T("th",null,"Name",-1),vl=T("th",null,"Value",-1),pl=[gl,vl],bl={key:0,flex:"","flex-justify-between":"","flex-items-center":""},ml={key:0,viewBox:"0 0 28 28"},yl=T("g",{fill:"none"},[T("path",{d:"M15 8a1 1 0 1 1-2 0a1 1 0 0 1 2 0zm-1.75 3.75v7.5a.75.75 0 0 0 1.5 0v-7.5a.75.75 0 0 0-1.5 0zM2 14C2 7.373 7.373 2 14 2s12 5.373 12 12s-5.373 12-12 12S2 20.627 2 14zM14 3.5C8.201 3.5 3.5 8.201 3.5 14S8.201 24.5 14 24.5S24.5 19.799 24.5 14S19.799 3.5 14 3.5z",fill:"currentColor"})],-1),xl=[yl],kl={key:1,viewBox:"0 0 1024 1024"},wl=T("path",{d:"M722.500267 330.888533l-273.408 273.408-147.729067-147.729066a42.018133 42.018133 0 1 0-59.426133 59.426133l177.425066 177.493333a41.984 41.984 0 0 0 59.426134 0L781.9264 390.314667a42.001067 42.001067 0 0 0-59.392-59.426134h-0.034133zM78.506667 783.496533a508.279467 508.279467 0 0 0 319.0784 226.986667C530.773333 1041.066667 667.886933 1017.924267 783.701333 945.390933a508.279467 508.279467 0 0 0 226.986667-319.0784 508.279467 508.279467 0 0 0-65.058133-386.116266C848.554667 85.367467 681.710933 0.341333 511.214933 0.341333a508.6208 508.6208 0 0 0-270.813866 77.960534A36.864 36.864 0 0 0 279.552 140.629333C484.113067 12.288 755.029333 74.581333 883.268267 279.278933a434.9952 434.9952 0 0 1 55.739733 330.5472 435.029333 435.029333 0 0 1-194.3552 273.134934 435.746133 435.746133 0 0 1-330.581333 55.773866A435.165867 435.165867 0 0 1 140.936533 744.379733a436.770133 436.770133 0 0 1-5.666133-456.055466 36.829867 36.829867 0 0 0-63.317333-37.546667A510.1568 510.1568 0 0 0 78.506667 783.530667v-0.034134z"},null,-1),Cl=[wl],Nl=H({__name:"AttrCard",props:{focusNode:{}},setup(e){const t=e,c=["text","desc"],u=A(()=>Object.entries(t.focusNode.attr).map(([r,g])=>{const h={name:r,value:JSON.stringify(g)};return c.includes(r)?[h,{name:r+".length",value:JSON.stringify((g==null?void 0:g.length)??null)}]:h}).flat()),s={_id:"虚拟属性:生成快照访问节点顺序",_pid:"虚拟属性:父节点的 _id",depth:"在某些应用上可能造成无限节点错误",id:"可快速查找",text:"可快速查找"};return(r,g)=>(M(),ne(fn,{initialValue:{top:75,right:10}},{default:N(({onRef:h})=>[_(b(an),{size:"small",striped:"",singleLine:!1,class:"gkd_code",themeOverrides:{thPaddingSmall:"1px 3px",tdPaddingSmall:"1px 3px"}},{default:N(()=>[T("thead",null,[T("tr",{ref:h,"cursor-move":""},pl,512)]),_(b(dn),null,{default:N(()=>[(M(!0),fe(lt,null,yt(u.value,l=>(M(),ne(b(kt),{key:l.name},{default:N(()=>[_(b(pe),{onClick:i=>b(Ke)(`${l.name}=${l.value}`)},{default:N(()=>[l.name in s?(M(),fe("div",bl,[T("div",null,Q(l.name),1),_(b(xo),null,{trigger:N(()=>[_(b(ot),{size:"16"},{default:N(()=>[l.name!="id"&&l.name!="text"?(M(),fe("svg",ml,xl)):(r.focusNode.quickFind||l.name=="id"&&r.focusNode.idQf||l.name=="text"&&r.focusNode.textQf)&&JSON.parse(l.value)?(M(),fe("svg",kl,Cl)):Ne("",!0)]),_:2},1024)]),default:N(()=>[V(" "+Q(s[l.name]),1)]),_:2},1024)])):(M(),fe(lt,{key:1},[V(Q(l.name),1)],64))]),_:2},1032,["onClick"]),_(b(pe),null,{default:N(()=>[l.name=="id"?(M(),ne(b(De),{key:0,style:{width:"180px","min-width":"max(12vw, 180px)",direction:"rtl","text-align":"left"}},{default:N(()=>[V(Q(l.value),1)]),_:2},1024)):(M(),ne(b(De),{key:1,style:{width:"180px","min-width":"max(12vw, 180px)"}},{default:N(()=>[V(Q(l.value),1)]),_:2},1024))]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:2},1024)]),_:1}))}}),Sl={flex:"","flex-col":"",relative:"","h-full":""},Rl=["src"],_l=T("div",{absolute:"","left-0":"","top-0":"","bottom-0":"","right-0":"","b-solid":"","b-1px":"","b-red":""},null,-1),$l=[_l],Ll={class:"left-[calc(100%+4px)]",absolute:"","top-0":"","overflow-hidden":"","z-1":"","bg-white":"","h-200px":"","w-200px":"","border-1px":"","border-indigo-600":"","border-dashed":""},Kl=["src"],Dl={absolute:"","left-2px":"","top-2px":"",class:"leading-[1]",style:{"background-color":"rgba(256, 256, 256, 0.7)"}},Tl=T("div",{class:"top-[calc(50%-1px)]",absolute:"","left-0":"","right-0":"","h-1px":"","bg-repeat-x":"","mix-blend-difference":"",style:{background:`linear-gradient(
            to left,
            transparent 0%,
            transparent 50%,
            #fff 50%,
            #fff 100%
          )`,"background-size":"10px 1px"}},null,-1),Pl=T("div",{class:"left-[calc(50%-1px)]",absolute:"","top-0":"","bottom-0":"","w-1px":"","bg-repeat-y":"","mix-blend-difference":"",style:{background:`linear-gradient(
            to top,
            transparent 0%,
            transparent 50%,
            #fff 50%,
            #fff 100%
          )`,"background-size":"1px 10px"}},null,-1),El=H({__name:"ScreenshotCard",props:{url:{},snapshot:{},rootNode:{},focusNode:{},onUpdateFocusNode:{type:Function,default:()=>()=>{}}},setup(e){const t=e,c=Z(),u=Z();Ce(()=>{if(!t.rootNode)return;const a=u.value,o=c.value;if(!a||!o)return;const f=o.getBoundingClientRect(),v=f.width/o.naturalWidth*o.naturalHeight,C=(f.height-v)/2,R=(a.clientX-f.left)/f.width*o.naturalWidth,k=(a.clientY-f.top-C)/v*o.naturalHeight,m=ko(t.snapshot.nodes,R,k);m&&t.onUpdateFocusNode(m)});const s=a=>`${a*100}%`,r=A(()=>{var C;const a=c.value,o=(C=t.focusNode)==null?void 0:C.attr;if(!t.focusNode||!a||!o)return"";const f=a.getBoundingClientRect(),v=f.width/a.naturalWidth*a.naturalHeight;return{left:`calc(${s(o.left/a.naturalWidth)} - 2px)`,width:`calc(${s((o.right-o.left)/a.naturalWidth)} + 2px)`,top:`calc(${s((o.top/a.naturalHeight*v+(f.height-v)/2)/f.height)} - 2px)`,height:`calc(${s((o.bottom-o.top)/a.naturalHeight*v/f.height)} + 2px)`}}),g=Z(!1),h=Z({ox:0,oy:0}),l=a=>{const o=c.value;if(!o)return;const f=o.getBoundingClientRect(),v=f.width/o.naturalWidth*o.naturalHeight,C=(f.height-v)/2,R=(a.clientX-f.left)/f.width*o.naturalWidth,k=(a.clientY-f.top-C)/v*o.naturalHeight;h.value={ox:R,oy:k},i.value={left:-(R-.1*o.naturalWidth)/o.naturalWidth*1e3+"px",top:-(k-.1*o.naturalWidth)/o.naturalWidth*1e3+"px"}},i=Z({left:"0",top:"0"});return(a,o)=>(M(),fe("div",Sl,[T("img",{ref_key:"imgRef",ref:c,src:a.url,onClick:o[0]||(o[0]=f=>u.value=f),"cursor-crosshair":"","h-full":"","object-contain":"",style:{"max-width":"max(35vw, 400px)"},onMouseover:o[1]||(o[1]=f=>g.value=!0),onMouseleave:o[2]||(o[2]=f=>g.value=!1),onMousemove:l},null,40,Rl),T("div",{style:mt(r.value),absolute:"","pointer-events-none":"","transition-all-300":"","b-1px":"","b-blue":"","b-solid":""},$l,4),Jt(T("div",Ll,[T("img",{src:a.url,"object-contain":"",absolute:"","left-0":"","top-0":"",style:mt(i.value),"w-1000px":""},null,12,Kl),T("div",Dl,Q(`${h.value.ox.toFixed(0)},${h.value.oy.toFixed(0)}`),1),Tl,Pl],512),[[Qt,g.value]])]))}}),zl={"w-480px":"","bg-white":"","b-1px":"","b-solid":"","b-gray-200":"","rounded-4px":"","p-8px":"",style:{"min-width":"max(25vw, 480px)"}},Fl={flex:"","m-b-4px":""},Al=T("svg",{xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 32 32"},[T("path",{d:"M29 27.586l-7.552-7.552a11.018 11.018 0 1 0-1.414 1.414L27.586 29zM4 13a9 9 0 1 1 9 9a9.01 9.01 0 0 1-9-9z",fill:"currentColor"})],-1),Il=T("div",{"p-5px":""},null,-1),Bl={key:0,underline:"","decoration-1":"","m-r-4px":"",title:"查询数量"},Ol=["title"],Ml=T("svg",{viewBox:"0 0 24 24"},[T("path",{d:"M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z",fill:"currentColor"})],-1),Ul=T("div",{"p-l-8px":""},null,-1),Hl=T("svg",{viewBox:"0 0 24 24"},[T("g",{fill:"none"},[T("path",{d:"M12 1.75a3.25 3.25 0 0 1 3.245 3.066L15.25 5h5.25a.75.75 0 0 1 .102 1.493L20.5 6.5h-.796l-1.28 13.02a2.75 2.75 0 0 1-2.561 2.474l-.176.006H8.313a2.75 2.75 0 0 1-2.714-2.307l-.023-.174L4.295 6.5H3.5a.75.75 0 0 1-.743-.648L2.75 5.75a.75.75 0 0 1 .648-.743L3.5 5h5.25A3.25 3.25 0 0 1 12 1.75zm6.197 4.75H5.802l1.267 12.872a1.25 1.25 0 0 0 1.117 1.122l.127.006h7.374c.6 0 1.109-.425 1.225-1.002l.02-.126L18.196 6.5zM13.75 9.25a.75.75 0 0 1 .743.648L14.5 10v7a.75.75 0 0 1-1.493.102L13 17v-7a.75.75 0 0 1 .75-.75zm-3.5 0a.75.75 0 0 1 .743.648L11 10v7a.75.75 0 0 1-1.493.102L9.5 17v-7a.75.75 0 0 1 .75-.75zm1.75-6a1.75 1.75 0 0 0-1.744 1.606L10.25 5h3.5A1.75 1.75 0 0 0 12 3.25z",fill:"currentColor"})])],-1),jl=H({__name:"SearchCard",props:{snapshot:{},rootNode:{},onUpdateFocusNode:{type:Function,default:()=>()=>{}}},setup(e){const t=e,c=Z(""),u=nn([]),s=qt(()=>{if(!t.rootNode){ue.error("根节点不存在");return}const l=c.value.trim();if(l)if(g.value){const i=_o(()=>$o(l),"选择器非法");if(u.find(o=>typeof o.selector=="object"&&o.selector.toString()==i.toString())){ue.warning("不可重复选择");return}const a=i.querySelectorAll(t.rootNode);if(a.length==0){ue.success("没有选择到节点");return}ue.success(`选择到 ${a.length} 个节点`),u.unshift({selector:i,results:a})}else{if(u.find(o=>typeof o.selector=="string"&&o.selector.toString()==l)){ue.warning("不可重复选择");return}const i=[],a=[t.rootNode];for(;a.length>0;){const o=a.pop();xt(o).includes(l)&&i.push(o),a.push(...[...o.children].reverse())}if(i.length==0){ue.success("没有搜索到节点");return}ue.success(`搜索到 ${i.length} 个节点`),u.unshift({selector:l,results:i})}}),r=qt(async l=>{let i=Mn[t.snapshot.id];i&&(i=zt(i));let a=Xt[t.snapshot.id];a&&(a=zt(a));const o={id:t.snapshot.appId,name:t.snapshot.appName,groups:[{key:1,name:`[ChangeMe]规则名称-${So().format("YYYY-MM-DD HH:mm:ss")}`,desc:"[ChangeMe]本规则由GKD网页端审查工具生成",rules:[{activityIds:t.snapshot.activityId,matches:l.toString(),exampleUrls:i,snapshotUrls:a}]}]};Ke(Lo.stringify(o,void 0,2))}),g=Z(!0),h=window.innerWidth/100;return(l,i)=>(M(),ne(fn,{initialValue:{top:75,right:Math.max(315,12*h+135)},class:"z-1"},{default:N(({onRef:a})=>[T("div",zl,[T("div",Fl,[_(b(wo),{value:g.value,"onUpdate:value":i[0]||(i[0]=o=>g.value=o)},{default:N(()=>[_(b(jt),null,{default:N(()=>[_(b(Vt),{value:!1},{default:N(()=>[V(" 字符搜索 ")]),_:1}),_(b(Vt),{value:!0},{default:N(()=>[V(" 选择器查询 ")]),_:1})]),_:1})]),_:1},8,["value"]),T("div",{"flex-1":"","cursor-move":"",ref:a},null,512)]),_(b(No),null,{default:N(()=>[_(b(Co),{value:c.value,"onUpdate:value":i[1]||(i[1]=o=>c.value=o),placeholder:g.value?"请输入选择器":"请输入字符",onKeyup:so(b(s),["enter"]),inputProps:{class:"gkd_code"}},null,8,["value","placeholder","onKeyup"]),_(b(tt),{onClick:b(s)},{icon:N(()=>[_(b(ot),null,{default:N(()=>[Al]),_:1})]),_:1},8,["onClick"])]),_:1}),Il,_(b(Io),null,{default:N(()=>[(M(!0),fe(lt,null,yt(b(u),(o,f)=>(M(),ne(b(Mo),{key:o.selector.toString()},{header:N(()=>[o.results.length>1?(M(),fe("span",Bl,Q(o.results.length),1)):Ne("",!0),T("span",{"break-all":"",title:typeof o.selector=="object"?"选择器":"搜索字符"},Q(o.selector.toString()),9,Ol)]),"header-extra":N(()=>[typeof o.selector=="object"?(M(),ne(b(tt),{key:0,size:"small",onClick:Mt(v=>b(r)(o.selector),["stop"]),title:"复制规则"},{icon:N(()=>[_(b(ot),null,{default:N(()=>[Ml]),_:1})]),_:2},1032,["onClick"])):Ne("",!0),Ul,_(b(tt),{size:"small",onClick:Mt(v=>b(u).splice(f,1),["stop"]),title:"删除记录"},{icon:N(()=>[_(b(ot),null,{default:N(()=>[Hl]),_:1})]),_:2},1032,["onClick"])]),default:N(()=>[_(b(jt),{style:{"max-height":"400px","overflow-y":"scroll","padding-bottom":"10px"}},{default:N(()=>[(M(!0),fe(lt,null,yt(o.results,v=>(M(),ne(b(tt),{key:v.id,onClick:C=>l.onUpdateFocusNode(v),size:"small"},{default:N(()=>[V(Q(b(xt)(v)),1)]),_:2},1032,["onClick"]))),128))]),_:2},1024)]),_:2},1024))),128))]),_:1})])]),_:1},8,["initialValue"]))}}),Vl={flex:"","flex-col":""},Wl=H({__name:"WindowCard",props:{snapshot:{},rootNode:{},focusNode:{},onUpdateFocusNode:{type:Function,default:()=>()=>{}}},setup(e){const t=e,c=Z([]);Ce(async()=>{var o;if(!t.focusNode)return;const l=t.focusNode.id;let i=t.focusNode.parent;if(!i)return;const a=new Set(c.value);for(;i;)a.add(i.id),i=i.parent;a.size!=c.value.length&&(c.value=[...a],await nt(),(o=u.value)==null||o.scrollTo({key:l}))});const u=Z(),s=(l,i,a)=>{},r=(l,i)=>{var a;return i.id===((a=t.focusNode)==null?void 0:a.id)},g=l=>{var i;return{onClick:()=>{t.onUpdateFocusNode(l.option)},style:{color:l.option.id==((i=t.focusNode)==null?void 0:i.id)?"#00F":void 0}}},h=l=>xt(l.option);return(l,i)=>(M(),fe("div",Vl,[_(b(an),{size:"small",striped:"",singleLine:!1,class:"table-fixed",themeOverrides:{thPaddingSmall:"2px 4px",tdPaddingSmall:"2px 4px"}},{default:N(()=>[_(b(Jo),null,{default:N(()=>[_(b(kt),null,{default:N(()=>[_(b($e),{class:"w-140px"},{default:N(()=>[V(" Device ")]),_:1}),_(b($e),{class:"w-100px"},{default:N(()=>[V(" Name ")]),_:1}),_(b($e),{class:"w-100px"},{default:N(()=>[V(" VersionName ")]),_:1}),_(b($e),{class:"w-100px"},{default:N(()=>[V(" VersionCode ")]),_:1}),_(b($e),{class:"w-150px"},{default:N(()=>[V(" AppId ")]),_:1}),_(b($e),null,{default:N(()=>[V(" ActivityId ")]),_:1}),_(b($e),{class:"w-175px"},{default:N(()=>[V(" 操作 ")]),_:1})]),_:1})]),_:1}),_(b(dn),null,{default:N(()=>[_(b(kt),null,{default:N(()=>[_(b(pe),{class:"whitespace-nowrap"},{default:N(()=>[V(Q(`${b(Wt)(l.snapshot).manufacturer} Android ${b(Wt)(l.snapshot).release||""}`),1)]),_:1}),_(b(pe),{class:"whitespace-nowrap",onClick:i[0]||(i[0]=a=>b(Ke)(l.snapshot.appName))},{default:N(()=>[_(b(De),null,{default:N(()=>[V(Q(l.snapshot.appName),1)]),_:1})]),_:1}),_(b(pe),{class:"whitespace-nowrap",onClick:i[1]||(i[1]=a=>b(Ke)(l.snapshot.appVersionName))},{default:N(()=>[_(b(De),null,{default:N(()=>[V(Q(l.snapshot.appVersionName),1)]),_:1})]),_:1}),_(b(pe),{class:"whitespace-nowrap",onClick:i[2]||(i[2]=a=>b(Ke)(l.snapshot.appVersionCode.toString()))},{default:N(()=>[_(b(De),null,{default:N(()=>[V(Q(l.snapshot.appVersionCode),1)]),_:1})]),_:1}),_(b(pe),{class:"whitespace-nowrap",onClick:i[3]||(i[3]=a=>b(Ke)(l.snapshot.appId))},{default:N(()=>[_(b(De),null,{default:N(()=>[V(Q(l.snapshot.appId),1)]),_:1})]),_:1}),_(b(pe),{onClick:i[4]||(i[4]=a=>b(Ke)(l.snapshot.activityId)),class:"break-words"},{default:N(()=>[_(b(De),null,{default:N(()=>[V(Q(l.snapshot.activityId),1)]),_:1})]),_:1}),_(b(pe),null,{default:N(()=>[on(l.$slots,"default")]),_:3})]),_:3})]),_:3})]),_:3}),_(b(hl),{ref_key:"treeRef",ref:u,virtualScroll:"",showLine:"","onUpdate:checkedKeys":s,keyField:"id",defaultExpandedKeys:c.value,data:[l.rootNode],filter:r,nodeProps:g,renderLabel:h,style:{"--n-border-color":"rgb(239, 239, 245)"}},null,8,["defaultExpandedKeys","data","filter","nodeProps","renderLabel"])]))}}),ql={"h-full":"",flex:"","gap-5px":"","p-5px":"","box-border":""},er=H({__name:"SnapshotPage",setup(e){const t=co(),c=uo(),u=Ko(),s=A(()=>String(t.params.snapshotId||"")),r=A(()=>{const o=Number(t.query.showSize||"");return!Number.isSafeInteger(o)||o<=0?2e3:o}),g=Z(""),h=Z();Ce(async()=>{const o=await Ft.getItem(s.value);if(!o){ue.error("快照数据缺失");return}Un()&&setTimeout(async()=>{Bn(o),Xt[o.id]||On(await Ft.getItem(s.value))},1e3),o.nodes.length>r.value&&(ue.warning(`当前展示节点数量为${r.value}
之后的${o.nodes.length-r.value}个节点将被丢弃
使用showSize查询参数可以修改展示数量`),o.nodes=o.nodes.slice(0,r.value));const f=await Hn.getItem(s.value);if(!f){ue.create("截屏数据缺失");return}g.value=URL.createObjectURL(new Blob([f],{type:"image/png"})),h.value=o,l.value=Ro(o.nodes),u.value="快照-"+o.appName||o.appId,await At(500),i.value||(i.value=l.value)});const l=Z(),i=Z(),a=async()=>{ue.success("删除成功,即将回到首页"),await At(2e3),c.replace({path:"/"})};return(o,f)=>(M(),fe("div",ql,[g.value&&h.value?(M(),ne(El,{key:0,url:g.value,snapshot:h.value,rootNode:l.value,focusNode:i.value,onUpdateFocusNode:f[0]||(f[0]=v=>i.value=v)},null,8,["url","snapshot","rootNode","focusNode"])):Ne("",!0),h.value&&l.value?(M(),ne(Wl,{key:1,rootNode:l.value,snapshot:h.value,focusNode:i.value,onUpdateFocusNode:f[1]||(f[1]=v=>i.value=v),class:"flex-1"},{default:N(()=>[h.value?(M(),ne(In,{key:0,snapshot:h.value,onDelete:a,showPreview:!1},null,8,["snapshot"])):Ne("",!0)]),_:1},8,["rootNode","snapshot","focusNode"])):Ne("",!0),i.value?(M(),ne(Nl,{key:2,focusNode:i.value},null,8,["focusNode"])):Ne("",!0),l.value&&h.value?(M(),ne(jl,{key:3,snapshot:h.value,rootNode:l.value,onUpdateFocusNode:f[2]||(f[2]=v=>i.value=v)},null,8,["snapshot","rootNode"])):Ne("",!0)]))}});export{er as default};
//# sourceMappingURL=SnapshotPage-dc32bf1e.js.map
