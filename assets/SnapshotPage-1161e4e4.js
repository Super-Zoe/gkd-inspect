import{_ as $n,e as Ln,f as En}from"./ActionCard.vue_vue_type_script_setup_true_lang-ea6e0655.js";import{f as pt,c as Fe,m as ue,a as Et,b as Fn,e as An,h as In,i as On}from"./storage-94b3fd3b.js";import{d as M,m as y,n as kt,p as T,q as F,v as Y,x as K,y as ot,z as j,c as A,A as ze,B as jt,C as rt,D as wt,E as Ct,G as V,H as zn,I as O,J as Vt,K as Wt,L as qt,M as Bn,O as G,P as Ke,Q as Un,S as Ft,T as Xt,U as Mn,V as ve,W as Hn,X as jn,Y as Vn,Z as _e,_ as Wn,$ as qn,a0 as ut,a1 as Xn,a2 as Yn,a3 as ft,a4 as Gn,a5 as Jn,a6 as Zn,a7 as Yt,a8 as Qn,w as Ce,e as We,a9 as ht,aa as Ve,ab as At,ac as eo,ad as nt,a as Gt,s as Z,ae as It,af as ie,h as q,ag as Jt,ah as bt,ai as to,aj as no,o as W,g as C,b as _,u as b,k as B,f as Oe,ak as mt,F as yt,t as te,l as Ae,i as oo,j as gt,al as ro,am as lo,an as ao}from"./index-f7895664.js";import{e as qe,C as io,f as so,g as co,h as uo,i as Ot,V as fo,j as ho,k as zt,l as go,m as vo,n as po,o as Ie,p as bo,c as Bt,q as Ut,r as mo,N as yo,a as xo,s as xt,t as Mt,v as ko}from"./node-9c410f2c.js";import{e as wo,a as Co,p as No,u as So}from"./index-3f46b576.js";import{_ as Ro}from"./_plugin-vue_export-helper-c27b6911.js";import"./jszip.min-0b822b19.js";function Zt(e){return typeof e=="string"?`s-${e}`:`n-${e}`}const _o=M({name:"ChevronLeft",render(){return y("svg",{viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg"},y("path",{d:"M10.3536 3.14645C10.5488 3.34171 10.5488 3.65829 10.3536 3.85355L6.20711 8L10.3536 12.1464C10.5488 12.3417 10.5488 12.6583 10.3536 12.8536C10.1583 13.0488 9.84171 13.0488 9.64645 12.8536L5.14645 8.35355C4.95118 8.15829 4.95118 7.84171 5.14645 7.64645L9.64645 3.14645C9.84171 2.95118 10.1583 2.95118 10.3536 3.14645Z",fill:"currentColor"}))}}),Ko=M({name:"Switcher",render(){return y("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 32"},y("path",{d:"M12 8l10 8l-10 8z"}))}}),Po=e=>{const{fontWeight:t,textColor1:c,textColor2:u,textColorDisabled:r,dividerColor:o,fontSize:g}=e;return{titleFontSize:g,titleFontWeight:t,dividerColor:o,titleTextColor:c,titleTextColorDisabled:r,fontSize:g,textColor:u,arrowColor:u,arrowColorDisabled:r,itemMargin:"16px 0 0 0",titlePadding:"16px 0 0 0"}},To={name:"Collapse",common:kt,self:Po},Do=To,$o=T("collapse","width: 100%;",[T("collapse-item",`
 font-size: var(--n-font-size);
 color: var(--n-text-color);
 transition:
 color .3s var(--n-bezier),
 border-color .3s var(--n-bezier);
 margin: var(--n-item-margin);
 `,[F("disabled",[Y("header","cursor: not-allowed;",[Y("header-main",`
 color: var(--n-title-text-color-disabled);
 `),T("collapse-item-arrow",`
 color: var(--n-arrow-color-disabled);
 `)])]),T("collapse-item","margin-left: 32px;"),K("&:first-child","margin-top: 0;"),K("&:first-child >",[Y("header","padding-top: 0;")]),F("left-arrow-placement",[Y("header",[T("collapse-item-arrow","margin-right: 4px;")])]),F("right-arrow-placement",[Y("header",[T("collapse-item-arrow","margin-left: 4px;")])]),Y("content-wrapper",[Y("content-inner","padding-top: 16px;"),pt({duration:"0.15s"})]),F("active",[Y("header",[F("active",[T("collapse-item-arrow","transform: rotate(90deg);")])])]),K("&:not(:first-child)","border-top: 1px solid var(--n-divider-color);"),Y("header",`
 font-size: var(--n-title-font-size);
 display: flex;
 flex-wrap: nowrap;
 align-items: center;
 transition: color .3s var(--n-bezier);
 position: relative;
 padding: var(--n-title-padding);
 color: var(--n-title-text-color);
 cursor: pointer;
 `,[Y("header-main",`
 display: flex;
 flex-wrap: nowrap;
 align-items: center;
 font-weight: var(--n-title-font-weight);
 transition: color .3s var(--n-bezier);
 flex: 1;
 color: var(--n-title-text-color);
 `),Y("header-extra",`
 display: flex;
 align-items: center;
 transition: color .3s var(--n-bezier);
 color: var(--n-text-color);
 `),T("collapse-item-arrow",`
 display: flex;
 transition:
 transform .15s var(--n-bezier),
 color .3s var(--n-bezier);
 font-size: 18px;
 color: var(--n-arrow-color);
 `)])])]),Lo=Object.assign(Object.assign({},ze.props),{defaultExpandedNames:{type:[Array,String],default:null},expandedNames:[Array,String],arrowPlacement:{type:String,default:"left"},accordion:{type:Boolean,default:!1},displayDirective:{type:String,default:"if"},onItemHeaderClick:[Function,Array],"onUpdate:expandedNames":[Function,Array],onUpdateExpandedNames:[Function,Array],onExpandedNamesChange:{type:[Function,Array],validator:()=>!0,default:void 0}}),Qt=Ct("n-collapse"),Eo=M({name:"Collapse",props:Lo,setup(e,{slots:t}){const{mergedClsPrefixRef:c,inlineThemeDisabled:u,mergedRtlRef:r}=ot(e),o=j(e.defaultExpandedNames),g=A(()=>e.expandedNames),f=qe(g,o),d=ze("Collapse","-collapse",$o,Do,e,c);function a(R){const{"onUpdate:expandedNames":k,onUpdateExpandedNames:m,onExpandedNamesChange:D}=e;m&&V(m,R),k&&V(k,R),D&&V(D,R),o.value=R}function s(R){const{onItemHeaderClick:k}=e;k&&V(k,R)}function l(R,k,m){const{accordion:D}=e,{value:P}=f;if(D)R?(a([k]),s({name:k,expanded:!0,event:m})):(a([]),s({name:k,expanded:!1,event:m}));else if(!Array.isArray(P))a([k]),s({name:k,expanded:!0,event:m});else{const E=P.slice(),H=E.findIndex(J=>k===J);~H?(E.splice(H,1),a(E),s({name:k,expanded:!1,event:m})):(E.push(k),a(E),s({name:k,expanded:!0,event:m}))}}jt(Qt,{props:e,mergedClsPrefixRef:c,expandedNamesRef:f,slots:t,toggleItem:l});const h=rt("Collapse",r,c),v=A(()=>{const{common:{cubicBezierEaseInOut:R},self:{titleFontWeight:k,dividerColor:m,titlePadding:D,titleTextColor:P,titleTextColorDisabled:E,textColor:H,arrowColor:J,fontSize:he,titleFontSize:de,arrowColorDisabled:be,itemMargin:ge}}=d.value;return{"--n-font-size":he,"--n-bezier":R,"--n-text-color":H,"--n-divider-color":m,"--n-title-padding":D,"--n-title-font-size":de,"--n-title-text-color":P,"--n-title-text-color-disabled":E,"--n-title-font-weight":k,"--n-arrow-color":J,"--n-arrow-color-disabled":be,"--n-item-margin":ge}}),N=u?wt("collapse",void 0,v,e):void 0;return{rtlEnabled:h,mergedTheme:d,mergedClsPrefix:c,cssVars:u?void 0:v,themeClass:N==null?void 0:N.themeClass,onRender:N==null?void 0:N.onRender}},render(){var e;return(e=this.onRender)===null||e===void 0||e.call(this),y("div",{class:[`${this.mergedClsPrefix}-collapse`,this.rtlEnabled&&`${this.mergedClsPrefix}-collapse--rtl`,this.themeClass],style:this.cssVars},this.$slots)}}),Fo=M({name:"CollapseItemContent",props:{displayDirective:{type:String,required:!0},show:Boolean,clsPrefix:{type:String,required:!0}},setup(e){return{onceTrue:zn(O(e,"show"))}},render(){return y(qt,null,{default:()=>{const{show:e,displayDirective:t,onceTrue:c,clsPrefix:u}=this,r=t==="show"&&c,o=y("div",{class:`${u}-collapse-item__content-wrapper`},y("div",{class:`${u}-collapse-item__content-inner`},this.$slots));return r?Vt(o,[[Wt,e]]):e?o:null}})}}),Ao={title:String,name:[String,Number],disabled:Boolean,displayDirective:String},Io=M({name:"CollapseItem",props:Ao,setup(e){const{mergedRtlRef:t}=ot(e),c=Bn(),u=G(()=>{var l;return(l=e.name)!==null&&l!==void 0?l:c}),r=Ke(Qt);r||Un("collapse-item","`n-collapse-item` must be placed inside `n-collapse`.");const{expandedNamesRef:o,props:g,mergedClsPrefixRef:f,slots:d}=r,a=A(()=>{const{value:l}=o;if(Array.isArray(l)){const{value:h}=u;return!~l.findIndex(v=>v===h)}else if(l){const{value:h}=u;return h!==l}return!0});return{rtlEnabled:rt("Collapse",t,f),collapseSlots:d,randomName:c,mergedClsPrefix:f,collapsed:a,mergedDisplayDirective:A(()=>{const{displayDirective:l}=e;return l||g.displayDirective}),arrowPlacement:A(()=>g.arrowPlacement),handleClick(l){r&&!e.disabled&&r.toggleItem(a.value,u.value,l)}}},render(){const{collapseSlots:e,$slots:t,arrowPlacement:c,collapsed:u,mergedDisplayDirective:r,mergedClsPrefix:o,disabled:g}=this,f=Ft(t.header,{collapsed:u},()=>[this.title]),d=t["header-extra"]||e["header-extra"],a=t.arrow||e.arrow;return y("div",{class:[`${o}-collapse-item`,`${o}-collapse-item--${c}-arrow-placement`,g&&`${o}-collapse-item--disabled`,!u&&`${o}-collapse-item--active`]},y("div",{class:[`${o}-collapse-item__header`,!u&&`${o}-collapse-item__header--active`]},y("div",{class:`${o}-collapse-item__header-main`,onClick:this.handleClick},c==="right"&&f,y("div",{class:`${o}-collapse-item-arrow`,key:this.rtlEnabled?0:1},Ft(a,{collapsed:u},()=>{var s;return[y(Xt,{clsPrefix:o},{default:(s=e.expandIcon)!==null&&s!==void 0?s:()=>this.rtlEnabled?y(_o,null):y(io,null)})]})),c==="left"&&f),Mn(d,{collapsed:u},s=>y("div",{class:`${o}-collapse-item__header-extra`,onClick:this.handleClick},s))),y(Fo,{clsPrefix:o,displayDirective:r,show:!u},t))}}),Oo={thPaddingSmall:"6px",thPaddingMedium:"12px",thPaddingLarge:"12px",tdPaddingSmall:"6px",tdPaddingMedium:"12px",tdPaddingLarge:"12px"},zo=e=>{const{dividerColor:t,cardColor:c,modalColor:u,popoverColor:r,tableHeaderColor:o,tableColorStriped:g,textColor1:f,textColor2:d,borderRadius:a,fontWeightStrong:s,lineHeight:l,fontSizeSmall:h,fontSizeMedium:v,fontSizeLarge:N}=e;return Object.assign(Object.assign({},Oo),{fontSizeSmall:h,fontSizeMedium:v,fontSizeLarge:N,lineHeight:l,borderRadius:a,borderColor:ve(c,t),borderColorModal:ve(u,t),borderColorPopover:ve(r,t),tdColor:c,tdColorModal:u,tdColorPopover:r,tdColorStriped:ve(c,g),tdColorStripedModal:ve(u,g),tdColorStripedPopover:ve(r,g),thColor:ve(c,o),thColorModal:ve(u,o),thColorPopover:ve(r,o),thTextColor:f,tdTextColor:d,thFontWeight:s})},Bo={name:"Table",common:kt,self:zo},Uo=Bo,Mo=e=>{const{borderRadiusSmall:t,hoverColor:c,pressedColor:u,primaryColor:r,textColor3:o,textColor2:g,textColorDisabled:f,fontSize:d}=e;return{fontSize:d,lineHeight:"1.5",nodeHeight:"30px",nodeWrapperPadding:"3px 0",nodeBorderRadius:t,nodeColorHover:c,nodeColorPressed:u,nodeColorActive:Vn(r,{alpha:.1}),arrowColor:o,nodeTextColor:g,nodeTextColorDisabled:f,loadingColor:r,dropMarkColor:r}},Ho=Hn({name:"Tree",common:kt,peers:{Checkbox:so,Scrollbar:jn,Empty:co},self:Mo}),jo=Ho,Vo=K([T("table",`
 font-size: var(--n-font-size);
 font-variant-numeric: tabular-nums;
 line-height: var(--n-line-height);
 width: 100%;
 border-radius: var(--n-border-radius) var(--n-border-radius) 0 0;
 text-align: left;
 border-collapse: separate;
 border-spacing: 0;
 overflow: hidden;
 background-color: var(--n-td-color);
 border-color: var(--n-merged-border-color);
 transition:
 background-color .3s var(--n-bezier),
 border-color .3s var(--n-bezier),
 color .3s var(--n-bezier);
 --n-merged-border-color: var(--n-border-color);
 `,[K("th",`
 white-space: nowrap;
 transition:
 background-color .3s var(--n-bezier),
 border-color .3s var(--n-bezier),
 color .3s var(--n-bezier);
 text-align: inherit;
 padding: var(--n-th-padding);
 vertical-align: inherit;
 text-transform: none;
 border: 0px solid var(--n-merged-border-color);
 font-weight: var(--n-th-font-weight);
 color: var(--n-th-text-color);
 background-color: var(--n-th-color);
 border-bottom: 1px solid var(--n-merged-border-color);
 border-right: 1px solid var(--n-merged-border-color);
 `,[K("&:last-child",`
 border-right: 0px solid var(--n-merged-border-color);
 `)]),K("td",`
 transition:
 background-color .3s var(--n-bezier),
 border-color .3s var(--n-bezier),
 color .3s var(--n-bezier);
 padding: var(--n-td-padding);
 color: var(--n-td-text-color);
 background-color: var(--n-td-color);
 border: 0px solid var(--n-merged-border-color);
 border-right: 1px solid var(--n-merged-border-color);
 border-bottom: 1px solid var(--n-merged-border-color);
 `,[K("&:last-child",`
 border-right: 0px solid var(--n-merged-border-color);
 `)]),F("bordered",`
 border: 1px solid var(--n-merged-border-color);
 border-radius: var(--n-border-radius);
 `,[K("tr",[K("&:last-child",[K("td",`
 border-bottom: 0 solid var(--n-merged-border-color);
 `)])])]),F("single-line",[K("th",`
 border-right: 0px solid var(--n-merged-border-color);
 `),K("td",`
 border-right: 0px solid var(--n-merged-border-color);
 `)]),F("single-column",[K("tr",[K("&:not(:last-child)",[K("td",`
 border-bottom: 0px solid var(--n-merged-border-color);
 `)])])]),F("striped",[K("tr:nth-of-type(even)",[K("td","background-color: var(--n-td-color-striped)")])]),_e("bottom-bordered",[K("tr",[K("&:last-child",[K("td",`
 border-bottom: 0px solid var(--n-merged-border-color);
 `)])])])]),Wn(T("table",`
 background-color: var(--n-td-color-modal);
 --n-merged-border-color: var(--n-border-color-modal);
 `,[K("th",`
 background-color: var(--n-th-color-modal);
 `),K("td",`
 background-color: var(--n-td-color-modal);
 `)])),qn(T("table",`
 background-color: var(--n-td-color-popover);
 --n-merged-border-color: var(--n-border-color-popover);
 `,[K("th",`
 background-color: var(--n-th-color-popover);
 `),K("td",`
 background-color: var(--n-td-color-popover);
 `)]))]),Wo=Object.assign(Object.assign({},ze.props),{bordered:{type:Boolean,default:!0},bottomBordered:{type:Boolean,default:!0},singleLine:{type:Boolean,default:!0},striped:Boolean,singleColumn:Boolean,size:{type:String,default:"medium"}}),en=M({name:"Table",props:Wo,setup(e){const{mergedClsPrefixRef:t,inlineThemeDisabled:c,mergedRtlRef:u}=ot(e),r=ze("Table","-table",Vo,Uo,e,t),o=rt("Table",u,t),g=A(()=>{const{size:d}=e,{self:{borderColor:a,tdColor:s,tdColorModal:l,tdColorPopover:h,thColor:v,thColorModal:N,thColorPopover:R,thTextColor:k,tdTextColor:m,borderRadius:D,thFontWeight:P,lineHeight:E,borderColorModal:H,borderColorPopover:J,tdColorStriped:he,tdColorStripedModal:de,tdColorStripedPopover:be,[ut("fontSize",d)]:ge,[ut("tdPadding",d)]:Ne,[ut("thPadding",d)]:Se},common:{cubicBezierEaseInOut:Be}}=r.value;return{"--n-bezier":Be,"--n-td-color":s,"--n-td-color-modal":l,"--n-td-color-popover":h,"--n-td-text-color":m,"--n-border-color":a,"--n-border-color-modal":H,"--n-border-color-popover":J,"--n-border-radius":D,"--n-font-size":ge,"--n-th-color":v,"--n-th-color-modal":N,"--n-th-color-popover":R,"--n-th-font-weight":P,"--n-th-text-color":k,"--n-line-height":E,"--n-td-padding":Ne,"--n-th-padding":Se,"--n-td-color-striped":he,"--n-td-color-striped-modal":de,"--n-td-color-striped-popover":be}}),f=c?wt("table",A(()=>e.size[0]),g,e):void 0;return{rtlEnabled:o,mergedClsPrefix:t,cssVars:c?void 0:g,themeClass:f==null?void 0:f.themeClass,onRender:f==null?void 0:f.onRender}},render(){var e;const{mergedClsPrefix:t}=this;return(e=this.onRender)===null||e===void 0||e.call(this),y("table",{class:[`${t}-table`,this.themeClass,{[`${t}-table--rtl`]:this.rtlEnabled,[`${t}-table--bottom-bordered`]:this.bottomBordered,[`${t}-table--bordered`]:this.bordered,[`${t}-table--single-line`]:this.singleLine,[`${t}-table--single-column`]:this.singleColumn,[`${t}-table--striped`]:this.striped}],style:this.cssVars},this.$slots)}}),pe=M({name:"Th",render(){return y("th",null,this.$slots)}}),Xe=M({name:"Tr",render(){return y("tr",null,this.$slots)}}),fe=M({name:"Td",render(){return y("td",null,this.$slots)}}),qo=M({name:"Thead",render(){return y("thead",null,this.$slots)}}),tn=M({name:"Tbody",render(){return y("tbody",null,this.$slots)}}),nn=Ct("n-tree-select"),Ye=Ct("n-tree"),Xo=M({name:"NTreeSwitcher",props:{clsPrefix:{type:String,required:!0},indent:{type:Number,required:!0},expanded:Boolean,selected:Boolean,hide:Boolean,loading:Boolean,onClick:Function,tmNode:{type:Object,required:!0}},setup(e){const{renderSwitcherIconRef:t}=Ke(Ye,null);return()=>{const{clsPrefix:c,expanded:u,hide:r,indent:o,onClick:g}=e;return y("span",{"data-switcher":!0,class:[`${c}-tree-node-switcher`,u&&`${c}-tree-node-switcher--expanded`,r&&`${c}-tree-node-switcher--hide`],style:{width:`${o}px`},onClick:g},y("div",{class:`${c}-tree-node-switcher__icon`},y(Xn,null,{default:()=>{if(e.loading)return y(Yn,{clsPrefix:c,key:"loading",radius:85,strokeWidth:20});const{value:f}=t;return f?f({expanded:e.expanded,selected:e.selected,option:e.tmNode.rawNode}):y(Xt,{clsPrefix:c,key:"switcher"},{default:()=>y(Ko,null)})}})))}}}),Yo=M({name:"NTreeNodeCheckbox",props:{clsPrefix:{type:String,required:!0},indent:{type:Number,required:!0},right:Boolean,focusable:Boolean,disabled:Boolean,checked:Boolean,indeterminate:Boolean,onCheck:Function},setup(e){const t=Ke(Ye);function c(r){const{onCheck:o}=e;o&&o(r)}function u(r){c(r)}return{handleUpdateValue:u,mergedTheme:t.mergedThemeRef}},render(){const{clsPrefix:e,mergedTheme:t,checked:c,indeterminate:u,disabled:r,focusable:o,indent:g,handleUpdateValue:f}=this;return y("span",{class:[`${e}-tree-node-checkbox`,this.right&&`${e}-tree-node-checkbox--right`],style:{width:`${g}px`},"data-checkbox":!0},y(uo,{focusable:o,disabled:r,theme:t.peers.Checkbox,themeOverrides:t.peerOverrides.Checkbox,checked:c,indeterminate:u,onUpdateChecked:f}))}}),Go=M({name:"TreeNodeContent",props:{clsPrefix:{type:String,required:!0},disabled:Boolean,checked:Boolean,selected:Boolean,onClick:Function,onDragstart:Function,tmNode:{type:Object,required:!0},nodeProps:Object},setup(e){const{renderLabelRef:t,renderPrefixRef:c,renderSuffixRef:u,labelFieldRef:r}=Ke(Ye),o=j(null);function g(d){const{onClick:a}=e;a&&a(d)}function f(d){g(d)}return{selfRef:o,renderLabel:t,renderPrefix:c,renderSuffix:u,labelField:r,handleClick:f}},render(){const{clsPrefix:e,labelField:t,nodeProps:c,checked:u=!1,selected:r=!1,renderLabel:o,renderPrefix:g,renderSuffix:f,handleClick:d,onDragstart:a,tmNode:{rawNode:s,rawNode:{prefix:l,suffix:h,[t]:v}}}=this;return y("span",Object.assign({},c,{ref:"selfRef",class:[`${e}-tree-node-content`,c==null?void 0:c.class],onClick:d,draggable:a===void 0?void 0:!0,onDragstart:a}),g||l?y("div",{class:`${e}-tree-node-content__prefix`},g?g({option:s,selected:r,checked:u}):ft(l)):null,y("div",{class:`${e}-tree-node-content__text`},o?o({option:s,selected:r,checked:u}):ft(v)),f||h?y("div",{class:`${e}-tree-node-content__suffix`},f?f({option:s,selected:r,checked:u}):ft(h)):null)}});function Ht({position:e,offsetLevel:t,indent:c,el:u}){const r={position:"absolute",boxSizing:"border-box",right:0};if(e==="inside")r.left=0,r.top=0,r.bottom=0,r.borderRadius="inherit",r.boxShadow="inset 0 0 0 2px var(--n-drop-mark-color)";else{const o=e==="before"?"top":"bottom";r[o]=0,r.left=`${u.offsetLeft+6-t*c}px`,r.height="2px",r.backgroundColor="var(--n-drop-mark-color)",r.transformOrigin=o,r.borderRadius="1px",r.transform=e==="before"?"translateY(-4px)":"translateY(4px)"}return y("div",{style:r})}function Jo({dropPosition:e,node:t}){return t.isLeaf===!1||t.children?!0:e!=="inside"}function Zo(e){return A(()=>e.leafOnly?"child":e.checkStrategy)}function we(e,t){return!!e.rawNode[t]}function on(e,t,c,u){e==null||e.forEach(r=>{c(r),on(r[t],t,c,u),u(r)})}function Qo(e,t,c,u,r){const o=new Set,g=new Set,f=[];return on(e,u,d=>{if(f.push(d),r(t,d)){g.add(d[c]);for(let a=f.length-2;a>=0;--a)if(!o.has(f[a][c]))o.add(f[a][c]);else return}},()=>{f.pop()}),{expandedKeys:Array.from(o),highlightKeySet:g}}if(Gn&&Image){const e=new Image;e.src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw=="}function er(e,t,c,u,r){const o=new Set,g=new Set,f=new Set,d=[],a=[],s=[];function l(v){v.forEach(N=>{if(s.push(N),t(c,N)){o.add(N[u]),f.add(N[u]);for(let k=s.length-2;k>=0;--k){const m=s[k][u];if(!g.has(m))g.add(m),o.has(m)&&o.delete(m);else break}}const R=N[r];R&&l(R),s.pop()})}l(e);function h(v,N){v.forEach(R=>{const k=R[u],m=o.has(k),D=g.has(k);if(!m&&!D)return;const P=R[r];if(P)if(m)N.push(R);else{d.push(k);const E=Object.assign(Object.assign({},R),{[r]:[]});N.push(E),h(P,E[r])}else N.push(R)})}return h(e,a),{filteredTree:a,highlightKeySet:f,expandedKeys:d}}const tr=M({name:"TreeNode",props:{clsPrefix:{type:String,required:!0},tmNode:{type:Object,required:!0}},setup(e){const t=Ke(Ye),{droppingNodeParentRef:c,droppingMouseNodeRef:u,draggingNodeRef:r,droppingPositionRef:o,droppingOffsetLevelRef:g,nodePropsRef:f,indentRef:d,blockLineRef:a,checkboxPlacementRef:s,checkOnClickRef:l,disabledFieldRef:h,showLineRef:v}=t,N=G(()=>!!e.tmNode.rawNode.checkboxDisabled),R=G(()=>we(e.tmNode,h.value)),k=G(()=>t.disabledRef.value||R.value),m=A(()=>{const{value:x}=f;if(x)return x({option:e.tmNode.rawNode})}),D=j(null),P={value:null};Jn(()=>{P.value=D.value.$el});function E(){const{tmNode:x}=e;if(!x.isLeaf&&!x.shallowLoaded){if(!t.loadingKeysRef.value.has(x.key))t.loadingKeysRef.value.add(x.key);else return;const{onLoadRef:{value:$}}=t;$&&$(x.rawNode).then(z=>{z!==!1&&t.handleSwitcherClick(x)}).finally(()=>{t.loadingKeysRef.value.delete(x.key)})}else t.handleSwitcherClick(x)}const H=G(()=>!R.value&&t.selectableRef.value&&(t.internalTreeSelect?t.mergedCheckStrategyRef.value!=="child"||t.multipleRef.value&&t.cascadeRef.value||e.tmNode.isLeaf:!0)),J=G(()=>t.checkableRef.value&&(t.cascadeRef.value||t.mergedCheckStrategyRef.value!=="child"||e.tmNode.isLeaf)),he=G(()=>t.displayedCheckedKeysRef.value.includes(e.tmNode.key)),de=G(()=>{const{value:x}=J;if(!x)return!1;const{value:$}=l,{tmNode:z}=e;return typeof $=="boolean"?!z.disabled&&$:$(e.tmNode.rawNode)});function be(x){const{value:$}=t.expandOnClickRef,{value:z}=H,{value:Q}=de;if(!z&&!$&&!Q||Ot(x,"checkbox")||Ot(x,"switcher"))return;const{tmNode:Ge}=e;z&&t.handleSelect(Ge),$&&!Ge.isLeaf&&E(),Q&&Se(!he.value)}function ge(x){var $,z;a.value||(k.value||be(x),(z=($=m.value)===null||$===void 0?void 0:$.onClick)===null||z===void 0||z.call($,x))}function Ne(x){var $,z;a.value&&(k.value||be(x),(z=($=m.value)===null||$===void 0?void 0:$.onClick)===null||z===void 0||z.call($,x))}function Se(x){t.handleCheck(e.tmNode,x)}function Be(x){t.handleDragStart({event:x,node:e.tmNode})}function re(x){x.currentTarget===x.target&&t.handleDragEnter({event:x,node:e.tmNode})}function me(x){x.preventDefault(),t.handleDragOver({event:x,node:e.tmNode})}function ye(x){t.handleDragEnd({event:x,node:e.tmNode})}function lt(x){x.currentTarget===x.target&&t.handleDragLeave({event:x,node:e.tmNode})}function se(x){x.preventDefault(),o.value!==null&&t.handleDrop({event:x,node:e.tmNode,dropPosition:o.value})}const xe=A(()=>{const{clsPrefix:x}=e,{value:$}=d;if(v.value){const z=[];let Q=e.tmNode.parent;for(;Q;)Q.isLastChild?z.push(y("div",{class:`${x}-tree-node-indent`},y("div",{style:{width:`${$}px`}}))):z.push(y("div",{class:[`${x}-tree-node-indent`,`${x}-tree-node-indent--show-line`]},y("div",{style:{width:`${$}px`}}))),Q=Q.parent;return z.reverse()}else return Zn(e.tmNode.level,y("div",{class:`${e.clsPrefix}-tree-node-indent`},y("div",{style:{width:`${$}px`}})))});return{showDropMark:G(()=>{const{value:x}=r;if(!x)return;const{value:$}=o;if(!$)return;const{value:z}=u;if(!z)return;const{tmNode:Q}=e;return Q.key===z.key}),showDropMarkAsParent:G(()=>{const{value:x}=c;if(!x)return!1;const{tmNode:$}=e,{value:z}=o;return z==="before"||z==="after"?x.key===$.key:!1}),pending:G(()=>t.pendingNodeKeyRef.value===e.tmNode.key),loading:G(()=>t.loadingKeysRef.value.has(e.tmNode.key)),highlight:G(()=>{var x;return(x=t.highlightKeySetRef.value)===null||x===void 0?void 0:x.has(e.tmNode.key)}),checked:he,indeterminate:G(()=>t.displayedIndeterminateKeysRef.value.includes(e.tmNode.key)),selected:G(()=>t.mergedSelectedKeysRef.value.includes(e.tmNode.key)),expanded:G(()=>t.mergedExpandedKeysRef.value.includes(e.tmNode.key)),disabled:k,checkable:J,mergedCheckOnClick:de,checkboxDisabled:N,selectable:H,expandOnClick:t.expandOnClickRef,internalScrollable:t.internalScrollableRef,draggable:t.draggableRef,blockLine:a,nodeProps:m,checkboxFocusable:t.internalCheckboxFocusableRef,droppingPosition:o,droppingOffsetLevel:g,indent:d,checkboxPlacement:s,showLine:v,contentInstRef:D,contentElRef:P,indentNodes:xe,handleCheck:Se,handleDrop:se,handleDragStart:Be,handleDragEnter:re,handleDragOver:me,handleDragEnd:ye,handleDragLeave:lt,handleLineClick:Ne,handleContentClick:ge,handleSwitcherClick:E}},render(){const{tmNode:e,clsPrefix:t,checkable:c,expandOnClick:u,selectable:r,selected:o,checked:g,highlight:f,draggable:d,blockLine:a,indent:s,indentNodes:l,disabled:h,pending:v,internalScrollable:N,nodeProps:R,checkboxPlacement:k}=this,m=d&&!h?{onDragenter:this.handleDragEnter,onDragleave:this.handleDragLeave,onDragend:this.handleDragEnd,onDrop:this.handleDrop,onDragover:this.handleDragOver}:void 0,D=N?Zt(e.key):void 0,P=k==="right",E=c?y(Yo,{indent:s,right:P,focusable:this.checkboxFocusable,disabled:h||this.checkboxDisabled,clsPrefix:t,checked:this.checked,indeterminate:this.indeterminate,onCheck:this.handleCheck}):null;return y("div",Object.assign({class:`${t}-tree-node-wrapper`},m),y("div",Object.assign({},a?R:void 0,{class:[`${t}-tree-node`,{[`${t}-tree-node--selected`]:o,[`${t}-tree-node--checkable`]:c,[`${t}-tree-node--highlight`]:f,[`${t}-tree-node--pending`]:v,[`${t}-tree-node--disabled`]:h,[`${t}-tree-node--selectable`]:r,[`${t}-tree-node--clickable`]:r||u||this.mergedCheckOnClick},R==null?void 0:R.class],"data-key":D,draggable:d&&a,onClick:this.handleLineClick,onDragstart:d&&a&&!h?this.handleDragStart:void 0}),l,e.isLeaf&&this.showLine?y("div",{class:[`${t}-tree-node-indent`,`${t}-tree-node-indent--show-line`,e.isLeaf&&`${t}-tree-node-indent--is-leaf`,e.isLastChild&&`${t}-tree-node-indent--last-child`]},y("div",{style:{width:`${s}px`}})):y(Xo,{clsPrefix:t,expanded:this.expanded,selected:o,loading:this.loading,hide:e.isLeaf,tmNode:this.tmNode,indent:s,onClick:this.handleSwitcherClick}),P?null:E,y(Go,{ref:"contentInstRef",clsPrefix:t,checked:g,selected:o,onClick:this.handleContentClick,nodeProps:a?void 0:R,onDragstart:d&&!a&&!h?this.handleDragStart:void 0,tmNode:e}),d?this.showDropMark?Ht({el:this.contentElRef.value,position:this.droppingPosition,offsetLevel:this.droppingOffsetLevel,indent:s}):this.showDropMarkAsParent?Ht({el:this.contentElRef.value,position:"inside",offsetLevel:this.droppingOffsetLevel,indent:s}):null:null,P?E:null))}}),rn=tr;function nr({props:e,fNodesRef:t,mergedExpandedKeysRef:c,mergedSelectedKeysRef:u,handleSelect:r,handleSwitcherClick:o}){const{value:g}=u,f=Ke(nn,null),d=f?f.pendingNodeKeyRef:j(g.length?g[g.length-1]:null);function a(s){if(!e.keyboard)return;const{value:l}=d;if(l===null){if((s.key==="ArrowDown"||s.key==="ArrowUp")&&s.preventDefault(),["ArrowDown","ArrowUp","ArrowLeft","ArrowRight"].includes(s.key)&&l===null){const{value:h}=t;let v=0;for(;v<h.length;){if(!h[v].disabled){d.value=h[v].key;break}v+=1}}}else{const{value:h}=t;let v=h.findIndex(N=>N.key===l);if(!~v)return;if(s.key==="Enter")r(h[v]);else if(s.key==="ArrowDown")for(s.preventDefault(),v+=1;v<h.length;){if(!h[v].disabled){d.value=h[v].key;break}v+=1}else if(s.key==="ArrowUp")for(s.preventDefault(),v-=1;v>=0;){if(!h[v].disabled){d.value=h[v].key;break}v-=1}else if(s.key==="ArrowLeft"){const N=h[v];if(N.isLeaf||!c.value.includes(l)){const R=N.getParent();R&&(d.value=R.key)}else o(N)}else if(s.key==="ArrowRight"){const N=h[v];if(N.isLeaf)return;if(!c.value.includes(l))o(N);else for(v+=1;v<h.length;){if(!h[v].disabled){d.value=h[v].key;break}v+=1}}}}return{pendingNodeKeyRef:d,handleKeydown:a}}const or=M({name:"TreeMotionWrapper",props:{clsPrefix:{type:String,required:!0},height:Number,nodes:{type:Array,required:!0},mode:{type:String,required:!0},onAfterEnter:{type:Function,required:!0}},render(){const{clsPrefix:e}=this;return y(qt,{onAfterEnter:this.onAfterEnter,appear:!0,reverse:this.mode==="collapse"},{default:()=>y("div",{class:[`${e}-tree-motion-wrapper`,`${e}-tree-motion-wrapper--${this.mode}`],style:{height:Yt(this.height)}},this.nodes.map(t=>y(rn,{clsPrefix:e,tmNode:t})))})}}),vt=Qn(),rr=T("tree",`
 font-size: var(--n-font-size);
 outline: none;
`,[K("ul, li",`
 margin: 0;
 padding: 0;
 list-style: none;
 `),K(">",[T("tree-node",[K("&:first-child","margin-top: 0;")])]),T("tree-motion-wrapper",[F("expand",[pt({duration:"0.2s"})]),F("collapse",[pt({duration:"0.2s",reverse:!0})])]),T("tree-node-wrapper",`
 box-sizing: border-box;
 padding: var(--n-node-wrapper-padding);
 `),T("tree-node",`
 transform: translate3d(0,0,0);
 position: relative;
 display: flex;
 border-radius: var(--n-node-border-radius);
 transition: background-color .3s var(--n-bezier);
 `,[F("highlight",[T("tree-node-content",[Y("text","border-bottom-color: var(--n-node-text-color-disabled);")])]),F("disabled",[T("tree-node-content",`
 color: var(--n-node-text-color-disabled);
 cursor: not-allowed;
 `)]),_e("disabled",[F("clickable",[T("tree-node-content",`
 cursor: pointer;
 `)])])]),F("block-node",[T("tree-node-content",`
 flex: 1;
 min-width: 0;
 `)]),_e("block-line",[T("tree-node",[_e("disabled",[T("tree-node-content",[K("&:hover","background: var(--n-node-color-hover);")]),F("selectable",[T("tree-node-content",[K("&:active","background: var(--n-node-color-pressed);")])]),F("pending",[T("tree-node-content",`
 background: var(--n-node-color-hover);
 `)]),F("selected",[T("tree-node-content","background: var(--n-node-color-active);")])])])]),F("block-line",[T("tree-node",[_e("disabled",[K("&:hover","background: var(--n-node-color-hover);"),F("pending",`
 background: var(--n-node-color-hover);
 `),F("selectable",[_e("selected",[K("&:active","background: var(--n-node-color-pressed);")])]),F("selected","background: var(--n-node-color-active);")]),F("disabled",`
 cursor: not-allowed;
 `)])]),T("tree-node-indent",`
 flex-grow: 0;
 flex-shrink: 0;
 `,[F("show-line","position: relative",[K("&::before",`
 position: absolute;
 left: 50%;
 border-left: 1px solid var(--n-border-color);
 transition: border-color .3s var(--n-bezier);
 transform: translate(-50%);
 content: "";
 top: var(--n-line-offset-top);
 bottom: var(--n-line-offset-bottom);
 `),F("last-child",[K("&::before",`
 bottom: 50%;
 `)]),F("is-leaf",[K("&::after",`
 position: absolute;
 content: "";
 left: calc(50% + 0.5px);
 right: 0;
 bottom: 50%;
 transition: border-color .3s var(--n-bezier);
 border-bottom: 1px solid var(--n-border-color);
 `)])]),_e("show-line","height: 0;")]),T("tree-node-switcher",`
 cursor: pointer;
 display: inline-flex;
 flex-shrink: 0;
 height: var(--n-node-content-height);
 align-items: center;
 justify-content: center;
 transition: transform .15s var(--n-bezier);
 vertical-align: bottom;
 `,[Y("icon",`
 position: relative;
 height: 14px;
 width: 14px;
 display: flex;
 color: var(--n-arrow-color);
 transition: color .3s var(--n-bezier);
 font-size: 14px;
 `,[T("icon",[vt]),T("base-loading",`
 color: var(--n-loading-color);
 position: absolute;
 left: 0;
 top: 0;
 right: 0;
 bottom: 0;
 `,[vt]),T("base-icon",[vt])]),F("hide","visibility: hidden;"),F("expanded","transform: rotate(90deg);")]),T("tree-node-checkbox",`
 display: inline-flex;
 height: var(--n-node-content-height);
 vertical-align: bottom;
 align-items: center;
 justify-content: center;
 `),T("tree-node-content",`
 user-select: none;
 position: relative;
 display: inline-flex;
 align-items: center;
 min-height: var(--n-node-content-height);
 box-sizing: border-box;
 line-height: var(--n-line-height);
 vertical-align: bottom;
 padding: 0 6px 0 4px;
 cursor: default;
 border-radius: var(--n-node-border-radius);
 color: var(--n-node-text-color);
 transition:
 color .3s var(--n-bezier),
 background-color .3s var(--n-bezier),
 border-color .3s var(--n-bezier);
 `,[K("&:last-child","margin-bottom: 0;"),Y("prefix",`
 display: inline-flex;
 margin-right: 8px;
 `),Y("text",`
 border-bottom: 1px solid #0000;
 transition: border-color .3s var(--n-bezier);
 flex-grow: 1;
 max-width: 100%;
 `),Y("suffix",`
 display: inline-flex;
 `)]),Y("empty","margin: auto;")]);var lr=globalThis&&globalThis.__awaiter||function(e,t,c,u){function r(o){return o instanceof c?o:new c(function(g){g(o)})}return new(c||(c=Promise))(function(o,g){function f(s){try{a(u.next(s))}catch(l){g(l)}}function d(s){try{a(u.throw(s))}catch(l){g(l)}}function a(s){s.done?o(s.value):r(s.value).then(f,d)}a((u=u.apply(e,t||[])).next())})};function ar(e,t,c,u){return{getIsGroup(){return!1},getKey(o){return o[e]},getChildren:u||(o=>o[t]),getDisabled(o){return!!(o[c]||o.checkboxDisabled)}}}const ir={allowCheckingNotLoaded:Boolean,filter:Function,defaultExpandAll:Boolean,expandedKeys:Array,keyField:{type:String,default:"key"},labelField:{type:String,default:"label"},childrenField:{type:String,default:"children"},disabledField:{type:String,default:"disabled"},defaultExpandedKeys:{type:Array,default:()=>[]},indeterminateKeys:Array,renderSwitcherIcon:Function,onUpdateIndeterminateKeys:[Function,Array],"onUpdate:indeterminateKeys":[Function,Array],onUpdateExpandedKeys:[Function,Array],"onUpdate:expandedKeys":[Function,Array]},dr=Object.assign(Object.assign(Object.assign(Object.assign({},ze.props),{accordion:Boolean,showIrrelevantNodes:{type:Boolean,default:!0},data:{type:Array,default:()=>[]},expandOnDragenter:{type:Boolean,default:!0},expandOnClick:Boolean,checkOnClick:{type:[Boolean,Function],default:!1},cancelable:{type:Boolean,default:!0},checkable:Boolean,draggable:Boolean,blockNode:Boolean,blockLine:Boolean,showLine:Boolean,disabled:Boolean,checkedKeys:Array,defaultCheckedKeys:{type:Array,default:()=>[]},selectedKeys:Array,defaultSelectedKeys:{type:Array,default:()=>[]},multiple:Boolean,pattern:{type:String,default:""},onLoad:Function,cascade:Boolean,selectable:{type:Boolean,default:!0},scrollbarProps:Object,indent:{type:Number,default:24},allowDrop:{type:Function,default:Jo},animated:{type:Boolean,default:!0},checkboxPlacement:{type:String,default:"left"},virtualScroll:Boolean,watchProps:Array,renderLabel:Function,renderPrefix:Function,renderSuffix:Function,nodeProps:Function,keyboard:{type:Boolean,default:!0},getChildren:Function,onDragenter:[Function,Array],onDragleave:[Function,Array],onDragend:[Function,Array],onDragstart:[Function,Array],onDragover:[Function,Array],onDrop:[Function,Array],onUpdateCheckedKeys:[Function,Array],"onUpdate:checkedKeys":[Function,Array],onUpdateSelectedKeys:[Function,Array],"onUpdate:selectedKeys":[Function,Array]}),ir),{internalTreeSelect:Boolean,internalScrollable:Boolean,internalScrollablePadding:String,internalRenderEmpty:Function,internalHighlightKeySet:Object,internalUnifySelectCheck:Boolean,internalCheckboxFocusable:{type:Boolean,default:!0},internalFocusable:{type:Boolean,default:!0},checkStrategy:{type:String,default:"all"},leafOnly:Boolean}),sr=M({name:"Tree",props:dr,setup(e){const{mergedClsPrefixRef:t,inlineThemeDisabled:c,mergedRtlRef:u}=ot(e),r=rt("Tree",u,t),o=ze("Tree","-tree",rr,jo,e,t),g=j(null),f=j(null),d=j(null);function a(){var n;return(n=d.value)===null||n===void 0?void 0:n.listElRef}function s(){var n;return(n=d.value)===null||n===void 0?void 0:n.itemsElRef}const l=A(()=>{const{filter:n}=e;if(n)return n;const{labelField:i}=e;return(p,S)=>{if(!p.length)return!0;const w=S[i];return typeof w=="string"?w.toLowerCase().includes(p.toLowerCase()):!1}}),h=A(()=>{const{pattern:n}=e;return n?!n.length||!l.value?{filteredTree:e.data,highlightKeySet:null,expandedKeys:void 0}:er(e.data,l.value,n,e.keyField,e.childrenField):{filteredTree:e.data,highlightKeySet:null,expandedKeys:void 0}}),v=A(()=>ho(e.showIrrelevantNodes?e.data:h.value.filteredTree,ar(e.keyField,e.childrenField,e.disabledField,e.getChildren))),N=Ke(nn,null),R=e.internalTreeSelect?N.dataTreeMate:v,{watchProps:k}=e,m=j([]);k!=null&&k.includes("defaultCheckedKeys")?Ce(()=>{m.value=e.defaultCheckedKeys}):m.value=e.defaultCheckedKeys;const D=O(e,"checkedKeys"),P=qe(D,m),E=A(()=>R.value.getCheckedKeys(P.value,{cascade:e.cascade,allowNotLoaded:e.allowCheckingNotLoaded})),H=Zo(e),J=A(()=>E.value.checkedKeys),he=A(()=>{const{indeterminateKeys:n}=e;return n!==void 0?n:E.value.indeterminateKeys}),de=j([]);k!=null&&k.includes("defaultSelectedKeys")?Ce(()=>{de.value=e.defaultSelectedKeys}):de.value=e.defaultSelectedKeys;const be=O(e,"selectedKeys"),ge=qe(be,de),Ne=j([]),Se=n=>{Ne.value=e.defaultExpandAll?R.value.getNonLeafKeys():n===void 0?e.defaultExpandedKeys:n};k!=null&&k.includes("defaultExpandedKeys")?Ce(()=>{Se(void 0)}):Ce(()=>{Se(e.defaultExpandedKeys)});const Be=O(e,"expandedKeys"),re=qe(Be,Ne),me=A(()=>v.value.getFlattenedNodes(re.value)),{pendingNodeKeyRef:ye,handleKeydown:lt}=nr({props:e,mergedSelectedKeysRef:ge,fNodesRef:me,mergedExpandedKeysRef:re,handleSelect:st,handleSwitcherClick:Kt});let se=null,xe=null;const x=j(new Set),$=A(()=>e.internalHighlightKeySet||h.value.highlightKeySet),z=qe($,x),Q=j(new Set),Ge=A(()=>re.value.filter(n=>!Q.value.has(n)));let Nt=0;const Ue=j(null),Je=j(null),Ze=j(null),Qe=j(null),et=j(0),an=A(()=>{const{value:n}=Je;return n?n.parent:null});We(O(e,"data"),()=>{Q.value.clear(),ye.value=null,He()},{deep:!1});let at=!1;const it=()=>{at=!0,nt(()=>{at=!1})};let Me;We(O(e,"pattern"),(n,i)=>{if(e.showIrrelevantNodes)if(Me=void 0,n){const{expandedKeys:p,highlightKeySet:S}=Qo(e.data,e.pattern,e.keyField,e.childrenField,l.value);x.value=S,it(),Te(p,ne(p),{node:null,action:"filter"})}else x.value=new Set;else if(!n.length)Me!==void 0&&(it(),Te(Me,ne(Me),{node:null,action:"filter"}));else{i.length||(Me=re.value);const{expandedKeys:p}=h.value;p!==void 0&&(it(),Te(p,ne(p),{node:null,action:"filter"}))}});function St(n){return lr(this,void 0,void 0,function*(){const{onLoad:i}=e;if(!i){yield Promise.resolve();return}const{value:p}=Q;if(!p.has(n.key)){p.add(n.key);try{(yield i(n.rawNode))===!1&&De()}catch(S){console.error(S),De()}p.delete(n.key)}})}Ce(()=>{var n;const{value:i}=v;if(!i)return;const{getNode:p}=i;(n=re.value)===null||n===void 0||n.forEach(S=>{const w=p(S);w&&!w.shallowLoaded&&St(w)})});const Pe=j(!1),ke=j([]);We(Ge,(n,i)=>{if(!e.animated||at){nt(tt);return}const p=Ve(o.value.self.nodeHeight),S=new Set(i);let w=null,U=null;for(const I of n)if(!S.has(I)){if(w!==null)return;w=I}const ee=new Set(n);for(const I of i)if(!ee.has(I)){if(U!==null)return;U=I}if(w===null&&U===null)return;const{virtualScroll:oe}=e,Le=(oe?d.value.listElRef:g.value).offsetHeight,Ee=Math.ceil(Le/p)+1;let le;if(w!==null&&(le=i),U!==null&&(le===void 0?le=n:le=le.filter(I=>I!==U)),Pe.value=!0,ke.value=v.value.getFlattenedNodes(le),w!==null){const I=ke.value.findIndex(ae=>ae.key===w);if(~I){const ae=ke.value[I].children;if(ae){const ce=zt(ae,n);ke.value.splice(I+1,0,{__motion:!0,mode:"expand",height:oe?ce.length*p:void 0,nodes:oe?ce.slice(0,Ee):ce})}}}if(U!==null){const I=ke.value.findIndex(ae=>ae.key===U);if(~I){const ae=ke.value[I].children;if(!ae)return;Pe.value=!0;const ce=zt(ae,n);ke.value.splice(I+1,0,{__motion:!0,mode:"collapse",height:oe?ce.length*p:void 0,nodes:oe?ce.slice(0,Ee):ce})}}});const dn=A(()=>go(me.value)),sn=A(()=>Pe.value?ke.value:me.value);function tt(){const{value:n}=f;n&&n.sync()}function cn(){Pe.value=!1,e.virtualScroll&&nt(tt)}function ne(n){const{getNode:i}=R.value;return n.map(p=>{var S;return((S=i(p))===null||S===void 0?void 0:S.rawNode)||null})}function Te(n,i,p){const{"onUpdate:expandedKeys":S,onUpdateExpandedKeys:w}=e;Ne.value=n,S&&V(S,n,i,p),w&&V(w,n,i,p)}function Rt(n,i,p){const{"onUpdate:checkedKeys":S,onUpdateCheckedKeys:w}=e;m.value=n,w&&V(w,n,i,p),S&&V(S,n,i,p)}function un(n,i){const{"onUpdate:indeterminateKeys":p,onUpdateIndeterminateKeys:S}=e;p&&V(p,n,i),S&&V(S,n,i)}function dt(n,i,p){const{"onUpdate:selectedKeys":S,onUpdateSelectedKeys:w}=e;de.value=n,w&&V(w,n,i,p),S&&V(S,n,i,p)}function fn(n){const{onDragenter:i}=e;i&&V(i,n)}function hn(n){const{onDragleave:i}=e;i&&V(i,n)}function gn(n){const{onDragend:i}=e;i&&V(i,n)}function vn(n){const{onDragstart:i}=e;i&&V(i,n)}function pn(n){const{onDragover:i}=e;i&&V(i,n)}function bn(n){const{onDrop:i}=e;i&&V(i,n)}function He(){mn(),Re()}function mn(){Ue.value=null}function Re(){et.value=0,Je.value=null,Ze.value=null,Qe.value=null,De()}function De(){se&&(window.clearTimeout(se),se=null),xe=null}function _t(n,i){if(e.disabled||we(n,e.disabledField))return;if(e.internalUnifySelectCheck&&!e.multiple){st(n);return}const p=i?"check":"uncheck",{checkedKeys:S,indeterminateKeys:w}=R.value[p](n.key,J.value,{cascade:e.cascade,checkStrategy:H.value,allowNotLoaded:e.allowCheckingNotLoaded});Rt(S,ne(S),{node:n.rawNode,action:p}),un(w,ne(w))}function yn(n){if(e.disabled)return;const{key:i}=n,{value:p}=re,S=p.findIndex(w=>w===i);if(~S){const w=Array.from(p);w.splice(S,1),Te(w,ne(w),{node:n.rawNode,action:"collapse"})}else{const w=v.value.getNode(i);if(!w||w.isLeaf)return;let U;if(e.accordion){const ee=new Set(n.siblings.map(({key:oe})=>oe));U=p.filter(oe=>!ee.has(oe)),U.push(i)}else U=p.concat(i);Te(U,ne(U),{node:n.rawNode,action:"expand"})}}function Kt(n){e.disabled||Pe.value||yn(n)}function st(n){if(!(e.disabled||!e.selectable)){if(ye.value=n.key,e.internalUnifySelectCheck){const{value:{checkedKeys:i,indeterminateKeys:p}}=E;e.multiple?_t(n,!(i.includes(n.key)||p.includes(n.key))):Rt([n.key],ne([n.key]),{node:n.rawNode,action:"check"})}if(e.multiple){const i=Array.from(ge.value),p=i.findIndex(S=>S===n.key);~p?e.cancelable&&i.splice(p,1):~p||i.push(n.key),dt(i,ne(i),{node:n.rawNode,action:~p?"unselect":"select"})}else ge.value.includes(n.key)?e.cancelable&&dt([],[],{node:n.rawNode,action:"unselect"}):dt([n.key],ne([n.key]),{node:n.rawNode,action:"select"})}}function xn(n){if(se&&(window.clearTimeout(se),se=null),n.isLeaf)return;xe=n.key;const i=()=>{if(xe!==n.key)return;const{value:p}=Ze;if(p&&p.key===n.key&&!re.value.includes(n.key)){const S=re.value.concat(n.key);Te(S,ne(S),{node:n.rawNode,action:"expand"})}se=null,xe=null};n.shallowLoaded?se=window.setTimeout(()=>{i()},1e3):se=window.setTimeout(()=>{St(n).then(()=>{i()})},1e3)}function kn({event:n,node:i}){!e.draggable||e.disabled||we(i,e.disabledField)||(Pt({event:n,node:i},!1),fn({event:n,node:i.rawNode}))}function wn({event:n,node:i}){!e.draggable||e.disabled||we(i,e.disabledField)||hn({event:n,node:i.rawNode})}function Cn(n){n.target===n.currentTarget&&Re()}function Nn({event:n,node:i}){He(),!(!e.draggable||e.disabled||we(i,e.disabledField))&&gn({event:n,node:i.rawNode})}function Sn({event:n,node:i}){!e.draggable||e.disabled||we(i,e.disabledField)||(Nt=n.clientX,Ue.value=i,vn({event:n,node:i.rawNode}))}function Pt({event:n,node:i},p=!0){var S;if(!e.draggable||e.disabled||we(i,e.disabledField))return;const{value:w}=Ue;if(!w)return;const{allowDrop:U,indent:ee}=e;p&&pn({event:n,node:i.rawNode});const oe=n.currentTarget,{height:Le,top:Ee}=oe.getBoundingClientRect(),le=n.clientY-Ee;let I;U({node:i.rawNode,dropPosition:"inside",phase:"drag"})?le<=8?I="before":le>=Le-8?I="after":I="inside":le<=Le/2?I="before":I="after";const{value:ce}=dn;let L,X;const je=ce(i.key);if(je===null){Re();return}let Dt=!1;I==="inside"?(L=i,X="inside"):I==="before"?i.isFirstChild?(L=i,X="before"):(L=me.value[je-1],X="after"):(L=i,X="after"),!L.isLeaf&&re.value.includes(L.key)&&(Dt=!0,X==="after"&&(L=me.value[je+1],L?X="before":(L=i,X="inside")));const $t=L;if(Ze.value=$t,!Dt&&w.isLastChild&&w.key===L.key&&(X="after"),X==="after"){let Lt=Nt-n.clientX,ct=0;for(;Lt>=ee/2&&L.parent!==null&&L.isLastChild&&ct<1;)Lt-=ee,ct+=1,L=L.parent;et.value=ct}else et.value=0;if((w.contains(L)||X==="inside"&&((S=w.parent)===null||S===void 0?void 0:S.key)===L.key)&&!(w.key===$t.key&&w.key===L.key)){Re();return}if(!U({node:L.rawNode,dropPosition:X,phase:"drag"})){Re();return}if(w.key===L.key)De();else if(xe!==L.key)if(X==="inside"){if(e.expandOnDragenter){if(xn(L),!L.shallowLoaded&&xe!==L.key){He();return}}else if(!L.shallowLoaded){He();return}}else De();else X!=="inside"&&De();Qe.value=X,Je.value=L}function Rn({event:n,node:i,dropPosition:p}){if(!e.draggable||e.disabled||we(i,e.disabledField))return;const{value:S}=Ue,{value:w}=Je,{value:U}=Qe;if(!(!S||!w||!U)&&e.allowDrop({node:w.rawNode,dropPosition:U,phase:"drag"})&&S.key!==w.key){if(U==="before"){const ee=S.getNext({includeDisabled:!0});if(ee&&ee.key===w.key){Re();return}}if(U==="after"){const ee=S.getPrev({includeDisabled:!0});if(ee&&ee.key===w.key){Re();return}}bn({event:n,node:w.rawNode,dragNode:S.rawNode,dropPosition:p}),He()}}function _n(){tt()}function Kn(){tt()}function Pn(n){var i;if(e.virtualScroll||e.internalScrollable){const{value:p}=f;if(!((i=p==null?void 0:p.containerRef)===null||i===void 0)&&i.contains(n.relatedTarget))return;ye.value=null}else{const{value:p}=g;if(p!=null&&p.contains(n.relatedTarget))return;ye.value=null}}We(ye,n=>{var i,p;if(n!==null){if(e.virtualScroll)(i=d.value)===null||i===void 0||i.scrollTo({key:n});else if(e.internalScrollable){const{value:S}=f;if(S===null)return;const w=(p=S.contentRef)===null||p===void 0?void 0:p.querySelector(`[data-key="${Zt(n)}"]`);if(!w)return;S.scrollTo({el:w})}}}),jt(Ye,{loadingKeysRef:Q,highlightKeySetRef:z,displayedCheckedKeysRef:J,displayedIndeterminateKeysRef:he,mergedSelectedKeysRef:ge,mergedExpandedKeysRef:re,mergedThemeRef:o,mergedCheckStrategyRef:H,nodePropsRef:O(e,"nodeProps"),disabledRef:O(e,"disabled"),checkableRef:O(e,"checkable"),selectableRef:O(e,"selectable"),expandOnClickRef:O(e,"expandOnClick"),onLoadRef:O(e,"onLoad"),draggableRef:O(e,"draggable"),blockLineRef:O(e,"blockLine"),indentRef:O(e,"indent"),cascadeRef:O(e,"cascade"),checkOnClickRef:O(e,"checkOnClick"),checkboxPlacementRef:e.checkboxPlacement,droppingMouseNodeRef:Ze,droppingNodeParentRef:an,draggingNodeRef:Ue,droppingPositionRef:Qe,droppingOffsetLevelRef:et,fNodesRef:me,pendingNodeKeyRef:ye,showLineRef:O(e,"showLine"),disabledFieldRef:O(e,"disabledField"),internalScrollableRef:O(e,"internalScrollable"),internalCheckboxFocusableRef:O(e,"internalCheckboxFocusable"),internalTreeSelect:e.internalTreeSelect,renderLabelRef:O(e,"renderLabel"),renderPrefixRef:O(e,"renderPrefix"),renderSuffixRef:O(e,"renderSuffix"),renderSwitcherIconRef:O(e,"renderSwitcherIcon"),labelFieldRef:O(e,"labelField"),multipleRef:O(e,"multiple"),handleSwitcherClick:Kt,handleDragEnd:Nn,handleDragEnter:kn,handleDragLeave:wn,handleDragStart:Sn,handleDrop:Rn,handleDragOver:Pt,handleSelect:st,handleCheck:_t});function Tn(n){var i;(i=d.value)===null||i===void 0||i.scrollTo(n)}const Dn={handleKeydown:lt,scrollTo:Tn,getCheckedData:()=>{if(!e.checkable)return{keys:[],options:[]};const{checkedKeys:n}=E.value;return{keys:n,options:ne(n)}},getIndeterminateData:()=>{if(!e.checkable)return{keys:[],options:[]};const{indeterminateKeys:n}=E.value;return{keys:n,options:ne(n)}}},Tt=A(()=>{const{common:{cubicBezierEaseInOut:n},self:{fontSize:i,nodeBorderRadius:p,nodeColorHover:S,nodeColorPressed:w,nodeColorActive:U,arrowColor:ee,loadingColor:oe,nodeTextColor:Le,nodeTextColorDisabled:Ee,dropMarkColor:le,nodeWrapperPadding:I,nodeHeight:ae,lineHeight:ce}}=o.value,L=ht(I,"top"),X=ht(I,"bottom"),je=Yt(Ve(ae)-Ve(L)-Ve(X));return{"--n-arrow-color":ee,"--n-loading-color":oe,"--n-bezier":n,"--n-font-size":i,"--n-node-border-radius":p,"--n-node-color-active":U,"--n-node-color-hover":S,"--n-node-color-pressed":w,"--n-node-text-color":Le,"--n-node-text-color-disabled":Ee,"--n-drop-mark-color":le,"--n-node-wrapper-padding":I,"--n-line-offset-top":`-${L}`,"--n-line-offset-bottom":`-${X}`,"--n-node-content-height":je,"--n-line-height":ce}}),$e=c?wt("tree",void 0,Tt,e):void 0;return Object.assign(Object.assign({},Dn),{mergedClsPrefix:t,mergedTheme:o,rtlEnabled:r,fNodes:sn,aip:Pe,selfElRef:g,virtualListInstRef:d,scrollbarInstRef:f,handleFocusout:Pn,handleDragLeaveTree:Cn,handleScroll:_n,getScrollContainer:a,getScrollContent:s,handleAfterEnter:cn,handleResize:Kn,cssVars:c?void 0:Tt,themeClass:$e==null?void 0:$e.themeClass,onRender:$e==null?void 0:$e.onRender})},render(){var e;const{fNodes:t,internalRenderEmpty:c}=this;if(!t.length&&c)return c();const{mergedClsPrefix:u,blockNode:r,blockLine:o,draggable:g,disabled:f,internalFocusable:d,checkable:a,handleKeydown:s,rtlEnabled:l,handleFocusout:h,scrollbarProps:v}=this,N=d&&!f,R=N?"0":void 0,k=[`${u}-tree`,l&&`${u}-tree--rtl`,a&&`${u}-tree--checkable`,(o||r)&&`${u}-tree--block-node`,o&&`${u}-tree--block-line`],m=P=>"__motion"in P?y(or,{height:P.height,nodes:P.nodes,clsPrefix:u,mode:P.mode,onAfterEnter:this.handleAfterEnter}):y(rn,{key:P.key,tmNode:P,clsPrefix:u});if(this.virtualScroll){const{mergedTheme:P,internalScrollablePadding:E}=this,H=ht(E||"0");return y(At,Object.assign({},v,{ref:"scrollbarInstRef",onDragleave:g?this.handleDragLeaveTree:void 0,container:this.getScrollContainer,content:this.getScrollContent,class:k,theme:P.peers.Scrollbar,themeOverrides:P.peerOverrides.Scrollbar,tabindex:R,onKeydown:N?s:void 0,onFocusout:N?h:void 0}),{default:()=>{var J;return(J=this.onRender)===null||J===void 0||J.call(this),y(fo,{ref:"virtualListInstRef",items:this.fNodes,itemSize:Ve(P.self.nodeHeight),ignoreItemResize:this.aip,paddingTop:H.top,paddingBottom:H.bottom,class:this.themeClass,style:[this.cssVars,{paddingLeft:H.left,paddingRight:H.right}],onScroll:this.handleScroll,onResize:this.handleResize,showScrollbar:!1,itemResizable:!0},{default:({item:he})=>m(he)})}})}const{internalScrollable:D}=this;return k.push(this.themeClass),(e=this.onRender)===null||e===void 0||e.call(this),D?y(At,Object.assign({},v,{class:k,tabindex:R,onKeydown:N?s:void 0,onFocusout:N?h:void 0,style:this.cssVars,contentStyle:{padding:this.internalScrollablePadding}}),{default:()=>y("div",{onDragleave:g?this.handleDragLeaveTree:void 0,ref:"selfElRef"},this.fNodes.map(m))}):y("div",{class:k,tabindex:R,ref:"selfElRef",style:this.cssVars,onKeydown:N?s:void 0,onFocusout:N?h:void 0,onDragleave:g?this.handleDragLeaveTree:void 0},t.length?t.map(m):eo(this.$slots.empty,()=>[y(vo,{class:`${u}-tree__empty`,theme:this.mergedTheme.peers.Empty,themeOverrides:this.mergedTheme.peerOverrides.Empty})]))}}),ln=M({__name:"DraggableCard",props:{initialValue:{default:()=>({})}},setup(e){const t=e,c=t.initialValue.left!==void 0,u=t.initialValue.top!==void 0,r={x:(c?t.initialValue.left:t.initialValue.right)??0,y:(u?t.initialValue.top:t.initialValue.bottom)??0},o=Gt({...r}),g=A(()=>{const m=c?`left:${o.x}px;`:`right:${o.x}px;`,D=u?`top:${o.y}px;`:`bottom:${o.y}px;`;return m+D});let f;const d=m=>{f=m,r.x=o.x,r.y=o.y},a=m=>{if(!h.value||!f)return;const D=m.clientX-f.clientX,P=m.clientY-f.clientY;o.x=r.x+(c?D:-D),o.y=r.y+(u?P:-P)},s=()=>{f=void 0},l=Z(),h=Z(),v=m=>{f&&m.preventDefault()},N=["transition-top,bottom,left,right-500"],R=()=>{if(!h.value)return;const{top:m,bottom:D,left:P,right:E}=h.value.getBoundingClientRect();if(E<0||P>window.innerWidth||D<0||m>window.innerHeight){o.x=r.x,o.y=r.y,s();const H=l.value;H&&(H.classList.add(...N),setTimeout(()=>{H.classList.remove(...N)},550))}};window.addEventListener("pointermove",a),window.addEventListener("pointerup",R),document.addEventListener("selectstart",v),It(()=>{window.removeEventListener("pointermove",a),window.removeEventListener("pointerup",R),document.removeEventListener("selectstart",v),s()}),We(h,(m,D)=>{m&&(m.addEventListener("pointerdown",d),m.addEventListener("pointerup",s)),D&&(D.removeEventListener("pointerdown",d),D.removeEventListener("pointerup",s))}),It(()=>{h.value&&(h.value.removeEventListener("pointerdown",d),h.value.removeEventListener("pointerup",s))});const k=m=>{m instanceof HTMLElement?h.value=m:h.value=void 0};return(m,D)=>(W(),ie(no,{to:"body"},[q("div",{fixed:"",ref_key:"box",ref:l,style:bt([m.$attrs.style,g.value]),class:to(m.$attrs.class)},[Jt(m.$slots,"default",{onRef:k})],6)]))}});const cr=["onClick"],ur=M({__name:"AttrCard",props:{focusNode:{}},setup(e){const t=e,c=["text","desc"],u=A(()=>Object.entries(t.focusNode.attr).map(([r,o])=>{const g={name:r,value:JSON.stringify(o)};return c.includes(r)?[g,{name:r+".length",value:JSON.stringify((o==null?void 0:o.length)??null)}]:g}).flat());return(r,o)=>(W(),ie(ln,{initialValue:{top:75,right:10}},{default:C(({onRef:g})=>[_(b(en),{size:"small",striped:"",singleLine:!1,class:"gkd_code",themeOverrides:{thPaddingSmall:"2px 4px",tdPaddingSmall:"2px 4px"}},{default:C(()=>[q("thead",{"cursor-move":"",ref:g},[_(b(Xe),null,{default:C(()=>[_(b(pe),null,{default:C(()=>[B(" Name ")]),_:1}),_(b(pe),null,{default:C(()=>[B(" Value ")]),_:1})]),_:1})],512),_(b(tn),null,{default:C(()=>[(W(!0),Oe(yt,null,mt(u.value,f=>(W(),ie(b(Xe),{key:f.name},{default:C(()=>[_(b(fe),null,{default:C(()=>[q("span",{onClick:d=>b(Fe)(`${f.name}=${f.value}`)},te(f.name),9,cr)]),_:2},1024),_(b(fe),null,{default:C(()=>[_(b(Ie),{style:{width:"250px"}},{default:C(()=>[B(te(f.value),1)]),_:2},1024)]),_:2},1024)]),_:2},1024))),128)),r.focusNode.quickFind!==void 0?(W(),ie(b(Xe),{key:0},{default:C(()=>[_(b(fe),null,{default:C(()=>[B(" quickFind ")]),_:1}),_(b(fe),null,{default:C(()=>[_(b(po),null,{trigger:C(()=>[q("span",null,te(JSON.stringify(r.focusNode.quickFind)),1)]),default:C(()=>[B(" 此节点是否可使用 quickFind ")]),_:1})]),_:1})]),_:1})):Ae("",!0)]),_:1})]),_:2},1024)]),_:1}))}}),fr={flex:"","flex-col":"",relative:"","h-full":""},hr=["src"],gr=q("div",{absolute:"","left-0":"","top-0":"","bottom-0":"","right-0":"","b-solid":"","b-1px":"","b-red":""},null,-1),vr=[gr],pr={class:"left-[calc(100%+4px)]",absolute:"","top-0":"","overflow-hidden":"","z-1":"","bg-white":"","h-200px":"","w-200px":"","border-1px":"","border-indigo-600":"","border-dashed":""},br=["src"],mr={absolute:"","left-2px":"","top-2px":"",class:"leading-[1]",style:{"background-color":"rgba(256, 256, 256, 0.7)"}},yr=q("div",{class:"top-[calc(50%-1px)]",absolute:"","left-0":"","right-0":"","h-1px":"","bg-repeat-x":"","mix-blend-difference":"",style:{background:`linear-gradient(
            to left,
            transparent 0%,
            transparent 50%,
            #fff 50%,
            #fff 100%
          )`,"background-size":"10px 1px"}},null,-1),xr=q("div",{class:"left-[calc(50%-1px)]",absolute:"","top-0":"","bottom-0":"","w-1px":"","bg-repeat-y":"","mix-blend-difference":"",style:{background:`linear-gradient(
            to top,
            transparent 0%,
            transparent 50%,
            #fff 50%,
            #fff 100%
          )`,"background-size":"1px 10px"}},null,-1),kr=M({__name:"ScreenshotCard",props:{url:{},snapshot:{},rootNode:{},focusNode:{},onUpdateFocusNode:{type:Function,default:()=>()=>{}}},setup(e){const t=e,c=Z(),u=Z();Ce(()=>{if(!t.rootNode)return;const s=u.value,l=c.value;if(!s||!l)return;const h=l.getBoundingClientRect(),v=h.width/l.naturalWidth*l.naturalHeight,N=(h.height-v)/2,R=(s.clientX-h.left)/h.width*l.naturalWidth,k=(s.clientY-h.top-N)/v*l.naturalHeight,m=bo(t.snapshot.nodes,R,k);m&&t.onUpdateFocusNode(m)});const r=s=>`${s*100}%`,o=A(()=>{var N;const s=c.value,l=(N=t.focusNode)==null?void 0:N.attr;if(!t.focusNode||!s||!l)return"";const h=s.getBoundingClientRect(),v=h.width/s.naturalWidth*s.naturalHeight;return{left:`calc(${r(l.left/s.naturalWidth)} - 2px)`,width:`calc(${r((l.right-l.left)/s.naturalWidth)} + 2px)`,top:`calc(${r((l.top/s.naturalHeight*v+(h.height-v)/2)/h.height)} - 2px)`,height:`calc(${r((l.bottom-l.top)/s.naturalHeight*v/h.height)} + 2px)`}}),g=Z(!1),f=Z({ox:0,oy:0}),d=s=>{const l=c.value;if(!l)return;const h=l.getBoundingClientRect(),v=h.width/l.naturalWidth*l.naturalHeight,N=(h.height-v)/2,R=(s.clientX-h.left)/h.width*l.naturalWidth,k=(s.clientY-h.top-N)/v*l.naturalHeight;f.value={ox:R,oy:k},a.value={left:-(R-.1*l.naturalWidth)/l.naturalWidth*1e3+"px",top:-(k-.1*l.naturalWidth)/l.naturalWidth*1e3+"px"}},a=Z({left:"0",top:"0"});return(s,l)=>(W(),Oe("div",fr,[q("img",{ref_key:"imgRef",ref:c,src:s.url,onClick:l[0]||(l[0]=h=>u.value=h),"cursor-crosshair":"","h-full":"","object-contain":"",style:{"max-width":"max(35vw, 400px)"},onMouseover:l[1]||(l[1]=h=>g.value=!0),onMouseleave:l[2]||(l[2]=h=>g.value=!1),onMousemove:d},null,40,hr),q("div",{style:bt(o.value),absolute:"","pointer-events-none":"","transition-all-300":"","b-1px":"","b-blue":"","b-solid":""},vr,4),Vt(q("div",pr,[q("img",{src:s.url,"object-contain":"",absolute:"","left-0":"","top-0":"",style:bt(a.value),"w-1000px":""},null,12,br),q("div",mr,te(`${f.value.ox.toFixed(0)},${f.value.oy.toFixed(0)}`),1),yr,xr],512),[[Wt,g.value]])]))}}),wr={"w-500px":"","bg-white":"","b-1px":"","b-solid":"","b-gray-200":"","rounded-4px":"","p-8px":""},Cr={flex:"","m-b-4px":""},Nr=q("div",{"p-5px":""},null,-1),Sr={"break-all":""},Rr=q("div",{"p-l-8px":""},null,-1),_r=M({__name:"SearchCard",props:{rootNode:{},onUpdateFocusNode:{type:Function,default:()=>()=>{}}},setup(e){const t=e,c=Z(""),u=Gt([]),r=wo(()=>{if(!t.rootNode){ue.error("根节点不存在");return}const g=c.value.trim();if(g)if(o.value){const f=Co(()=>No(g),"选择器非法");if(u.find(a=>typeof a.selector=="object"&&a.selector.toString()==f.toString())){ue.warning("不可重复选择");return}const d=f.querySelectorAll(t.rootNode);if(d.length==0){ue.success("没有选择到节点");return}ue.success(`选择到 ${d.length} 个节点`),u.unshift({selector:f,results:d})}else{if(u.find(a=>typeof a.selector=="string"&&a.selector.toString()==g)){ue.warning("不可重复选择");return}const f=[],d=[t.rootNode];for(;d.length>0;){const a=d.pop();xt(a).includes(g)&&f.push(a),d.push(...[...a.children].reverse())}if(f.length==0){ue.success("没有搜索到节点");return}ue.success(`搜索到 ${f.length} 个节点`),u.unshift({selector:g,results:f})}}),o=Z(!0);return(g,f)=>(W(),ie(ln,{initialValue:{top:75,right:390},class:"z-1"},{default:C(({onRef:d})=>[q("div",wr,[q("div",Cr,[_(b(mo),{value:o.value,"onUpdate:value":f[0]||(f[0]=a=>o.value=a)},{default:C(()=>[_(b(Bt),null,{default:C(()=>[_(b(Ut),{value:!1},{default:C(()=>[B(" 字符搜索 ")]),_:1}),_(b(Ut),{value:!0},{default:C(()=>[B(" 选择器查询 ")]),_:1})]),_:1})]),_:1},8,["value"]),q("div",{"flex-1":"","cursor-move":"",ref:d},null,512)]),_(b(xo),null,{default:C(()=>[_(b(yo),{value:c.value,"onUpdate:value":f[1]||(f[1]=a=>c.value=a),placeholder:o.value?"请输入选择器":"请输入字符",onKeyup:oo(b(r),["enter"]),inputProps:{class:"gkd_code"}},null,8,["value","placeholder","onKeyup"]),_(b(gt),{onClick:b(r)},{default:C(()=>[B(te(o.value?"查询":"搜索"),1)]),_:1},8,["onClick"])]),_:1}),Nr,_(b(Eo),null,{default:C(()=>[(W(!0),Oe(yt,null,mt(b(u),(a,s)=>(W(),ie(b(Io),{key:a.selector.toString()},{header:C(()=>[q("span",Sr,te((typeof a.selector=="string"?"字符搜索":"选择器查询")+"："+a.selector.toString()),1)]),"header-extra":C(()=>[B(te(a.results.length+"个节点")+" ",1),Rr,_(b(gt),{onClick:ro(l=>b(u).splice(s,1),["stop"])},{default:C(()=>[B(" 删除 ")]),_:2},1032,["onClick"])]),default:C(()=>[_(b(Bt),{style:{"max-height":"400px","overflow-y":"scroll","padding-bottom":"10px"}},{default:C(()=>[(W(!0),Oe(yt,null,mt(a.results,l=>(W(),ie(b(gt),{key:l.id,onClick:h=>g.onUpdateFocusNode(l),size:"small"},{default:C(()=>[B(te(b(xt)(l)),1)]),_:2},1032,["onClick"]))),128))]),_:2},1024)]),_:2},1024))),128))]),_:1})])]),_:1}))}}),Kr={flex:"","flex-col":""},Pr=M({__name:"WindowCard",props:{snapshot:{},rootNode:{},focusNode:{},onUpdateFocusNode:{type:Function,default:()=>()=>{}}},setup(e){const t=e,c=Z([]);Ce(async()=>{var l;if(!t.focusNode)return;const d=t.focusNode.id;let a=t.focusNode.parent;if(!a)return;const s=new Set(c.value);for(;a;)s.add(a.id),a=a.parent;s.size!=c.value.length&&(c.value=[...s],await nt(),(l=u.value)==null||l.scrollTo({key:d}))});const u=Z(),r=(d,a,s)=>{},o=(d,a)=>{var s;return a.id===((s=t.focusNode)==null?void 0:s.id)},g=d=>{var a;return{onClick:()=>{t.onUpdateFocusNode(d.option)},style:{color:d.option.id==((a=t.focusNode)==null?void 0:a.id)?"#00F":void 0}}},f=d=>xt(d.option);return(d,a)=>(W(),Oe("div",Kr,[_(b(en),{size:"small",striped:"",singleLine:!1,class:"table-fixed",themeOverrides:{thPaddingSmall:"2px 4px",tdPaddingSmall:"2px 4px"}},{default:C(()=>[_(b(qo),null,{default:C(()=>[_(b(Xe),null,{default:C(()=>[_(b(pe),{class:"w-140px"},{default:C(()=>[B(" Device ")]),_:1}),_(b(pe),{class:"w-100px"},{default:C(()=>[B(" Name ")]),_:1}),_(b(pe),{class:"w-100px"},{default:C(()=>[B(" VersionName ")]),_:1}),_(b(pe),{class:"w-100px"},{default:C(()=>[B(" VersionCode ")]),_:1}),_(b(pe),{class:"w-200px"},{default:C(()=>[B(" AppId ")]),_:1}),_(b(pe),null,{default:C(()=>[B(" ActivityId ")]),_:1}),_(b(pe),{class:"w-175px"},{default:C(()=>[B(" 操作 ")]),_:1})]),_:1})]),_:1}),_(b(tn),null,{default:C(()=>[_(b(Xe),null,{default:C(()=>[_(b(fe),{class:"whitespace-nowrap"},{default:C(()=>[B(te(`${b(Mt)(d.snapshot).manufacturer} Android ${b(Mt)(d.snapshot).release||""}`),1)]),_:1}),_(b(fe),{class:"whitespace-nowrap",onClick:a[0]||(a[0]=s=>b(Fe)(d.snapshot.appName))},{default:C(()=>[_(b(Ie),null,{default:C(()=>[B(te(d.snapshot.appName),1)]),_:1})]),_:1}),_(b(fe),{class:"whitespace-nowrap",onClick:a[1]||(a[1]=s=>b(Fe)(d.snapshot.appVersionName))},{default:C(()=>[_(b(Ie),null,{default:C(()=>[B(te(d.snapshot.appVersionName),1)]),_:1})]),_:1}),_(b(fe),{class:"whitespace-nowrap",onClick:a[2]||(a[2]=s=>b(Fe)(d.snapshot.appVersionCode.toString()))},{default:C(()=>[_(b(Ie),null,{default:C(()=>[B(te(d.snapshot.appVersionCode),1)]),_:1})]),_:1}),_(b(fe),{class:"whitespace-nowrap",onClick:a[3]||(a[3]=s=>b(Fe)(d.snapshot.appId))},{default:C(()=>[_(b(Ie),null,{default:C(()=>[B(te(d.snapshot.appId),1)]),_:1})]),_:1}),_(b(fe),{onClick:a[4]||(a[4]=s=>b(Fe)(d.snapshot.activityId)),class:"break-words"},{default:C(()=>[_(b(Ie),null,{default:C(()=>[B(te(d.snapshot.activityId),1)]),_:1})]),_:1}),_(b(fe),null,{default:C(()=>[Jt(d.$slots,"default",{},void 0,!0)]),_:3})]),_:3})]),_:3})]),_:3}),_(b(sr),{ref_key:"treeRef",ref:u,virtualScroll:"",showLine:"","onUpdate:checkedKeys":r,keyField:"id",defaultExpandedKeys:c.value,data:[d.rootNode],filter:o,nodeProps:g,renderLabel:f,style:{"--n-border-color":"rgb(239, 239, 245)"}},null,8,["defaultExpandedKeys","data","filter","nodeProps","renderLabel"])]))}});const Tr=Ro(Pr,[["__scopeId","data-v-e4f55958"]]),Dr={"h-full":"",flex:"","gap-5px":"","p-5px":"","box-border":""},zr=M({__name:"SnapshotPage",setup(e){const t=lo(),c=ao(),u=So(),r=A(()=>String(t.params.snapshotId||"")),o=A(()=>{const l=Number(t.query.showSize||"");return!Number.isSafeInteger(l)||l<=0?2e3:l}),g=Z(""),f=Z();Ce(async()=>{const l=await Et.getItem(r.value);if(!l){ue.error("快照数据缺失");return}Fn()&&setTimeout(async()=>{Ln(l),An[l.id]||En(await Et.getItem(r.value))},1e3),l.nodes.length>o.value&&(ue.warning(`当前展示节点数量为${o.value}
之后的${l.nodes.length-o.value}个节点将被丢弃
使用showSize查询参数可以修改展示数量`),l.nodes=l.nodes.slice(0,o.value));const h=await In.getItem(r.value);if(!h){ue.create("截屏数据缺失");return}g.value=URL.createObjectURL(new Blob([h])),f.value=l,d.value=ko(l.nodes),u.value="快照-"+l.appName||l.appId});const d=Z(),a=Z(),s=async()=>{ue.success("删除成功,即将回到首页"),await On(2e3),c.replace({path:"/"})};return(l,h)=>(W(),Oe("div",Dr,[g.value&&f.value?(W(),ie(kr,{key:0,url:g.value,snapshot:f.value,rootNode:d.value,focusNode:a.value,onUpdateFocusNode:h[0]||(h[0]=v=>a.value=v)},null,8,["url","snapshot","rootNode","focusNode"])):Ae("",!0),f.value&&d.value?(W(),ie(Tr,{key:1,rootNode:d.value,snapshot:f.value,focusNode:a.value,onUpdateFocusNode:h[1]||(h[1]=v=>a.value=v),class:"flex-1"},{default:C(()=>[f.value?(W(),ie($n,{key:0,snapshot:f.value,onDelete:s,showPreview:!1},null,8,["snapshot"])):Ae("",!0)]),_:1},8,["rootNode","snapshot","focusNode"])):Ae("",!0),a.value?(W(),ie(ur,{key:2,focusNode:a.value},null,8,["focusNode"])):Ae("",!0),d.value?(W(),ie(_r,{key:3,rootNode:d.value,onUpdateFocusNode:h[2]||(h[2]=v=>a.value=v)},null,8,["rootNode"])):Ae("",!0)]))}});export{zr as default};
//# sourceMappingURL=SnapshotPage-1161e4e4.js.map
