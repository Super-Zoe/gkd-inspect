{"version":3,"file":"DevicePage-8df43b4b.js","sources":["../../src/utils/api.ts","../../src/views/DevicePage.vue"],"sourcesContent":["import { shallowRef } from 'vue';\nimport { message } from './discrete';\nimport { enhanceFetch } from './fetch';\nimport type { Device, RpcError, Snapshot } from './types';\n\ntype RpcOptions = {\n  query?: Record<string, unknown>;\n  init?: RequestInit;\n};\n\nexport const useDeviceApi = (initOrigin?: string) => {\n  const origin = shallowRef(initOrigin);\n  const rpc = async (rpcName: string, options: RpcOptions = {}) => {\n    if (!origin.value) {\n      throw new Error(`origin must exist`);\n    }\n    const u = new URL(`/api/` + rpcName, origin.value);\n    Object.entries(options.query || {}).forEach(([key, value]) => {\n      if (value === undefined) return;\n      u.searchParams.set(key, String(value));\n    });\n    const response = await enhanceFetch(u, options.init).catch((e) => {\n      message.error(`网络错误:/` + rpcName);\n      throw e;\n    });\n    if (!response.ok) {\n      message.error(`接口错误:/` + rpcName + `:` + response.status);\n      throw response;\n    }\n    if (response.headers.get(`Content-Type`)?.includes(`application/json`)) {\n      const error = (await response.clone().json()) as RpcError;\n      if (error.__error) {\n        message.error(error.message);\n        throw response;\n      }\n    }\n    return response;\n  };\n  const jsonRpc = async <T>(...args: Parameters<typeof rpc>) => {\n    const response = await rpc(...args);\n    return (await response.json()) as T;\n  };\n  const blobRpc = async (...args: Parameters<typeof rpc>) => {\n    const response = await rpc(...args);\n    return await response.blob();\n  };\n  const arrayBufferRpc = async (...args: Parameters<typeof rpc>) => {\n    const response = await rpc(...args);\n    return await response.arrayBuffer();\n  };\n  const api = {\n    device: async () => jsonRpc<Device>(`device`),\n    snapshot: async (query?: { id?: string | number }) => {\n      return jsonRpc<Snapshot>(`snapshot`, { query });\n    },\n    screenshot: async (query: { id: string | number }) => {\n      return arrayBufferRpc(`screenshot`, { query });\n    },\n    captureSnapshot: async () => {\n      return jsonRpc<Snapshot>(`captureSnapshot`);\n    },\n    snapshots: async () => {\n      return jsonRpc<Snapshot[]>(`snapshots`);\n    },\n    subsApps: async () => {\n      return jsonRpc<unknown[]>(`subsApps`);\n    },\n    updateSubsApps: async (data: unknown[]) => {\n      return blobRpc(`updateSubsApps`, {\n        init: {\n          method: 'POST',\n          body: JSON.stringify(data),\n          headers: {\n            'Content-Type': 'application/json',\n          },\n        },\n      });\n    },\n    execSelector: async (data: {\n      selector: string;\n      action?: string;\n      quickFind?: boolean;\n    }) => {\n      return jsonRpc<{ message: string; action: string; result: boolean }>(\n        `execSelector`,\n        {\n          init: {\n            method: 'POST',\n            // value 是旧版本的选择器\n            body: JSON.stringify({ ...data, value: data.selector }),\n            headers: {\n              'Content-Type': 'application/json',\n            },\n          },\n        },\n      );\n    },\n  };\n  return { origin, api };\n};\n","<script setup lang=\"tsx\">\nimport { useDeviceApi } from '@/utils/api';\nimport { toValidURL } from '@/utils/check';\nimport { message } from '@/utils/discrete';\nimport { errorWrap } from '@/utils/error';\nimport { delay } from '@/utils/others';\nimport { checkSelector } from '@/utils/selector';\nimport { snapshotStorage, screenshotStorage } from '@/utils/storage';\nimport { useSnapshotColumns } from '@/utils/table';\nimport { useBatchTask, useTask } from '@/utils/task';\nimport type { Device, Snapshot } from '@/utils/types';\nimport { useStorage, useTitle, useDebounceFn } from '@vueuse/core';\nimport JSON5 from 'json5';\nimport {\n  DataTableColumns,\n  NButton,\n  NDataTable,\n  NInput,\n  NInputGroup,\n  NSpace,\n  PaginationProps,\n  NIcon,\n  NModal,\n  NRadioGroup,\n  NRadio,\n  NSelect,\n  NCheckbox,\n} from 'naive-ui';\nimport { SortState } from 'naive-ui/es/data-table/src/interface';\nimport pLimit from 'p-limit';\nimport {\n  onMounted,\n  shallowReactive,\n  shallowRef,\n  toRaw,\n  watch,\n  watchEffect,\n} from 'vue';\nimport { useRouter } from 'vue-router';\n\nconst router = useRouter();\nconst title = useTitle(`新设备`);\nconst { api, origin } = useDeviceApi();\nconst link = useStorage(`device_link`, ``);\nconst device = shallowRef<Device>();\nconst connect = useTask(async () => {\n  if (!link.value) return;\n  origin.value = errorWrap(\n    () => new URL(link.value.trim()),\n    () => `非法设备地址`,\n  ).origin;\n  link.value = origin.value;\n  device.value = await api.device();\n});\nonMounted(async () => {\n  await delay(500);\n  if (toValidURL(link.value)) {\n    connect.invoke();\n  }\n});\n\nconst snapshots = shallowRef<Snapshot[]>([]);\nwatchEffect(async () => {\n  if (!device.value) return;\n  title.value = `已连接 ` + device.value.manufacturer;\n  const result = await api.snapshots();\n  result.sort((a, b) => b.id - a.id);\n  snapshots.value = result;\n  const subsApps = await api.subsApps();\n  subsText.value = JSON5.stringify(\n    subsApps || [],\n    function (key, value) {\n      if (value === null) return undefined;\n      return value;\n    },\n    2,\n  );\n});\n\nconst captureSnapshot = useTask(async () => {\n  const snapshot = await api.captureSnapshot();\n  const screenshot = await api.screenshot({ id: snapshot.id });\n  await snapshotStorage.setItem(snapshot.id, snapshot);\n  await screenshotStorage.setItem(snapshot.id, screenshot);\n  message.success(`保存快照成功`);\n  const result = await api.snapshots();\n  result.sort((a, b) => b.id - a.id);\n  snapshots.value = result;\n});\nconst downloadAllSnapshot = useTask(async () => {\n  const snapshotIds = (await api.snapshots()).map((s) => s.id);\n  const existSnapshotIds = new Set(\n    (await screenshotStorage.keys()).map((s) => parseInt(s)),\n  );\n  const unimportSnapshotIds = snapshotIds.filter(\n    (k) => !existSnapshotIds.has(k),\n  );\n  if (unimportSnapshotIds.length == 0) {\n    message.success(`没有新记录可导入`);\n    return;\n  }\n  let r = 0;\n  const limit = pLimit(3);\n  await Promise.all(\n    unimportSnapshotIds.map((snapshotId) =>\n      limit(async () => {\n        const [newSnapshot, newScreenshot] = await Promise.all([\n          api.snapshot({ id: snapshotId }),\n          api.screenshot({ id: snapshotId }),\n        ] as const);\n        if (!newSnapshot.nodes) return;\n        await Promise.all([\n          snapshotStorage.setItem(snapshotId, newSnapshot),\n          screenshotStorage.setItem(snapshotId, newScreenshot),\n        ]);\n        r++;\n      }),\n    ),\n  );\n  message.success(`导入${r}条新记录`);\n});\n\nconst {\n  activityIdCol,\n  appIdCol,\n  appNameCol,\n  ctimeCol,\n  appVersionCodeCol,\n  appVersionNameCol,\n  reseColWidth,\n} = useSnapshotColumns();\nconst handleSorterChange = (sorter: SortState) => {\n  if (sorter.columnKey == ctimeCol.key) {\n    ctimeCol.sortOrder = sorter.order;\n  }\n};\nconst previewSnapshot = useBatchTask(\n  async (row: Snapshot) => {\n    if (!(await snapshotStorage.hasItem(row.id))) {\n      await snapshotStorage.setItem(row.id, await api.snapshot({ id: row.id }));\n    }\n    if (!(await screenshotStorage.hasItem(row.id))) {\n      const bf = await api.screenshot({ id: row.id });\n      await screenshotStorage.setItem(row.id, bf);\n    }\n    window.open(\n      router.resolve({\n        name: 'snapshot',\n        params: { snapshotId: row.id },\n      }).href,\n    );\n  },\n  (r) => r.id,\n);\n\nconst columns: DataTableColumns<Snapshot> = [\n  ctimeCol,\n  appNameCol,\n  appIdCol,\n  appVersionCodeCol,\n  appVersionNameCol,\n  activityIdCol,\n  {\n    key: `actions`,\n    title: `Action`,\n    fixed: 'right',\n    width: `120px`,\n    render(row) {\n      return (\n        <NSpace size=\"small\">\n          <NButton\n            size=\"small\"\n            loading={previewSnapshot.loading[row.id]}\n            onClick={() => previewSnapshot.invoke(row)}\n          >\n            查看\n          </NButton>\n        </NSpace>\n      );\n    },\n  },\n];\n\nconst pagination = shallowReactive<PaginationProps>({\n  page: 1,\n  pageSize: 50,\n  showSizePicker: true,\n  pageSizes: [50, 100],\n  onChange: (page: number) => {\n    pagination.page = page;\n  },\n  onUpdatePageSize: (pageSize: number) => {\n    pagination.pageSize = pageSize;\n    pagination.page = 1;\n  },\n});\nwatch(pagination, reseColWidth);\n\nconst showSubsModel = shallowRef(false);\nconst subsText = shallowRef(``);\nconst updateSubs = useTask(async () => {\n  const appsSubs = errorWrap(() => JSON5.parse(subsText.value.trim() || `[]`));\n  await api.updateSubsApps([].concat(appsSubs));\n  message.success(`修改成功`);\n});\n\nconst showSelectorModel = shallowRef(false);\n\nconst actionOptions = [\n  'click',\n  'clickNode',\n  'clickCenter',\n  'back',\n  'longClick',\n  'longClickNode',\n  'longClickCenter',\n].map((s) => ({ value: s, label: s }));\nconst clickAction = shallowReactive({\n  selector: ``,\n  selectorValid: false,\n  action: actionOptions[0].value,\n  quickFind: false,\n});\nconst checkSelectorValid = useDebounceFn(() => {\n  clickAction.selectorValid = checkSelector(clickAction.selector);\n}, 500);\nwatch(() => clickAction.selector.trim(), checkSelectorValid);\nconst execSelector = useTask(async () => {\n  const result = await api.execSelector({ ...clickAction });\n  if (result.message) {\n    message.success(`点击成功:` + result.message);\n    return;\n  }\n  if (result.action) {\n    message.success((result.result ? `点击成功:` : `点击失败`) + result.action);\n  }\n});\n</script>\n<template>\n  <NModal\n    v-model:show=\"showSubsModel\"\n    preset=\"dialog\"\n    style=\"width: 800px\"\n    title=\"修改内存订阅\"\n    positive-text=\"确认\"\n    :positiveButtonProps=\"{\n      loading: updateSubs.loading,\n      onClick() {\n        updateSubs.invoke();\n      },\n    }\"\n  >\n    <NInput\n      v-model:value=\"subsText\"\n      :disabled=\"updateSubs.loading\"\n      type=\"textarea\"\n      class=\"gkd_code\"\n      :autosize=\"{\n        minRows: 10,\n        maxRows: 25,\n      }\"\n      :placeholder=\"`请输入订阅文本\\n订阅支持JSON5\\n根节点可以是APP规则对象也可以是APP规则对象数组`\"\n    />\n  </NModal>\n  <NModal\n    v-model:show=\"showSelectorModel\"\n    preset=\"dialog\"\n    style=\"width: 800px\"\n    title=\"执行选择器\"\n    positive-text=\"确认\"\n    :positiveButtonProps=\"{\n      loading: execSelector.loading,\n      disabled: !clickAction.selectorValid,\n      onClick() {\n        execSelector.invoke();\n      },\n    }\"\n  >\n    <NInput\n      v-model:value=\"clickAction.selector\"\n      :disabled=\"execSelector.loading\"\n      type=\"textarea\"\n      class=\"gkd_code\"\n      :autosize=\"{\n        minRows: 4,\n        maxRows: 10,\n      }\"\n      placeholder=\"请输入合法的选择器\"\n    />\n    <div h-15px></div>\n    <NSpace>\n      <NCheckbox v-model:checked=\"clickAction.quickFind\"> 快速查找 </NCheckbox>\n      <a\n        href=\"https://github.com/gkd-kit/subscription/blob/main/src/types.ts\"\n        target=\"_blank\"\n        rel=\"noopener noreferrer\"\n      >\n        查找说明\n      </a>\n    </NSpace>\n    <div h-10px></div>\n    <div flex gap-10px flex-items-center>\n      <NSelect\n        v-model:value=\"clickAction.action\"\n        :options=\"actionOptions\"\n        class=\"w-150px\"\n      />\n      <a\n        href=\"https://github.com/gkd-kit/subscription/blob/main/src/types.ts\"\n        target=\"_blank\"\n        rel=\"noopener noreferrer\"\n      >\n        操作说明\n      </a>\n    </div>\n  </NModal>\n  <div flex flex-col p-10px gap-10px h-full>\n    <NSpace>\n      <RouterLink to=\"/\">\n        <NButton>\n          <template #icon>\n            <NIcon>\n              <svg\n                xmlns=\"http://www.w3.org/2000/svg\"\n                xmlns:xlink=\"http://www.w3.org/1999/xlink\"\n                viewBox=\"0 0 32 32\"\n              >\n                <path\n                  d=\"M16.612 2.214a1.01 1.01 0 0 0-1.242 0L1 13.419l1.243 1.572L4 13.621V26a2.004 2.004 0 0 0 2 2h20a2.004 2.004 0 0 0 2-2V13.63L29.757 15L31 13.428zM18 26h-4v-8h4zm2 0v-8a2.002 2.002 0 0 0-2-2h-4a2.002 2.002 0 0 0-2 2v8H6V12.062l10-7.79l10 7.8V26z\"\n                  fill=\"currentColor\"\n                ></path>\n              </svg>\n            </NIcon>\n          </template>\n        </NButton>\n      </RouterLink>\n      <NInputGroup>\n        <NInput\n          v-model:value=\"link\"\n          placeholder=\"请输入设备地址\"\n          :style=\"{ minWidth: `250px` }\"\n          @keyup.enter=\"connect.invoke\"\n        ></NInput>\n        <NButton @click=\"connect.invoke\" :loading=\"connect.loading\">\n          刷新连接\n        </NButton>\n      </NInputGroup>\n      <template v-if=\"device\">\n        <div class=\"h-full\" flex flex-items-center>\n          {{ `已连接 ${device.manufacturer} Android ${device.release}` }}\n        </div>\n        <NButton\n          @click=\"captureSnapshot.invoke\"\n          :loading=\"captureSnapshot.loading\"\n        >\n          快照\n        </NButton>\n        <NButton\n          @click=\"downloadAllSnapshot.invoke\"\n          :loading=\"downloadAllSnapshot.loading\"\n        >\n          下载设备所有快照\n        </NButton>\n        <NButton @click=\"showSubsModel = true\"> 修改内存订阅 </NButton>\n        <NButton @click=\"showSelectorModel = true\"> 执行选择器 </NButton>\n      </template>\n    </NSpace>\n    <NDataTable\n      striped\n      flexHeight\n      :data=\"snapshots\"\n      :columns=\"columns\"\n      :pagination=\"pagination\"\n      @update:sorter=\"handleSorterChange\"\n      size=\"small\"\n      class=\"flex-1\"\n      :scrollX=\"1200\"\n    />\n  </div>\n</template>\n"],"names":["useDeviceApi","initOrigin","origin","shallowRef","rpc","rpcName","options","u","key","value","response","enhanceFetch","e","message","_a","error","jsonRpc","args","blobRpc","arrayBufferRpc","query","data","router","useRouter","title","useTitle","api","link","useStorage","device","connect","useTask","errorWrap","URL","trim","onMounted","delay","toValidURL","invoke","snapshots","watchEffect","manufacturer","result","sort","a","b","id","subsApps","subsText","JSON5","stringify","captureSnapshot","snapshot","screenshot","snapshotStorage","setItem","screenshotStorage","success","downloadAllSnapshot","snapshotIds","map","s","existSnapshotIds","Set","keys","parseInt","unimportSnapshotIds","filter","k","has","length","r","limit","pLimit","Promise","all","snapshotId","newSnapshot","newScreenshot","nodes","activityIdCol","appIdCol","appNameCol","ctimeCol","appVersionCodeCol","appVersionNameCol","reseColWidth","useSnapshotColumns","handleSorterChange","sorter","columnKey","sortOrder","order","previewSnapshot","useBatchTask","row","hasItem","bf","window","open","resolve","name","params","href","columns","fixed","width","render","_createVNode2","NSpace","default","NButton","loading","onClick","_createTextVNode2","pagination","shallowReactive","page","pageSize","showSizePicker","pageSizes","onChange","onUpdatePageSize","watch","showSubsModel","updateSubs","appsSubs","parse","updateSubsApps","concat","showSelectorModel","actionOptions","label","clickAction","selector","selectorValid","action","quickFind","checkSelectorValid","useDebounceFn","checkSelector","execSelector"],"mappings":"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"}